

<!DOCTYPE html>
<html lang="zh-CN" >



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/Hexo/img/csdn.png">
  <link rel="icon" href="/Hexo/img/csdn.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#DAA520">
  <meta name="author" content="Êòü">
  <meta name="keywords" content="">
  
    <meta name="description" content="1 ËøõÁ®ã‰∏éÁ∫øÁ®ãÂü∫Êú¨Ê¶ÇÂøµ1.1 ËøõÁ®ã‰∫ßÁîüÁöÑËÉåÊôØÊúÄÂàùÁöÑËÆ°ÁÆóÊú∫Âè™ËÉΩÊé•Âèó‰∏Ä‰∫õÁâπÂÆöÁöÑÊåá‰ª§ÔºåÁî®Êà∑ÊØèËæìÂÖ•‰∏Ä‰∏™Êåá‰ª§ÔºåËÆ°ÁÆóÊú∫Â∞±ÂÅöÂá∫‰∏Ä‰∏™Êìç‰Ωú„ÄÇÂΩìÁî®Êà∑Âú®ÊÄùËÄÉÊàñËÄÖËæìÂÖ•Êó∂ÔºåËÆ°ÁÆóÊú∫Â∞±Âú®Á≠âÂæÖ„ÄÇËøôÊ†∑ÊïàÁéáÈùûÂ∏∏‰Ωé‰∏ãÔºåÂú®ÂæàÂ§öÊó∂ÂÄôÔºåËÆ°ÁÆóÊú∫ÈÉΩÂ§ÑÂú®Á≠âÂæÖÁä∂ÊÄÅ„ÄÇ ÊâπÂ§ÑÁêÜÊìç‰ΩúÁ≥ªÁªü ÂêéÊù•Êúâ‰∫ÜÊâπÂ§ÑÁêÜÊìç‰Ωú‰ΩìÁªü,Êää‰∏ÄÁ≥ªÂàóÈúÄË¶ÅÊìç‰ΩúÁöÑÊåá‰ª§ÂÜô‰∏ãÊù•ÔºåÂΩ¢Êàê‰∏Ä‰∏™Ê∏ÖÂçïÔºå‰∏ÄÊ¨°ÊÄß‰∫§ÁªôËÆ°ÁÆóÊú∫„ÄÇÁî®Êà∑Â∞ÜÂ§ö‰∏™ÈúÄË¶ÅÊâßË°åÁöÑÁ®ãÂ∫èÂÜôÂú®Á£ÅÂ∏¶‰∏äÔºåÁÑ∂Âêé‰∫§Áî±ËÆ°ÁÆóÊú∫ÂéªËØªÂèñÂπ∂ÈÄê‰∏™ÊâßË°åËøô‰∫õÁ®ãÂ∫è">
<meta property="og:type" content="article">
<meta property="og:title" content="Ê∑±ÂÖ•ÊµÖÂá∫javaÂ§öÁ∫øÁ®ã">
<meta property="og:url" content="https://1902756969.github.io/Hexo/2021/05/15/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAjava%E5%A4%9A%E7%BA%BF%E7%A8%8B/index.html">
<meta property="og:site_name" content="‚≠ê‚≠ê‚≠ê">
<meta property="og:description" content="1 ËøõÁ®ã‰∏éÁ∫øÁ®ãÂü∫Êú¨Ê¶ÇÂøµ1.1 ËøõÁ®ã‰∫ßÁîüÁöÑËÉåÊôØÊúÄÂàùÁöÑËÆ°ÁÆóÊú∫Âè™ËÉΩÊé•Âèó‰∏Ä‰∫õÁâπÂÆöÁöÑÊåá‰ª§ÔºåÁî®Êà∑ÊØèËæìÂÖ•‰∏Ä‰∏™Êåá‰ª§ÔºåËÆ°ÁÆóÊú∫Â∞±ÂÅöÂá∫‰∏Ä‰∏™Êìç‰Ωú„ÄÇÂΩìÁî®Êà∑Âú®ÊÄùËÄÉÊàñËÄÖËæìÂÖ•Êó∂ÔºåËÆ°ÁÆóÊú∫Â∞±Âú®Á≠âÂæÖ„ÄÇËøôÊ†∑ÊïàÁéáÈùûÂ∏∏‰Ωé‰∏ãÔºåÂú®ÂæàÂ§öÊó∂ÂÄôÔºåËÆ°ÁÆóÊú∫ÈÉΩÂ§ÑÂú®Á≠âÂæÖÁä∂ÊÄÅ„ÄÇ ÊâπÂ§ÑÁêÜÊìç‰ΩúÁ≥ªÁªü ÂêéÊù•Êúâ‰∫ÜÊâπÂ§ÑÁêÜÊìç‰Ωú‰ΩìÁªü,Êää‰∏ÄÁ≥ªÂàóÈúÄË¶ÅÊìç‰ΩúÁöÑÊåá‰ª§ÂÜô‰∏ãÊù•ÔºåÂΩ¢Êàê‰∏Ä‰∏™Ê∏ÖÂçïÔºå‰∏ÄÊ¨°ÊÄß‰∫§ÁªôËÆ°ÁÆóÊú∫„ÄÇÁî®Êà∑Â∞ÜÂ§ö‰∏™ÈúÄË¶ÅÊâßË°åÁöÑÁ®ãÂ∫èÂÜôÂú®Á£ÅÂ∏¶‰∏äÔºåÁÑ∂Âêé‰∫§Áî±ËÆ°ÁÆóÊú∫ÂéªËØªÂèñÂπ∂ÈÄê‰∏™ÊâßË°åËøô‰∫õÁ®ãÂ∫è">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i0.hdslb.com/bfs/album/0fdd3009a7d4abff16d557c1220fc647a64818c3.png">
<meta property="article:published_time" content="2021-05-15T10:29:54.000Z">
<meta property="article:modified_time" content="2022-11-17T13:03:27.776Z">
<meta property="article:author" content="Êòü">
<meta property="article:tag" content="Â§öÁ∫øÁ®ã">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i0.hdslb.com/bfs/album/0fdd3009a7d4abff16d557c1220fc647a64818c3.png">
  
  
  <title>Ê∑±ÂÖ•ÊµÖÂá∫javaÂ§öÁ∫øÁ®ã - ‚≠ê‚≠ê‚≠ê</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ‰∏ªÈ¢ò‰æùËµñÁöÑÂõæÊ†áÂ∫ìÔºå‰∏çË¶ÅËá™Ë°å‰øÆÊîπ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/Hexo/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/Hexo/css/highlight.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"1902756969.github.io","root":"/Hexo/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":" ‚ù°"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/Hexo/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/Hexo/js/utils.js" ></script>
  <script  src="/Hexo/js/color-schema.js" ></script>

  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/Hexo/">
      <strong>üêõ</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Hexo/">
                <i class="iconfont icon-home-fill"></i>
                È¶ñÈ°µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Hexo/categories/">
                <i class="iconfont icon-category-fill"></i>
                ÁõÆÂΩï
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Hexo/archives/">
                <i class="iconfont icon-archive-fill"></i>
                ÂΩíÊ°£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Hexo/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Ê†áÁ≠æ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Hexo/about/">
                <i class="iconfont icon-user-fill"></i>
                ÂÖ≥‰∫é
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Hexo/links/">
                <i class="iconfont icon-link-fill"></i>
                ÂèãÈìæ
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/Hexo/img/bg5.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Ê∑±ÂÖ•ÊµÖÂá∫javaÂ§öÁ∫øÁ®ã"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Êòü
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2021-05-15 18:29" pubdate>
          2021Âπ¥5Êúà15Êó• Êôö‰∏ä
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          53k Â≠ó
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          440 ÂàÜÈíü
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> Ê¨°
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Ê∑±ÂÖ•ÊµÖÂá∫javaÂ§öÁ∫øÁ®ã</h1>
            
            <div class="markdown-body">
              
              <meta name="referrer" content="no-referrer">



<h1 id="1-ËøõÁ®ã‰∏éÁ∫øÁ®ãÂü∫Êú¨Ê¶ÇÂøµ"><a href="#1-ËøõÁ®ã‰∏éÁ∫øÁ®ãÂü∫Êú¨Ê¶ÇÂøµ" class="headerlink" title="1 ËøõÁ®ã‰∏éÁ∫øÁ®ãÂü∫Êú¨Ê¶ÇÂøµ"></a>1 ËøõÁ®ã‰∏éÁ∫øÁ®ãÂü∫Êú¨Ê¶ÇÂøµ</h1><h2 id="1-1-ËøõÁ®ã‰∫ßÁîüÁöÑËÉåÊôØ"><a href="#1-1-ËøõÁ®ã‰∫ßÁîüÁöÑËÉåÊôØ" class="headerlink" title="1.1 ËøõÁ®ã‰∫ßÁîüÁöÑËÉåÊôØ"></a>1.1 ËøõÁ®ã‰∫ßÁîüÁöÑËÉåÊôØ</h2><p>ÊúÄÂàùÁöÑËÆ°ÁÆóÊú∫Âè™ËÉΩÊé•Âèó‰∏Ä‰∫õÁâπÂÆöÁöÑÊåá‰ª§ÔºåÁî®Êà∑ÊØèËæìÂÖ•‰∏Ä‰∏™Êåá‰ª§ÔºåËÆ°ÁÆóÊú∫Â∞±ÂÅöÂá∫‰∏Ä‰∏™Êìç‰Ωú„ÄÇÂΩìÁî®Êà∑Âú®ÊÄùËÄÉÊàñËÄÖËæìÂÖ•Êó∂ÔºåËÆ°ÁÆóÊú∫Â∞±Âú®Á≠âÂæÖ„ÄÇËøôÊ†∑ÊïàÁéáÈùûÂ∏∏‰Ωé‰∏ãÔºåÂú®ÂæàÂ§öÊó∂ÂÄôÔºåËÆ°ÁÆóÊú∫ÈÉΩÂ§ÑÂú®Á≠âÂæÖÁä∂ÊÄÅ„ÄÇ</p>
<p><strong>ÊâπÂ§ÑÁêÜÊìç‰ΩúÁ≥ªÁªü</strong></p>
<p>ÂêéÊù•Êúâ‰∫Ü<strong>ÊâπÂ§ÑÁêÜÊìç‰Ωú‰ΩìÁªü</strong>,Êää‰∏ÄÁ≥ªÂàóÈúÄË¶ÅÊìç‰ΩúÁöÑÊåá‰ª§ÂÜô‰∏ãÊù•ÔºåÂΩ¢Êàê‰∏Ä‰∏™Ê∏ÖÂçïÔºå‰∏ÄÊ¨°ÊÄß‰∫§ÁªôËÆ°ÁÆóÊú∫„ÄÇÁî®Êà∑Â∞ÜÂ§ö‰∏™ÈúÄË¶ÅÊâßË°åÁöÑÁ®ãÂ∫èÂÜôÂú®Á£ÅÂ∏¶‰∏äÔºåÁÑ∂Âêé‰∫§Áî±ËÆ°ÁÆóÊú∫ÂéªËØªÂèñÂπ∂ÈÄê‰∏™ÊâßË°åËøô‰∫õÁ®ãÂ∫èÔºåÂπ∂Â∞ÜËæìÂá∫ÁªìÊûúÂÜôÂú®Âè¶‰∏Ä‰∏™Á£ÅÂ∏¶‰∏ä„ÄÇ</p>
<p>ÊâπÂ§ÑÁêÜÊìç‰ΩúÁ≥ªÁªüÂú®‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÊèêÈ´ò‰∫ÜËÆ°ÁÆóÊú∫ÁöÑÊïàÁéáÔºå‰ΩÜÊòØÁî±‰∫é<strong>ÊâπÂ§ÑÁêÜÊìç‰ΩúÁ≥ªÁªüÁöÑÊåá‰ª§ËøêË°åÊñπÂºè‰ªçÁÑ∂ÊòØ‰∏≤Ë°åÁöÑÔºåÂÜÖÂ≠ò‰∏≠ÂßãÁªàÂè™Êúâ‰∏Ä‰∏™Á®ãÂ∫èÂú®ËøêË°å</strong>ÔºåÂêéÈù¢ÁöÑÁ®ãÂ∫èÈúÄË¶ÅÁ≠âÂæÖÂâçÈù¢ÁöÑÁ®ãÂ∫èÊâßË°åÂÆåÊàêÂêéÊâçËÉΩÂºÄÂßãÊâßË°åÔºåËÄåÂâçÈù¢ÁöÑÁ®ãÂ∫èÊúâÊó∂‰ºöÁî±‰∫éI&#x2F;OÊìç‰Ωú„ÄÅÁΩëÁªúÁ≠âÂéüÂõ†ÈòªÂ°ûÔºåÊâÄ‰ª•<strong>ÊâπÂ§ÑÁêÜÊìç‰ΩúÊïàÁéá‰πü‰∏çÈ´ò</strong>„ÄÇ</p>
<p><strong>ËøõÁ®ãÁöÑÊèêÂá∫</strong></p>
<p>‰∫∫‰ª¨ÂØπ‰∫éËÆ°ÁÆóÊú∫ÁöÑÊÄßËÉΩË¶ÅÊ±ÇË∂äÊù•Ë∂äÈ´òÔºåÁé∞ÊúâÁöÑÊâπÂ§ÑÁêÜÊìç‰ΩúÁ≥ªÁªüÂπ∂‰∏çËÉΩÊª°Ë∂≥‰∫∫‰ª¨ÁöÑÈúÄÊ±ÇÔºåËÄåÊâπÂ§ÑÁêÜÊìç‰ΩúÁ≥ªÁªüÁöÑÁì∂È¢àÂú®‰∫éÂÜÖÂ≠ò‰∏≠Âè™Â≠òÂú®‰∏Ä‰∏™Á®ãÂ∫èÔºåÈÇ£‰πàÂÜÖÂ≠ò‰∏≠ËÉΩ‰∏çËÉΩÂ≠òÂú®Â§ö‰∏™Á®ãÂ∫èÂë¢ÔºüËøôÊòØ‰∫∫‰ª¨‰∫üÂæÖËß£ÂÜ≥ÁöÑÈóÆÈ¢ò„ÄÇ</p>
<p>‰∫éÊòØÔºåÁßëÂ≠¶ÂÆ∂‰ª¨ÊèêÂá∫‰∫ÜËøõÁ®ãÁöÑÊ¶ÇÂøµ„ÄÇ</p>
<p>ËøõÁ®ãÂ∞±ÊòØ<strong>Â∫îÁî®Á®ãÂ∫èÂú®ÂÜÖÂ≠ò‰∏≠ÂàÜÈÖçÁöÑÁ©∫Èó¥Ôºå‰πüÂ∞±ÊòØÊ≠£Âú®ËøêË°åÁöÑÁ®ãÂ∫è</strong>ÔºåÂêÑ‰∏™ËøõÁ®ã‰πãÈó¥‰∫í‰∏çÂπ≤Êâ∞„ÄÇÂêåÊó∂ËøõÁ®ã‰øùÂ≠òÁùÄÁ®ãÂ∫èÊØè‰∏Ä‰∏™Êó∂ÂàªËøêË°åÁöÑÁä∂ÊÄÅ„ÄÇ</p>
<blockquote>
<p>Á®ãÂ∫èÔºöÁî®ÊüêÁßçÁºñÁ®ãËØ≠Ë®Ä(java„ÄÅpythonÁ≠â)ÁºñÂÜôÔºåËÉΩÂ§üÂÆåÊàê‰∏ÄÂÆö‰ªªÂä°ÊàñËÄÖÂäüËÉΩÁöÑ‰ª£Á†ÅÈõÜÂêà,ÊòØÊåá‰ª§ÂíåÊï∞ÊçÆÁöÑÊúâÂ∫èÈõÜÂêàÔºåÊòØ<strong>‰∏ÄÊÆµÈùôÊÄÅ‰ª£Á†Å</strong>„ÄÇ</p>
</blockquote>
<p>Ê≠§Êó∂ÔºåCPUÈááÁî®Êó∂Èó¥ÁâáËΩÆËΩ¨ÁöÑÊñπÂºèËøêË°åËøõÁ®ãÔºöCPU‰∏∫ÊØè‰∏™ËøõÁ®ãÂàÜÈÖç‰∏Ä‰∏™Êó∂Èó¥ÊÆµÔºåÁß∞‰ΩúÂÆÉÁöÑÊó∂Èó¥Áâá„ÄÇÂ¶ÇÊûúÂú®Êó∂Èó¥ÁâáÁªìÊùüÊó∂ËøõÁ®ãËøòÂú®ËøêË°åÔºåÂàôÊöÇÂÅúËøô‰∏™ËøõÁ®ãÁöÑËøêË°åÔºåÂπ∂‰∏îCPUÂàÜÈÖçÁªôÂè¶‰∏Ä‰∏™ËøõÁ®ãÔºàËøô‰∏™ËøáÁ®ãÂè´ÂÅö‰∏ä‰∏ãÊñáÂàáÊç¢Ôºâ„ÄÇÂ¶ÇÊûúËøõÁ®ãÂú®Êó∂Èó¥ÁâáÁªìÊùüÂâçÈòªÂ°ûÊàñÁªìÊùüÔºåÂàôCPUÁ´ãÂç≥ËøõË°åÂàáÊç¢Ôºå‰∏çÁî®Á≠âÂæÖÊó∂Èó¥ÁâáÁî®ÂÆå„ÄÇ</p>
<blockquote>
<p>ÂΩìËøõÁ®ãÊöÇÂÅúÊó∂ÔºåÂÆÉ‰ºö‰øùÂ≠òÂΩìÂâçËøõÁ®ãÁöÑÁä∂ÊÄÅÔºàËøõÁ®ãÊ†áËØÜÔºåËøõÁ®ã‰ΩøÁî®ÁöÑËµÑÊ∫êÁ≠âÔºâÔºåÂú®‰∏ã‰∏ÄÊ¨°ÂàáÊç¢ÂõûÊù•Êó∂Ê†πÊçÆ‰πãÂâç‰øùÂ≠òÁöÑÁä∂ÊÄÅËøõË°åÊÅ¢Â§çÔºåÊé•ÁùÄÁªßÁª≠ÊâßË°å„ÄÇ</p>
</blockquote>
<p>‰ΩøÁî®ËøõÁ®ã+CPUÊó∂Èó¥ÁâáËΩÆËΩ¨ÊñπÂºèÁöÑÊìç‰ΩúÁ≥ªÁªüÔºåÂú®ÂÆèËßÇ‰∏äÁúãËµ∑Êù•Âêå‰∏ÄÊó∂Èó¥ÊÆµÊâßË°åÂ§ö‰∏™‰ªªÂä°ÔºåÊç¢Âè•ËØùËØ¥Ôºå<strong>ËøõÁ®ãËÆ©Êìç‰Ωú‰ΩìÁªüÁöÑÂπ∂ÂèëÊàê‰∏∫‰∫ÜÂèØËÉΩ</strong>„ÄÇËôΩÁÑ∂Âπ∂Âèë‰ªéÂÆèËßÇ‰∏äÁúãÊúâÂ§ö‰∏™‰ªªÂä°Âú®ÊâßË°åÔºå‰ΩÜÂú®‰∫ãÂÆû‰∏äÔºåÂØπ‰∫é<strong>ÂçïÊ†∏CPU</strong>Êù•ËØ¥Ôºå‰ªªÊÑèÂÖ∑‰ΩìÊó∂ÂàªÈÉΩÂè™Êúâ‰∏Ä‰∏™‰ªªÂä°Âú®Âç†Áî®CPUËµÑÊ∫ê„ÄÇ</p>
<p><strong>ÂØπÊìç‰ΩúÁ≥ªÁªüÁöÑË¶ÅÊ±ÇËøõ‰∏ÄÊ≠•ÊèêÈ´ò</strong></p>
<p>ËôΩÁÑ∂ËøõÁ®ãÁöÑÂá∫Áé∞Ôºå‰ΩøÂæóÊìç‰ΩúÁ≥ªÁªüÁöÑÊÄßËÉΩÂ§ßÂ§ßÊèêÂçáÔºå‰ΩÜÊòØÈöèÁùÄÊó∂Èó¥ÁöÑÊé®ÁßªÔºå‰∫∫‰ª¨Âπ∂‰∏çÊª°Ë∂≥‰∏Ä‰∏™ËøõÁ®ãÂú®‰∏ÄÊÆµÊó∂Èó¥Âè™ËÉΩÂÅö‰∏Ä‰ª∂‰∫ãÊÉÖÔºåÂ¶ÇÊûú‰∏Ä‰∏™ËøõÁ®ãÊúâÂ§ö‰∏™Â≠ê‰ªªÂä°Êó∂ÔºåÂè™ËÉΩÈÄê‰∏™ÂæóÊâßË°åËøô‰∫õÂ≠ê‰ªªÂä°ÔºåÂæàÂΩ±ÂìçÊïàÁéá„ÄÇ</p>
<blockquote>
<p>ÊØîÂ¶ÇÊùÄÊØíËΩØ‰ª∂Âú®Ê£ÄÊµãÁî®Êà∑ÁîµËÑëÊó∂ÔºåÂ¶ÇÊûúÂú®Êüê‰∏ÄÈ°πÊ£ÄÊµã‰∏≠Âç°‰Ωè‰∫ÜÔºåÈÇ£‰πàÂêéÈù¢ÁöÑÊ£ÄÊµãÈ°π‰πü‰ºöÂèóÂà∞ÂΩ±Âìç„ÄÇÊàñËÄÖËØ¥ÂΩì‰Ω†‰ΩøÁî®ÊùÄÊØíËΩØ‰ª∂‰∏≠ÁöÑÊâ´ÊèèÁóÖÊØíÂäüËÉΩÊó∂ÔºåÂú®Êâ´ÊèèÁóÖÊØíÁªìÊùü‰πãÂâçÔºåÊó†Ê≥ï‰ΩøÁî®ÊùÄÊØíËΩØ‰ª∂‰∏≠Ê∏ÖÁêÜÂûÉÂúæÁöÑÂäüËÉΩÔºåËøôÊòæÁÑ∂Êó†Ê≥ïÊª°Ë∂≥‰∫∫‰ª¨ÁöÑË¶ÅÊ±Ç„ÄÇ</p>
</blockquote>
<p><strong>Á∫øÁ®ãÁöÑÊèêÂá∫</strong></p>
<p>ÈÇ£‰πàËÉΩ‰∏çËÉΩËÆ©Ëøô‰∫õÂ≠ê‰ªªÂä°ÂêåÊó∂ÊâßË°åÂë¢Ôºü‰∫éÊòØ‰∫∫‰ª¨ÂèàÊèêÂá∫‰∫ÜÁ∫øÁ®ãÁöÑÊ¶ÇÂøµÔºå<strong>ËÆ©‰∏Ä‰∏™Á∫øÁ®ãÊâßË°å‰∏Ä‰∏™Â≠ê‰ªªÂä°ÔºåËøôÊ†∑‰∏Ä‰∏™ËøõÁ®ãÂ∞±ÂåÖÂê´‰∫ÜÂ§ö‰∏™Á∫øÁ®ãÔºåÊØè‰∏™Á∫øÁ®ãË¥üË¥£‰∏Ä‰∏™ÂçïÁã¨ÁöÑÂ≠ê‰ªªÂä°„ÄÇ</strong></p>
<blockquote>
<p>‰ΩøÁî®Á∫øÁ®ã‰πãÂêéÔºå‰∫ãÊÉÖÂ∞±ÂèòÂæóÁÆÄÂçïÂ§ö‰∫Ü„ÄÇÂΩìÁî®Êà∑‰ΩøÁî®Êâ´ÊèèÁóÖÊØíÂäüËÉΩÊó∂ÔºåÂ∞±ËÆ©Êâ´ÊèèÁóÖÊØíËøô‰∏™Á∫øÁ®ãÂéªÊâßË°å„ÄÇÂêåÊó∂ÔºåÂ¶ÇÊûúÁî®Êà∑Âèà‰ΩøÁî®Ê∏ÖÁêÜÂûÉÂúæÂäüËÉΩÔºåÈÇ£‰πàÂèØ‰ª•ÂÖàÊöÇÂÅúÊâ´ÊèèÁóÖÊØíÁ∫øÁ®ãÔºåÂÖàÂìçÂ∫îÁî®Êà∑ÁöÑÊ∏ÖÁêÜÂûÉÂúæÁöÑÊìç‰ΩúÔºåËÆ©Ê∏ÖÁêÜÂûÉÂúæËøô‰∏™Á∫øÁ®ãÂéªÊâßË°å„ÄÇÂìçÂ∫îÂÆåÂêéÂÜçÂàáÊç¢ÂõûÊù•ÔºåÊé•ÁùÄÊâßË°åÊâ´ÊèèÁóÖÊØíÁ∫øÁ®ã„ÄÇ</p>
<p>Ê≥®ÊÑèÔºöÊìç‰ΩúÁ≥ªÁªüÊòØÂ¶Ç‰ΩïÂàÜÈÖçÊó∂Èó¥ÁâáÁªôÊØè‰∏Ä‰∏™Á∫øÁ®ãÁöÑÔºåÊ∂âÂèäÂà∞Á∫øÁ®ãÁöÑË∞ÉÂ∫¶Á≠ñÁï•ÔºåÊúâÂÖ¥Ë∂£ÁöÑÂêåÂ≠¶ÂèØ‰ª•Áúã‰∏Ä‰∏ã„ÄäÊìç‰ΩúÁ≥ªÁªü„ÄãÔºåÊú¨Êñá‰∏çÂÅöÊ∑±ÂÖ•ËØ¶Ëß£„ÄÇ</p>
</blockquote>
<p>ÊÄª‰πãÔºåËøõÁ®ãÂíåÁ∫øÁ®ãÁöÑÊèêÂá∫ÊûÅÂ§ßÁöÑÊèêÈ´ò‰∫ÜÊìç‰ΩúÊèê‰æõÁöÑÊÄßËÉΩ„ÄÇ<strong>ËøõÁ®ãËÆ©Êìç‰ΩúÁ≥ªÁªüÁöÑÂπ∂ÂèëÊÄßÊàê‰∏∫‰∫ÜÂèØËÉΩÔºåËÄåÁ∫øÁ®ãËÆ©ËøõÁ®ãÁöÑÂÜÖÈÉ®Âπ∂ÂèëÊàê‰∏∫‰∫ÜÂèØËÉΩ„ÄÇ</strong></p>
<p><strong>Â§öËøõÁ®ãÁöÑÊñπÂºè‰πüÂèØ‰ª•ÂÆûÁé∞Âπ∂ÂèëÔºå‰∏∫‰ªÄ‰πàÊàë‰ª¨Ë¶Å‰ΩøÁî®Â§öÁ∫øÁ®ãÔºü</strong></p>
<p>Â§öËøõÁ®ãÊñπÂºèÁ°ÆÂÆûÂèØ‰ª•ÂÆûÁé∞Âπ∂ÂèëÔºå‰ΩÜ‰ΩøÁî®Â§öÁ∫øÁ®ãÔºåÊúâ‰ª•‰∏ãÂá†‰∏™Â•ΩÂ§ÑÔºö</p>
<p>- </p>
<p>  ËøõÁ®ãÈó¥ÁöÑÈÄö‰ø°ÊØîËæÉÂ§çÊùÇÔºåËÄåÁ∫øÁ®ãÈó¥ÁöÑÈÄö‰ø°ÊØîËæÉÁÆÄÂçïÔºåÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÈúÄË¶Å‰ΩøÁî®ÂÖ±‰∫´ËµÑÊ∫êÔºåËøô‰∫õËµÑÊ∫êÂú®Á∫øÁ®ãÈó¥ÁöÑÈÄö‰ø°ÊØîËæÉÂÆπÊòì„ÄÇ</p>
<p>- </p>
<p>  ËøõÁ®ãÊòØÈáçÈáèÁ∫ßÁöÑÔºåËÄåÁ∫øÁ®ãÊòØËΩªÈáèÁ∫ßÁöÑÔºåÊïÖÂ§öÁ∫øÁ®ãÊñπÂºèÁöÑÁ≥ªÁªüÂºÄÈîÄÊõ¥Â∞è„ÄÇ</p>
<p><strong>ËøõÁ®ãÂíåÁ∫øÁ®ãÁöÑÂå∫Âà´</strong></p>
<p>ËøõÁ®ãÊòØ‰∏Ä‰∏™Áã¨Á´ãÁöÑËøêË°åÁéØÂ¢ÉÔºåËÄåÁ∫øÁ®ãÊòØÂú®ËøõÁ®ã‰∏≠ÊâßË°åÁöÑ‰∏Ä‰∏™‰ªªÂä°„ÄÇ‰ªñ‰ª¨‰∏§‰∏™Êú¨Ë¥®ÁöÑÂå∫Âà´ÊòØ<strong>ÊòØÂê¶ÂçïÁã¨Âç†ÊúâÂÜÖÂ≠òÂú∞ÂùÄÁ©∫Èó¥ÂèäÂÖ∂ÂÆÉÁ≥ªÁªüËµÑÊ∫êÔºàÊØîÂ¶ÇI&#x2F;OÔºâ</strong>Ôºö</p>
<p>- </p>
<p>  ËøõÁ®ãÂçïÁã¨Âç†Êúâ‰∏ÄÂÆöÁöÑÂÜÖÂ≠òÂú∞ÂùÄÁ©∫Èó¥ÔºåÊâÄ‰ª•ËøõÁ®ãÈó¥Â≠òÂú®ÂÜÖÂ≠òÈöîÁ¶ªÔºåÊï∞ÊçÆÊòØÂàÜÂºÄÁöÑÔºåÊï∞ÊçÆÂÖ±‰∫´Â§çÊùÇ‰ΩÜÊòØÂêåÊ≠•ÁÆÄÂçïÔºåÂêÑ‰∏™ËøõÁ®ã‰πãÈó¥‰∫í‰∏çÂπ≤Êâ∞ÔºõËÄåÁ∫øÁ®ãÂÖ±‰∫´ÊâÄÂ±ûËøõÁ®ãÂç†ÊúâÁöÑÂÜÖÂ≠òÂú∞ÂùÄÁ©∫Èó¥ÂíåËµÑÊ∫êÔºåÊï∞ÊçÆÂÖ±‰∫´ÁÆÄÂçïÔºå‰ΩÜÊòØÂêåÊ≠•Â§çÊùÇ„ÄÇ</p>
<p>- </p>
<p>  ËøõÁ®ãÂçïÁã¨Âç†Êúâ‰∏ÄÂÆöÁöÑÂÜÖÂ≠òÂú∞ÂùÄÁ©∫Èó¥Ôºå‰∏Ä‰∏™ËøõÁ®ãÂá∫Áé∞ÈóÆÈ¢ò‰∏ç‰ºöÂΩ±ÂìçÂÖ∂‰ªñËøõÁ®ãÔºå‰∏çÂΩ±Âìç‰∏ªÁ®ãÂ∫èÁöÑÁ®≥ÂÆöÊÄßÔºåÂèØÈù†ÊÄßÈ´òÔºõ‰∏Ä‰∏™Á∫øÁ®ãÂ¥©Ê∫ÉÂèØËÉΩÂΩ±ÂìçÊï¥‰∏™Á®ãÂ∫èÁöÑÁ®≥ÂÆöÊÄßÔºåÂèØÈù†ÊÄßËæÉ‰Ωé„ÄÇ</p>
<p>- </p>
<p>  ËøõÁ®ãÂçïÁã¨Âç†Êúâ‰∏ÄÂÆöÁöÑÂÜÖÂ≠òÂú∞ÂùÄÁ©∫Èó¥ÔºåËøõÁ®ãÁöÑÂàõÂª∫ÂíåÈîÄÊØÅ‰∏ç‰ªÖÈúÄË¶Å‰øùÂ≠òÂØÑÂ≠òÂô®ÂíåÊ†à‰ø°ÊÅØÔºåËøòÈúÄË¶ÅËµÑÊ∫êÁöÑÂàÜÈÖçÂõûÊî∂‰ª•ÂèäÈ°µË∞ÉÂ∫¶ÔºåÂºÄÈîÄËæÉÂ§ßÔºõÁ∫øÁ®ãÂè™ÈúÄË¶Å‰øùÂ≠òÂØÑÂ≠òÂô®ÂíåÊ†à‰ø°ÊÅØÔºåÂºÄÈîÄËæÉÂ∞è„ÄÇ</p>
<p>Âè¶Â§ñ‰∏Ä‰∏™ÈáçË¶ÅÂå∫Âà´ÊòØÔºå<strong>ËøõÁ®ãÊòØÊìç‰ΩúÁ≥ªÁªüËøõË°åËµÑÊ∫êÂàÜÈÖçÁöÑÂü∫Êú¨Âçï‰ΩçÔºåËÄåÁ∫øÁ®ãÊòØÊìç‰ΩúÁ≥ªÁªüËøõË°åË∞ÉÂ∫¶ÁöÑÂü∫Êú¨Âçï‰Ωç</strong>ÔºåÂç≥CPUÂàÜÈÖçÊó∂Èó¥ÁöÑÂçï‰Ωç „ÄÇ</p>
<h2 id="1-2-‰∏ä‰∏ãÊñáÂàáÊç¢"><a href="#1-2-‰∏ä‰∏ãÊñáÂàáÊç¢" class="headerlink" title="1.2 ‰∏ä‰∏ãÊñáÂàáÊç¢"></a>1.2 ‰∏ä‰∏ãÊñáÂàáÊç¢</h2><p>‰∏ä‰∏ãÊñáÂàáÊç¢ÔºàÊúâÊó∂‰πüÁß∞ÂÅöËøõÁ®ãÂàáÊç¢Êàñ‰ªªÂä°ÂàáÊç¢ÔºâÊòØÊåá CPU ‰ªé‰∏Ä‰∏™ËøõÁ®ãÔºàÊàñÁ∫øÁ®ãÔºâÂàáÊç¢Âà∞Âè¶‰∏Ä‰∏™ËøõÁ®ãÔºàÊàñÁ∫øÁ®ãÔºâ„ÄÇ‰∏ä‰∏ãÊñáÊòØÊåá<strong>Êüê‰∏ÄÊó∂Èó¥ÁÇπ CPU ÂØÑÂ≠òÂô®ÂíåÁ®ãÂ∫èËÆ°Êï∞Âô®ÁöÑÂÜÖÂÆπ„ÄÇ</strong></p>
<blockquote>
<p>ÂØÑÂ≠òÂô®ÊòØcpuÂÜÖÈÉ®ÁöÑÂ∞ëÈáèÁöÑÈÄüÂ∫¶ÂæàÂø´ÁöÑÈó™Â≠òÔºåÈÄöÂ∏∏Â≠òÂÇ®ÂíåËÆøÈóÆËÆ°ÁÆóËøáÁ®ãÁöÑ‰∏≠Èó¥ÂÄºÊèêÈ´òËÆ°ÁÆóÊú∫Á®ãÂ∫èÁöÑËøêË°åÈÄüÂ∫¶„ÄÇ</p>
<p>Á®ãÂ∫èËÆ°Êï∞Âô®ÊòØ‰∏Ä‰∏™‰∏ìÁî®ÁöÑÂØÑÂ≠òÂô®ÔºåÁî®‰∫éË°®ÊòéÊåá‰ª§Â∫èÂàó‰∏≠ CPU Ê≠£Âú®ÊâßË°åÁöÑ‰ΩçÁΩÆÔºåÂ≠òÁöÑÂÄº‰∏∫Ê≠£Âú®ÊâßË°åÁöÑÊåá‰ª§ÁöÑ‰ΩçÁΩÆÊàñËÄÖ‰∏ã‰∏Ä‰∏™Â∞ÜË¶ÅË¢´ÊâßË°åÁöÑÊåá‰ª§ÁöÑ‰ΩçÁΩÆÔºåÂÖ∑‰ΩìÂÆûÁé∞‰æùËµñ‰∫éÁâπÂÆöÁöÑÁ≥ªÁªü„ÄÇ</p>
<p>‰∏æ‰æãËØ¥Êòé Á∫øÁ®ãA - B</p>
<p>1.ÂÖàÊåÇËµ∑Á∫øÁ®ãAÔºåÂ∞ÜÂÖ∂Âú®cpu‰∏≠ÁöÑÁä∂ÊÄÅ‰øùÂ≠òÂú®ÂÜÖÂ≠ò‰∏≠„ÄÇ</p>
<p>2.Âú®ÂÜÖÂ≠ò‰∏≠Ê£ÄÁ¥¢‰∏ã‰∏Ä‰∏™Á∫øÁ®ãBÁöÑ‰∏ä‰∏ãÊñáÂπ∂Â∞ÜÂÖ∂Âú® CPU ÁöÑÂØÑÂ≠òÂô®‰∏≠ÊÅ¢Â§ç,ÊâßË°åBÁ∫øÁ®ã„ÄÇ</p>
<p>3.ÂΩìBÊâßË°åÂÆåÔºåÊ†πÊçÆÁ®ãÂ∫èËÆ°Êï∞Âô®‰∏≠ÊåáÂêëÁöÑ‰ΩçÁΩÆÊÅ¢Â§çÁ∫øÁ®ãA„ÄÇ</p>
</blockquote>
<p>CPUÈÄöËøá‰∏∫ÊØè‰∏™Á∫øÁ®ãÂàÜÈÖçCPUÊó∂Èó¥ÁâáÊù•ÂÆûÁé∞Â§öÁ∫øÁ®ãÊú∫Âà∂„ÄÇCPUÈÄöËøáÊó∂Èó¥ÁâáÂàÜÈÖçÁÆóÊ≥ïÊù•Âæ™ÁéØÊâßË°å‰ªªÂä°ÔºåÂΩìÂâç‰ªªÂä°ÊâßË°å‰∏Ä‰∏™Êó∂Èó¥ÁâáÂêé‰ºöÂàáÊç¢Âà∞‰∏ã‰∏Ä‰∏™‰ªªÂä°„ÄÇ</p>
<p>‰ΩÜÊòØÔºåÂú®ÂàáÊç¢Ââç‰ºö‰øùÂ≠ò‰∏ä‰∏Ä‰∏™‰ªªÂä°ÁöÑÁä∂ÊÄÅÔºå‰ª•‰æø‰∏ãÊ¨°ÂàáÊç¢ÂõûËøô‰∏™‰ªªÂä°Êó∂ÔºåÂèØ‰ª•ÂÜçÂä†ËΩΩËøô‰∏™‰ªªÂä°ÁöÑÁä∂ÊÄÅ„ÄÇÊâÄ‰ª•‰ªªÂä°‰ªé‰øùÂ≠òÂà∞ÂÜçÂä†ËΩΩÁöÑËøáÁ®ãÂ∞±ÊòØ‰∏ÄÊ¨°‰∏ä‰∏ãÊñáÂàáÊç¢„ÄÇ</p>
<p>‰∏ä‰∏ãÊñáÂàáÊç¢ÈÄöÂ∏∏ÊòØËÆ°ÁÆóÂØÜÈõÜÂûãÁöÑÔºåÊÑèÂë≥ÁùÄÊ≠§Êìç‰Ωú‰ºö<strong>Ê∂àËÄóÂ§ßÈáèÁöÑ CPU Êó∂Èó¥ÔºåÊïÖÁ∫øÁ®ã‰πü‰∏çÊòØË∂äÂ§öË∂äÂ•Ω</strong>„ÄÇÂ¶Ç‰ΩïÂáèÂ∞ëÁ≥ªÁªü‰∏≠‰∏ä‰∏ãÊñáÂàáÊç¢Ê¨°Êï∞ÔºåÊòØÊèêÂçáÂ§öÁ∫øÁ®ãÊÄßËÉΩÁöÑ‰∏Ä‰∏™ÈáçÁÇπËØæÈ¢ò„ÄÇ</p>
<p><strong>ÂèÇËÄÉËµÑÊñô</strong></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="http://www.cnblogs.com/jijijiefang/articles/7222955.html">Á∫øÁ®ãÁöÑÂá†ÁßçÁä∂ÊÄÅËΩ¨Êç¢</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/whl_program/article/details/70217354">ËøõÁ®ãÂíåÁ∫øÁ®ãÁöÑÁî±Êù•‰∏éÂà´</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://www.cnblogs.com/fuchongjundream/p/3829508.html">ËøõÁ®ã„ÄÅÁ∫øÁ®ã„ÄÅÂ§öÁ∫øÁ®ãÁõ∏ÂÖ≥ÊÄªÁªì</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/derkampf/article/details/60477317">ËøõÁ®ãÁöÑÊ¶ÇÂøµ&#x2F;Ê†áËØÜ&#x2F;ÁªìÊûÑ&#x2F;Áä∂ÊÄÅ</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="http://www.cnblogs.com/tianlangshu/p/5224178.html">Êìç‰ΩúÁ≥ªÁªü - ËøõÁ®ãÁöÑÊ¶ÇÂøµ</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/xd_hebuters/article/details/79590441#%E4%B8%80%E8%BF%9B%E7%A8%8B%E4%BA%A7%E7%94%9F%E7%9A%84%E8%83%8C%E6%99%AF">ËøõÁ®ãÁÆ°ÁêÜÁ¨îËÆ∞‰∏Ä„ÄÅËøõÁ®ãÁöÑÊ¶ÇÂøµÂèäÂÖ∂‰∫ßÁîüÁöÑËÉåÊôØ</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="http://ifeve.com/context-switch-definition/">‰∏ä‰∏ãÊñáÂàáÊç¢</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/derkampf/article/details/60477317">ËøõÁ®ãÁöÑÊ¶ÇÂøµ&#x2F;Ê†áËØÜ&#x2F;ÁªìÊûÑ&#x2F;Áä∂ÊÄÅ</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/asdf_1024/article/details/78978437">Á∫øÁ®ãÁöÑÁîüÂëΩÂë®ÊúüÂèäÁä∂ÊÄÅËΩ¨Êç¢ËØ¶Ëß£</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014319272686365ec7ceaeca33428c914edf8f70cca383000">ËøõÁ®ã‰∏éÁ∫øÁ®ã</a> </p>
<h1 id="2-JavaÂ§öÁ∫øÁ®ãÂÖ•Èó®Á±ªÂíåÊé•Âè£"><a href="#2-JavaÂ§öÁ∫øÁ®ãÂÖ•Èó®Á±ªÂíåÊé•Âè£" class="headerlink" title="2 JavaÂ§öÁ∫øÁ®ãÂÖ•Èó®Á±ªÂíåÊé•Âè£"></a>2 JavaÂ§öÁ∫øÁ®ãÂÖ•Èó®Á±ªÂíåÊé•Âè£</h1><h2 id="2-1-ThreadÁ±ªÂíåRunnableÊé•Âè£"><a href="#2-1-ThreadÁ±ªÂíåRunnableÊé•Âè£" class="headerlink" title="2.1 ThreadÁ±ªÂíåRunnableÊé•Âè£"></a>2.1 ThreadÁ±ªÂíåRunnableÊé•Âè£</h2><p>‰∏ä‰∏ÄÁ´†Êàë‰ª¨‰∫ÜËß£‰∫ÜÊìç‰ΩúÁ≥ªÁªü‰∏≠Â§öÁ∫øÁ®ãÁöÑÂü∫Êú¨Ê¶ÇÂøµ„ÄÇÈÇ£‰πàÂú®Java‰∏≠ÔºåÊàë‰ª¨ÊòØÂ¶Ç‰Ωï‰ΩøÁî®Â§öÁ∫øÁ®ãÁöÑÂë¢Ôºü</p>
<p>È¶ñÂÖàÔºåÊàë‰ª¨ÈúÄË¶ÅÊúâ‰∏Ä‰∏™‚ÄúÁ∫øÁ®ã‚ÄùÁ±ª„ÄÇJDKÊèê‰æõ‰∫Ü<code>Thread</code>Á±ªÂíå<code>Runnalble</code>Êé•Âè£Êù•ËÆ©Êàë‰ª¨ÂÆûÁé∞Ëá™Â∑±ÁöÑ‚ÄúÁ∫øÁ®ã‚ÄùÁ±ª„ÄÇ</p>
<p>- </p>
<p>  ÁªßÊâø<code>Thread</code>Á±ªÔºåÂπ∂ÈáçÂÜô<code>run</code>ÊñπÊ≥ïÔºõ</p>
<p>- </p>
<p>  ÂÆûÁé∞<code>Runnable</code>Êé•Âè£ÁöÑ<code>run</code>ÊñπÊ≥ïÔºõ</p>
<h3 id="2-1-1-ÁªßÊâøThreadÁ±ª"><a href="#2-1-1-ÁªßÊâøThreadÁ±ª" class="headerlink" title="2.1.1 ÁªßÊâøThreadÁ±ª"></a>2.1.1 ÁªßÊâøThreadÁ±ª</h3><p>ÂÖàÂ≠¶‰ºöÊÄé‰πàÁî®ÔºåÂÜçÂ≠¶ÂéüÁêÜ„ÄÇÈ¶ñÂÖàÊàë‰ª¨Êù•ÁúãÁúãÊÄé‰πàÁî®<code>Thread</code>Âíå<code>Runnable</code>Êù•ÂÜô‰∏Ä‰∏™JavaÂ§öÁ∫øÁ®ãÁ®ãÂ∫è„ÄÇ</p>
<p>È¶ñÂÖàÊòØÁªßÊâø<code>Thread</code>Á±ªÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;MyThread&quot;</span>);<br>        &#125;<br>    &#125;<br><br>```java<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-type">Thread</span> <span class="hljs-variable">myThread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyThread</span>();<br>    myThread.start();<br>&#125;<br>```<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>Ê≥®ÊÑèË¶ÅË∞ÉÁî®<code>start()</code>ÊñπÊ≥ïÂêéÔºåËØ•Á∫øÁ®ãÊâçÁÆóÂêØÂä®ÔºÅ</p>
<blockquote>
<p>Êàë‰ª¨Âú®Á®ãÂ∫èÈáåÈù¢Ë∞ÉÁî®‰∫Üstart()ÊñπÊ≥ïÂêéÔºåËôöÊãüÊú∫‰ºöÂÖà‰∏∫Êàë‰ª¨ÂàõÂª∫‰∏Ä‰∏™Á∫øÁ®ãÔºåÁÑ∂ÂêéÁ≠âÂà∞Ëøô‰∏™Á∫øÁ®ãÁ¨¨‰∏ÄÊ¨°ÂæóÂà∞Êó∂Èó¥ÁâáÊó∂ÂÜçË∞ÉÁî®run()ÊñπÊ≥ï„ÄÇ</p>
<p>Ê≥®ÊÑè‰∏çÂèØÂ§öÊ¨°Ë∞ÉÁî®start()ÊñπÊ≥ï„ÄÇÂú®Á¨¨‰∏ÄÊ¨°Ë∞ÉÁî®start()ÊñπÊ≥ïÂêéÔºåÂÜçÊ¨°Ë∞ÉÁî®start()ÊñπÊ≥ï‰ºöÊäõÂá∫ÂºÇÂ∏∏„ÄÇ</p>
</blockquote>
<h3 id="2-1-2-ÂÆûÁé∞RunnableÊé•Âè£"><a href="#2-1-2-ÂÆûÁé∞RunnableÊé•Âè£" class="headerlink" title="2.1.2 ÂÆûÁé∞RunnableÊé•Âè£"></a>2.1.2 ÂÆûÁé∞RunnableÊé•Âè£</h3><p>Êé•ÁùÄÊàë‰ª¨Êù•Áúã‰∏Ä‰∏ã<code>Runnable</code>Êé•Âè£(JDK 1.8 +)Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Runnable</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ÂèØ‰ª•ÁúãÂà∞<code>Runnable</code>ÊòØ‰∏Ä‰∏™ÂáΩÊï∞ÂºèÊé•Âè£ÔºåËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®<strong>Java 8ÁöÑÂáΩÊï∞ÂºèÁºñÁ®ã</strong>Êù•ÁÆÄÂåñ‰ª£Á†Å„ÄÇ</p>
<p>Á§∫‰æã‰ª£Á†ÅÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyThread</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;MyThread&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyThread</span>().start();<br>    <br>        <span class="hljs-comment">// Java 8 ÂáΩÊï∞ÂºèÁºñÁ®ãÔºåÂèØ‰ª•ÁúÅÁï•MyThreadÁ±ª</span><br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; &#123;<br>            System.out.println(<span class="hljs-string">&quot;Java 8 ÂåøÂêçÂÜÖÈÉ®Á±ª&quot;</span>);<br>        &#125;).start();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="2-1-3-ThreadÁ±ªÊûÑÈÄ†ÊñπÊ≥ï"><a href="#2-1-3-ThreadÁ±ªÊûÑÈÄ†ÊñπÊ≥ï" class="headerlink" title="2.1.3 ThreadÁ±ªÊûÑÈÄ†ÊñπÊ≥ï"></a>2.1.3 ThreadÁ±ªÊûÑÈÄ†ÊñπÊ≥ï</h3><p><code>Thread</code>Á±ªÊòØ‰∏Ä‰∏™<code>Runnable</code>Êé•Âè£ÁöÑÂÆûÁé∞Á±ªÔºåÊàë‰ª¨Êù•ÁúãÁúã<code>Thread</code>Á±ªÁöÑÊ∫êÁ†Å„ÄÇ</p>
<p>Êü•Áúã<code>Thread</code>Á±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºåÂèëÁé∞ÂÖ∂ÂÆûÊòØÁÆÄÂçïË∞ÉÁî®‰∏Ä‰∏™ÁßÅÊúâÁöÑ<code>init</code>ÊñπÊ≥ïÊù•ÂÆûÁé∞ÂàùÂßãÂåñ„ÄÇ<code>init</code>ÁöÑÊñπÊ≥ïÁ≠æÂêçÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ThreadÁ±ªÊ∫êÁ†Å </span><br><br><span class="hljs-comment">// ÁâáÊÆµ1 - initÊñπÊ≥ï</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(ThreadGroup g, Runnable target, String name,</span><br><span class="hljs-params">                      <span class="hljs-type">long</span> stackSize, AccessControlContext acc,</span><br><span class="hljs-params">                      <span class="hljs-type">boolean</span> inheritThreadLocals)</span><br><br><span class="hljs-comment">// ÁâáÊÆµ2 - ÊûÑÈÄ†ÂáΩÊï∞Ë∞ÉÁî®initÊñπÊ≥ï</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">Thread</span><span class="hljs-params">(Runnable target)</span> &#123;<br>    init(<span class="hljs-literal">null</span>, target, <span class="hljs-string">&quot;Thread-&quot;</span> + nextThreadNum(), <span class="hljs-number">0</span>);<br>&#125;<br><br><span class="hljs-comment">// ÁâáÊÆµ3 - ‰ΩøÁî®Âú®initÊñπÊ≥ïÈáåÂàùÂßãÂåñAccessControlContextÁ±ªÂûãÁöÑÁßÅÊúâÂ±ûÊÄß</span><br><span class="hljs-built_in">this</span>.inheritedAccessControlContext = <br>    acc != <span class="hljs-literal">null</span> ? acc : AccessController.getContext();<br><br><span class="hljs-comment">// ÁâáÊÆµ4 - ‰∏§‰∏™ÂØπÁî®‰∫éÊîØÊåÅThreadLocalÁöÑÁßÅÊúâÂ±ûÊÄß</span><br>ThreadLocal.<span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">threadLocals</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>ThreadLocal.<span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">inheritableThreadLocals</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br></code></pre></td></tr></table></figure>

<p>Êàë‰ª¨Êå®‰∏™Êù•Ëß£Èáä‰∏Ä‰∏ã<code>init</code>ÊñπÊ≥ïÁöÑËøô‰∫õÂèÇÊï∞Ôºö</p>
<p>gÔºöÁ∫øÁ®ãÁªÑÔºåÊåáÂÆöËøô‰∏™Á∫øÁ®ãÊòØÂú®Âì™‰∏™Á∫øÁ®ãÁªÑ‰∏ãÔºõ</p>
<p>targetÔºöÊåáÂÆöË¶ÅÊâßË°åÁöÑ‰ªªÂä°Ôºõ</p>
<p>nameÔºöÁ∫øÁ®ãÁöÑÂêçÂ≠óÔºåÂ§ö‰∏™Á∫øÁ®ãÁöÑÂêçÂ≠óÊòØÂèØ‰ª•ÈáçÂ§çÁöÑ„ÄÇÂ¶ÇÊûú‰∏çÊåáÂÆöÂêçÂ≠óÔºåËßÅÁâáÊÆµ2Ôºõ</p>
<p>accÔºöËßÅÁâáÊÆµ3ÔºåÁî®‰∫éÂàùÂßãÂåñÁßÅÊúâÂèòÈáè<code>inheritedAccessControlContext</code>„ÄÇ</p>
<blockquote>
<p>Ëøô‰∏™ÂèòÈáèÊúâÁÇπÁ•ûÂ•á„ÄÇÂÆÉÊòØ‰∏Ä‰∏™ÁßÅÊúâÂèòÈáèÔºå‰ΩÜÊòØÂú®<code>Thread</code>Á±ªÈáåÂè™Êúâ<code>init</code>ÊñπÊ≥ïÂØπÂÆÉËøõË°åÂàùÂßãÂåñÔºåÂú®<code>exit</code>ÊñπÊ≥ïÊääÂÆÉËÆæ‰∏∫<code>null</code>„ÄÇÂÖ∂ÂÆÉÊ≤°Êúâ‰ªª‰ΩïÂú∞Êñπ‰ΩøÁî®ÂÆÉ„ÄÇ‰∏ÄËà¨Êàë‰ª¨ÊòØ‰∏ç‰ºö‰ΩøÁî®ÂÆÉÁöÑÔºåÈÇ£‰ªÄ‰πàÊó∂ÂÄô‰ºö‰ΩøÁî®Âà∞Ëøô‰∏™ÂèòÈáèÂë¢ÔºüÂèØ‰ª•ÂèÇËÄÉËøô‰∏™stackoverflowÁöÑÈóÆÈ¢òÔºö<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/13516766/restrict-permissions-to-threads-which-execute-third-party-software">Restrict permissions to threads which execute third party software</a>Ôºõ</p>
</blockquote>
<p>- </p>
<p>  inheritThreadLocalsÔºöÂèØÁªßÊâøÁöÑ<code>ThreadLocal</code>ÔºåËßÅÁâáÊÆµ4Ôºå<code>Thread</code>Á±ªÈáåÈù¢Êúâ‰∏§‰∏™ÁßÅÊúâÂ±ûÊÄßÊù•ÊîØÊåÅ<code>ThreadLocal</code>ÔºåÊàë‰ª¨‰ºöÂú®ÂêéÈù¢ÁöÑÁ´†ËäÇ‰ªãÁªç<code>ThreadLocal</code>ÁöÑÊ¶ÇÂøµ„ÄÇ</p>
<p>ÂÆûÈôÖÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨Â§ßÂ§öÊòØÁõ¥Êé•Ë∞ÉÁî®‰∏ãÈù¢‰∏§‰∏™ÊûÑÈÄ†ÊñπÊ≥ïÔºö</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">Thread</span><span class="hljs-params">(Runnable target)</span></span><br><br><span class="hljs-function"><span class="hljs-title">Thread</span><span class="hljs-params">(Runnable target, String name)</span></span><br><br><br></code></pre></td></tr></table></figure>



<h3 id="2-1-4-ThreadÁ±ªÁöÑÂá†‰∏™Â∏∏Áî®ÊñπÊ≥ï"><a href="#2-1-4-ThreadÁ±ªÁöÑÂá†‰∏™Â∏∏Áî®ÊñπÊ≥ï" class="headerlink" title="2.1.4 ThreadÁ±ªÁöÑÂá†‰∏™Â∏∏Áî®ÊñπÊ≥ï"></a>2.1.4 ThreadÁ±ªÁöÑÂá†‰∏™Â∏∏Áî®ÊñπÊ≥ï</h3><p>ËøôÈáå‰ªãÁªç‰∏Ä‰∏ãThreadÁ±ªÁöÑÂá†‰∏™Â∏∏Áî®ÁöÑÊñπÊ≥ïÔºö</p>
<p>- </p>
<p>  currentThread()ÔºöÈùôÊÄÅÊñπÊ≥ïÔºåËøîÂõûÂØπÂΩìÂâçÊ≠£Âú®ÊâßË°åÁöÑÁ∫øÁ®ãÂØπË±°ÁöÑÂºïÁî®Ôºõ</p>
<p>- </p>
<p>  start()ÔºöÂºÄÂßãÊâßË°åÁ∫øÁ®ãÁöÑÊñπÊ≥ïÔºåjavaËôöÊãüÊú∫‰ºöË∞ÉÁî®Á∫øÁ®ãÂÜÖÁöÑrun()ÊñπÊ≥ïÔºõ</p>
<p>- </p>
<p>  yield()ÔºöyieldÂú®Ëã±ËØ≠ÈáåÊúâÊîæÂºÉÁöÑÊÑèÊÄùÔºåÂêåÊ†∑ÔºåËøôÈáåÁöÑyield()ÊåáÁöÑÊòØÂΩìÂâçÁ∫øÁ®ãÊÑøÊÑèËÆ©Âá∫ÂØπÂΩìÂâçÂ§ÑÁêÜÂô®ÁöÑÂç†Áî®„ÄÇËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂ∞±ÁÆóÂΩìÂâçÁ∫øÁ®ãË∞ÉÁî®‰∫Üyield()ÊñπÊ≥ïÔºåÁ®ãÂ∫èÂú®Ë∞ÉÂ∫¶ÁöÑÊó∂ÂÄôÔºå‰πüËøòÊúâÂèØËÉΩÁªßÁª≠ËøêË°åËøô‰∏™Á∫øÁ®ãÁöÑÔºõ</p>
<p>- </p>
<p>  sleep()ÔºöÈùôÊÄÅÊñπÊ≥ïÔºå‰ΩøÂΩìÂâçÁ∫øÁ®ãÁù°Áú†‰∏ÄÊÆµÊó∂Èó¥Ôºõ</p>
<p>- </p>
<p>  join()Ôºö‰ΩøÂΩìÂâçÁ∫øÁ®ãÁ≠âÂæÖÂè¶‰∏Ä‰∏™Á∫øÁ®ãÊâßË°åÂÆåÊØï‰πãÂêéÂÜçÁªßÁª≠ÊâßË°åÔºåÂÜÖÈÉ®Ë∞ÉÁî®ÁöÑÊòØObjectÁ±ªÁöÑwaitÊñπÊ≥ïÂÆûÁé∞ÁöÑÔºõ</p>
<h3 id="2-1-5-ThreadÁ±ª‰∏éRunnableÊé•Âè£ÁöÑÊØîËæÉÔºö"><a href="#2-1-5-ThreadÁ±ª‰∏éRunnableÊé•Âè£ÁöÑÊØîËæÉÔºö" class="headerlink" title="2.1.5 ThreadÁ±ª‰∏éRunnableÊé•Âè£ÁöÑÊØîËæÉÔºö"></a>2.1.5 ThreadÁ±ª‰∏éRunnableÊé•Âè£ÁöÑÊØîËæÉÔºö</h3><p>ÂÆûÁé∞‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑÁ∫øÁ®ãÁ±ªÔºåÂèØ‰ª•ÊúâÁªßÊâø<code>Thread</code>Á±ªÊàñËÄÖÂÆûÁé∞<code>Runnable</code>Êé•Âè£Ëøô‰∏§ÁßçÊñπÂºèÔºåÂÆÉ‰ª¨‰πãÈó¥Êúâ‰ªÄ‰πà‰ºòÂä£Âë¢Ôºü</p>
<p>- </p>
<p>  Áî±‰∫éJava‚ÄúÂçïÁªßÊâøÔºåÂ§öÂÆûÁé∞‚ÄùÁöÑÁâπÊÄßÔºåRunnableÊé•Âè£‰ΩøÁî®Ëµ∑Êù•ÊØîThreadÊõ¥ÁÅµÊ¥ª„ÄÇ</p>
<p>- </p>
<p>  RunnableÊé•Âè£Âá∫Áé∞Êõ¥Á¨¶ÂêàÈù¢ÂêëÂØπË±°ÔºåÂ∞ÜÁ∫øÁ®ãÂçïÁã¨ËøõË°åÂØπË±°ÁöÑÂ∞ÅË£Ö„ÄÇ</p>
<p>- </p>
<p>  RunnableÊé•Âè£Âá∫Áé∞ÔºåÈôç‰Ωé‰∫ÜÁ∫øÁ®ãÂØπË±°ÂíåÁ∫øÁ®ã‰ªªÂä°ÁöÑËÄ¶ÂêàÊÄß„ÄÇ</p>
<p>- </p>
<p>  Â¶ÇÊûú‰ΩøÁî®Á∫øÁ®ãÊó∂‰∏çÈúÄË¶Å‰ΩøÁî®ThreadÁ±ªÁöÑËØ∏Â§öÊñπÊ≥ïÔºåÊòæÁÑ∂‰ΩøÁî®RunnableÊé•Âè£Êõ¥‰∏∫ËΩªÈáè„ÄÇ</p>
<p>ÊâÄ‰ª•ÔºåÊàë‰ª¨ÈÄöÂ∏∏‰ºòÂÖà‰ΩøÁî®‚ÄúÂÆûÁé∞<code>Runnable</code>Êé•Âè£‚ÄùËøôÁßçÊñπÂºèÊù•Ëá™ÂÆö‰πâÁ∫øÁ®ãÁ±ª„ÄÇ</p>
<h2 id="2-2-Callable„ÄÅFuture‰∏éFutureTask"><a href="#2-2-Callable„ÄÅFuture‰∏éFutureTask" class="headerlink" title="2.2 Callable„ÄÅFuture‰∏éFutureTask"></a>2.2 Callable„ÄÅFuture‰∏éFutureTask</h2><p>ÈÄöÂ∏∏Êù•ËØ¥ÔºåÊàë‰ª¨‰ΩøÁî®<code>Runnable</code>Âíå<code>Thread</code>Êù•ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÁ∫øÁ®ã„ÄÇ‰ΩÜÊòØÂÆÉ‰ª¨Êúâ‰∏Ä‰∏™ÂºäÁ´ØÔºåÂ∞±ÊòØ<code>run</code>ÊñπÊ≥ïÊòØÊ≤°ÊúâËøîÂõûÂÄºÁöÑ„ÄÇËÄåÊúâÊó∂ÂÄôÊàë‰ª¨Â∏åÊúõÂºÄÂêØ‰∏Ä‰∏™Á∫øÁ®ãÂéªÊâßË°å‰∏Ä‰∏™‰ªªÂä°ÔºåÂπ∂‰∏îËøô‰∏™‰ªªÂä°ÊâßË°åÂÆåÊàêÂêéÊúâ‰∏Ä‰∏™ËøîÂõûÂÄº„ÄÇ</p>
<p>JDKÊèê‰æõ‰∫Ü<code>Callable</code>Êé•Âè£‰∏é<code>Future</code>Á±ª‰∏∫Êàë‰ª¨Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåËøô‰πüÊòØÊâÄË∞ìÁöÑ‚ÄúÂºÇÊ≠•‚ÄùÊ®°Âûã„ÄÇ</p>
<h3 id="2-2-1-CallableÊé•Âè£"><a href="#2-2-1-CallableÊé•Âè£" class="headerlink" title="2.2.1 CallableÊé•Âè£"></a>2.2.1 CallableÊé•Âè£</h3><p><code>Callable</code>‰∏é<code>Runnable</code>Á±ª‰ººÔºåÂêåÊ†∑ÊòØÂè™Êúâ‰∏Ä‰∏™ÊäΩË±°ÊñπÊ≥ïÁöÑÂáΩÊï∞ÂºèÊé•Âè£„ÄÇ‰∏çÂêåÁöÑÊòØÔºå<code>Callable</code>Êèê‰æõÁöÑÊñπÊ≥ïÊòØ<strong>ÊúâËøîÂõûÂÄº</strong>ÁöÑÔºåËÄå‰∏îÊîØÊåÅ<strong>Ê≥õÂûã</strong>„ÄÇ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Callable</span>&lt;V&gt; &#123;<br><br>    V <span class="hljs-title function_">call</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception;<br><br>&#125;<br></code></pre></td></tr></table></figure>



<p>ÈÇ£‰∏ÄËà¨ÊòØÊÄé‰πà‰ΩøÁî®<code>Callable</code>ÁöÑÂë¢Ôºü<code>Callable</code>‰∏ÄËà¨ÊòØÈÖçÂêàÁ∫øÁ®ãÊ±†Â∑•ÂÖ∑<code>ExecutorService</code>Êù•‰ΩøÁî®ÁöÑ„ÄÇÊàë‰ª¨‰ºöÂú®ÂêéÁª≠Á´†ËäÇËß£ÈáäÁ∫øÁ®ãÊ±†ÁöÑ‰ΩøÁî®„ÄÇËøôÈáåÂè™‰ªãÁªç<code>ExecutorService</code>ÂèØ‰ª•‰ΩøÁî®<code>submit</code>ÊñπÊ≥ïÊù•ËÆ©‰∏Ä‰∏™<code>Callable</code>Êé•Âè£ÊâßË°å„ÄÇÂÆÉ‰ºöËøîÂõû‰∏Ä‰∏™<code>Future</code>ÔºåÊàë‰ª¨ÂêéÁª≠ÁöÑÁ®ãÂ∫èÂèØ‰ª•ÈÄöËøáËøô‰∏™<code>Future</code>ÁöÑ<code>get</code>ÊñπÊ≥ïÂæóÂà∞ÁªìÊûú„ÄÇ</p>
<p>ËøôÈáåÂèØ‰ª•Áúã‰∏Ä‰∏™ÁÆÄÂçïÁöÑ‰ΩøÁî®demoÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Future</span>&lt;V&gt; &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">cancel</span><span class="hljs-params">(<span class="hljs-type">boolean</span> paramBoolean)</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isCancelled</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDone</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> V <span class="hljs-title function_">get</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException, ExecutionException;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> V <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">long</span> paramLong, TimeUnit paramTimeUnit)</span><br>            <span class="hljs-keyword">throws</span> InterruptedException, ExecutionException, TimeoutException;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>cancel</code>ÊñπÊ≥ïÊòØËØïÂõæÂèñÊ∂à‰∏Ä‰∏™Á∫øÁ®ãÁöÑÊâßË°å„ÄÇ</p>
<p>Ê≥®ÊÑèÊòØ<strong>ËØïÂõæ</strong>ÂèñÊ∂àÔºå<strong>Âπ∂‰∏ç‰∏ÄÂÆöËÉΩÂèñÊ∂àÊàêÂäü</strong>„ÄÇÂõ†‰∏∫‰ªªÂä°ÂèØËÉΩÂ∑≤ÂÆåÊàê„ÄÅÂ∑≤ÂèñÊ∂à„ÄÅÊàñËÄÖ‰∏Ä‰∫õÂÖ∂ÂÆÉÂõ†Á¥†‰∏çËÉΩÂèñÊ∂àÔºåÂ≠òÂú®ÂèñÊ∂àÂ§±Ë¥•ÁöÑÂèØËÉΩ„ÄÇ<code>boolean</code>Á±ªÂûãÁöÑËøîÂõûÂÄºÊòØ‚ÄúÊòØÂê¶ÂèñÊ∂àÊàêÂäü‚ÄùÁöÑÊÑèÊÄù„ÄÇÂèÇÊï∞<code>paramBoolean</code>Ë°®Á§∫ÊòØÂê¶ÈááÁî®‰∏≠Êñ≠ÁöÑÊñπÂºèÂèñÊ∂àÁ∫øÁ®ãÊâßË°å„ÄÇ</p>
<p>ÊâÄ‰ª•ÊúâÊó∂ÂÄôÔºå‰∏∫‰∫ÜËÆ©‰ªªÂä°ÊúâËÉΩÂ§üÂèñÊ∂àÁöÑÂäüËÉΩÔºåÂ∞±‰ΩøÁî®<code>Callable</code>Êù•‰ª£Êõø<code>Runnable</code>„ÄÇÂ¶ÇÊûú‰∏∫‰∫ÜÂèØÂèñÊ∂àÊÄßËÄå‰ΩøÁî® <code>Future</code>‰ΩÜÂèà‰∏çÊèê‰æõÂèØÁî®ÁöÑÁªìÊûúÔºåÂàôÂèØ‰ª•Â£∞Êòé <code>Future&lt;?&gt;</code>ÂΩ¢ÂºèÁ±ªÂûã„ÄÅÂπ∂ËøîÂõû <code>null</code>‰Ωú‰∏∫Â∫ïÂ±Ç‰ªªÂä°ÁöÑÁªìÊûú„ÄÇ</p>
<h3 id="2-2-3-FutureTaskÁ±ª"><a href="#2-2-3-FutureTaskÁ±ª" class="headerlink" title="2.2.3 FutureTaskÁ±ª"></a>2.2.3 FutureTaskÁ±ª</h3><p>‰∏äÈù¢‰ªãÁªç‰∫Ü<code>Future</code>Êé•Âè£„ÄÇËøô‰∏™Êé•Âè£Êúâ‰∏Ä‰∏™ÂÆûÁé∞Á±ªÂè´<code>FutureTask</code>„ÄÇ<code>FutureTask</code>ÊòØÂÆûÁé∞ÁöÑ<code>RunnableFuture</code>Êé•Âè£ÁöÑÔºåËÄå<code>RunnableFuture</code>Êé•Âè£ÂêåÊó∂ÁªßÊâø‰∫Ü<code>Runnable</code>Êé•Âè£Âíå<code>Future</code>Êé•Âè£Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Ëá™ÂÆö‰πâCallableÔºå‰∏é‰∏äÈù¢‰∏ÄÊ†∑</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Callable</span>&lt;Integer&gt;&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">call</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">// Ê®°ÊãüËÆ°ÁÆóÈúÄË¶Å‰∏ÄÁßí</span><br>        Thread.sleep(<span class="hljs-number">1000</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String args[])</span>&#123;<br>        <span class="hljs-comment">// ‰ΩøÁî®</span><br>        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newCachedThreadPool();<br>        FutureTask&lt;Integer&gt; futureTask = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FutureTask</span>&lt;&gt;(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Task</span>());<br>        executor.submit(futureTask);<br>        System.out.println(futureTask.get());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<p>ÈÇ£<code>FutureTask</code>Á±ªÊúâ‰ªÄ‰πàÁî®Ôºü‰∏∫‰ªÄ‰πàË¶ÅÊúâ‰∏Ä‰∏™<code>FutureTask</code>Á±ªÔºüÂâçÈù¢ËØ¥Âà∞‰∫Ü<code>Future</code>Âè™ÊòØ‰∏Ä‰∏™Êé•Âè£ÔºåËÄåÂÆÉÈáåÈù¢ÁöÑ<code>cancel</code>Ôºå<code>get</code>Ôºå<code>isDone</code>Á≠âÊñπÊ≥ïË¶ÅËá™Â∑±ÂÆûÁé∞Ëµ∑Êù•ÈÉΩÊòØ<strong>ÈùûÂ∏∏Â§çÊùÇ</strong>ÁöÑ„ÄÇÊâÄ‰ª•JDKÊèê‰æõ‰∫Ü‰∏Ä‰∏™<code>FutureTask</code>Á±ªÊù•‰æõÊàë‰ª¨‰ΩøÁî®„ÄÇ</p>
<p>Á§∫‰æã‰ª£Á†ÅÔºö</p>
<ul>
<li>&#96;&#96;&#96;java<br>&#x2F;**<ul>
<li></li>
<li><p>stateÂèØËÉΩÁöÑÁä∂ÊÄÅËΩ¨ÂèòË∑ØÂæÑÂ¶Ç‰∏ãÔºö</p>
</li>
<li><p>NEW -&gt; COMPLETING -&gt; NORMAL</p>
</li>
<li><p>NEW -&gt; COMPLETING -&gt; EXCEPTIONAL</p>
</li>
<li><p>NEW -&gt; CANCELLED</p>
</li>
<li><p>NEW -&gt; INTERRUPTING -&gt; INTERRUPTED<br>*&#x2F;<br>private volatile int state;<br>private static final int NEW          &#x3D; 0;<br>private static final int COMPLETING   &#x3D; 1;<br>private static final int NORMAL       &#x3D; 2;<br>private static final int EXCEPTIONAL  &#x3D; 3;<br>private static final int CANCELLED    &#x3D; 4;<br>private static final int INTERRUPTING &#x3D; 5;<br>private static final int INTERRUPTED  &#x3D; 6;</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs less">    <br>    <br><br>&gt; <span class="hljs-selector-tag">state</span>Ë°®Á§∫‰ªªÂä°ÁöÑËøêË°åÁä∂ÊÄÅÔºåÂàùÂßãÁä∂ÊÄÅ‰∏∫<span class="hljs-selector-tag">NEW</span>„ÄÇËøêË°åÁä∂ÊÄÅÂè™‰ºöÂú®<span class="hljs-selector-tag">set</span>„ÄÅ<span class="hljs-selector-tag">setException</span>„ÄÅ<span class="hljs-selector-tag">cancel</span>ÊñπÊ≥ï‰∏≠ÁªàÊ≠¢„ÄÇ<span class="hljs-selector-tag">COMPLETING</span>„ÄÅ<span class="hljs-selector-tag">INTERRUPTING</span>ÊòØ‰ªªÂä°ÂÆåÊàêÂêéÁöÑÁû¨Êó∂Áä∂ÊÄÅ„ÄÇ<br><br>‰ª•‰∏äÂ∞±ÊòØ<span class="hljs-selector-tag">Java</span>Â§öÁ∫øÁ®ãÂá†‰∏™Âü∫Êú¨ÁöÑÁ±ªÂíåÊé•Âè£ÁöÑ‰ªãÁªç„ÄÇÂèØ‰ª•ÊâìÂºÄ<span class="hljs-selector-tag">JDK</span>ÁúãÁúãÊ∫êÁ†ÅÔºå‰Ωì‰ºöËøôÂá†‰∏™Á±ªÁöÑËÆæËÆ°ÊÄùË∑ØÂíåÁî®ÈÄîÂêßÔºÅ<br><br>**ÂèÇËÄÉËµÑÊñô**<br><br><span class="hljs-selector-tag">-</span> <br><br>  <span class="hljs-selector-attr">[JavaËØ≠Ë®ÄÂÆö‰πâÁöÑÁ∫øÁ®ãÁä∂ÊÄÅÂàÜÊûê]</span>(<span class="hljs-attribute">https</span>:<span class="hljs-comment">//www.cnblogs.com/trust-freedom/p/6606594.html)</span><br><br>- <br><br>  [JavaÁ∫øÁ®ãÁä∂ÊÄÅÂàÜÊûê](<span class="hljs-attribute">https</span>:<span class="hljs-comment">//fangjian0423.github.io/2016/06/04/java-thread-state/)</span><br><br>- <br><br>  [FutureTaskÊ∫êÁ†ÅÂàÜÊûê](<span class="hljs-attribute">https</span>:<span class="hljs-comment">//my.oschina.net/7001/blog/875658)</span><br><br><br><br># <span class="hljs-number">3</span> Á∫øÁ®ãÁªÑÂíåÁ∫øÁ®ã‰ºòÂÖàÁ∫ß<br><br>## <span class="hljs-number">3.1</span> Á∫øÁ®ãÁªÑ(ThreadGroup)<br><br>Java‰∏≠Áî®ThreadGroupÊù•Ë°®Á§∫Á∫øÁ®ãÁªÑÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®Á∫øÁ®ãÁªÑÂØπÁ∫øÁ®ãËøõË°åÊâπÈáèÊéßÂà∂„ÄÇ<br><br>ThreadGroupÂíåThreadÁöÑÂÖ≥Á≥ªÂ∞±Â¶ÇÂêå‰ªñ‰ª¨ÁöÑÂ≠óÈù¢ÊÑèÊÄù‰∏ÄÊ†∑ÁÆÄÂçïÁ≤óÊö¥ÔºåÊØè‰∏™ThreadÂøÖÁÑ∂Â≠òÂú®‰∫é‰∏Ä‰∏™ThreadGroup‰∏≠ÔºåThread‰∏çËÉΩÁã¨Á´ã‰∫éThreadGroupÂ≠òÂú®„ÄÇÊâßË°å<span class="hljs-built_in">main</span>()ÊñπÊ≥ïÁ∫øÁ®ãÁöÑÂêçÂ≠óÊòØmainÔºåÂ¶ÇÊûúÂú®new ThreadÊó∂Ê≤°ÊúâÊòæÂºèÊåáÂÆöÔºåÈÇ£‰πàÈªòËÆ§Â∞ÜÁà∂Á∫øÁ®ãÔºàÂΩìÂâçÊâßË°ånew ThreadÁöÑÁ∫øÁ®ãÔºâÁ∫øÁ®ãÁªÑËÆæÁΩÆ‰∏∫Ëá™Â∑±ÁöÑÁ∫øÁ®ãÁªÑ„ÄÇ<br><br>Á§∫‰æã‰ª£Á†ÅÔºö<br><br><span class="hljs-built_in">``</span>`java<br>public class Demo &#123;<br>    public static void <span class="hljs-built_in">main</span>(String[] args) &#123;<br>        Thread testThread = new <span class="hljs-built_in">Thread</span>(() -&gt; &#123;<br>            System.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">&quot;testThreadÂΩìÂâçÁ∫øÁ®ãÁªÑÂêçÂ≠óÔºö&quot;</span> +<br>                    Thread.<span class="hljs-built_in">currentThread</span>().<span class="hljs-built_in">getThreadGroup</span>().<span class="hljs-built_in">getName</span>());<br>            System.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">&quot;testThreadÁ∫øÁ®ãÂêçÂ≠óÔºö&quot;</span> +<br>                    Thread.<span class="hljs-built_in">currentThread</span>().<span class="hljs-built_in">getName</span>());<br>        &#125;);<br><br>        testThread.<span class="hljs-built_in">start</span>();<br>        System.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">&quot;ÊâßË°åmainÊñπÊ≥ïÁ∫øÁ®ãÂêçÂ≠óÔºö&quot;</span> + Thread.<span class="hljs-built_in">currentThread</span>().<span class="hljs-built_in">getName</span>());<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p>ËæìÂá∫ÁªìÊûúÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">ÊâßË°åmainÊñπÊ≥ïÁ∫øÁ®ãÂêçÂ≠óÔºömain<br><br>testThreadÂΩìÂâçÁ∫øÁ®ãÁªÑÂêçÂ≠óÔºömain<br><br>testThreadÁ∫øÁ®ãÂêçÂ≠óÔºöThread-<span class="hljs-number">0</span><br><br><br></code></pre></td></tr></table></figure>

<p>ThreadGroupÁÆ°ÁêÜÁùÄÂÆÉ‰∏ãÈù¢ÁöÑThreadÔºåThreadGroupÊòØ‰∏Ä‰∏™Ê†áÂáÜÁöÑ<strong>Âêë‰∏ãÂºïÁî®</strong>ÁöÑÊ†ëÁä∂ÁªìÊûÑÔºåËøôÊ†∑ËÆæËÆ°ÁöÑÂéüÂõ†ÊòØ<strong>Èò≤Ê≠¢‚Äù‰∏äÁ∫ß‚ÄùÁ∫øÁ®ãË¢´‚Äù‰∏ãÁ∫ß‚ÄùÁ∫øÁ®ãÂºïÁî®ËÄåÊó†Ê≥ïÊúâÊïàÂú∞Ë¢´GCÂõûÊî∂</strong>„ÄÇ</p>
<h2 id="3-2-Á∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ß"><a href="#3-2-Á∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ß" class="headerlink" title="3.2 Á∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ß"></a>3.2 Á∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ß</h2><p>Java‰∏≠Á∫øÁ®ã‰ºòÂÖàÁ∫ßÂèØ‰ª•ÊåáÂÆöÔºåËåÉÂõ¥ÊòØ1~10„ÄÇ‰ΩÜÊòØÂπ∂‰∏çÊòØÊâÄÊúâÁöÑÊìç‰ΩúÁ≥ªÁªüÈÉΩÊîØÊåÅ10Á∫ß‰ºòÂÖàÁ∫ßÁöÑÂàíÂàÜÔºàÊØîÂ¶ÇÊúâ‰∫õÊìç‰ΩúÁ≥ªÁªüÂè™ÊîØÊåÅ3Á∫ßÂàíÂàÜÔºö‰ΩéÔºå‰∏≠ÔºåÈ´òÔºâÔºåJavaÂè™ÊòØÁªôÊìç‰ΩúÁ≥ªÁªü‰∏Ä‰∏™‰ºòÂÖàÁ∫ßÁöÑ<strong>ÂèÇËÄÉÂÄº</strong>ÔºåÁ∫øÁ®ãÊúÄÁªà<strong>Âú®Êìç‰ΩúÁ≥ªÁªüÁöÑ‰ºòÂÖàÁ∫ß</strong>ÊòØÂ§öÂ∞ëËøòÊòØÁî±Êìç‰ΩúÁ≥ªÁªüÂÜ≥ÂÆö„ÄÇ</p>
<p><font color='red'>JavaÈªòËÆ§ÁöÑÁ∫øÁ®ã‰ºòÂÖàÁ∫ß‰∏∫5Ôºå</font>Á∫øÁ®ãÁöÑÊâßË°åÈ°∫Â∫èÁî±Ë∞ÉÂ∫¶Á®ãÂ∫èÊù•ÂÜ≥ÂÆöÔºåÁ∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ß‰ºöÂú®Á∫øÁ®ãË¢´Ë∞ÉÁî®‰πãÂâçËÆæÂÆö„ÄÇ</p>
<p>ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåÈ´ò‰ºòÂÖàÁ∫ßÁöÑÁ∫øÁ®ãÂ∞Ü‰ºöÊØî‰Ωé‰ºòÂÖàÁ∫ßÁöÑÁ∫øÁ®ãÊúâ<strong>Êõ¥È´òÁöÑÂá†Áéá</strong>ÂæóÂà∞ÊâßË°å„ÄÇÊàë‰ª¨‰ΩøÁî®ÊñπÊ≥ï<code>Thread</code>Á±ªÁöÑ<code>setPriority()</code>ÂÆû‰æãÊñπÊ≥ïÊù•ËÆæÂÆöÁ∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ß„ÄÇ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>();<br>        System.out.println(<span class="hljs-string">&quot;ÊàëÊòØÈªòËÆ§Á∫øÁ®ã‰ºòÂÖàÁ∫ßÔºö&quot;</span>+a.getPriority());<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>();<br>        b.setPriority(<span class="hljs-number">10</span>);<br>        System.out.println(<span class="hljs-string">&quot;ÊàëÊòØËÆæÁΩÆËøáÁöÑÁ∫øÁ®ã‰ºòÂÖàÁ∫ßÔºö&quot;</span>+b.getPriority());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ËæìÂá∫ÁªìÊûúÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">ÊàëÊòØÈªòËÆ§Á∫øÁ®ã‰ºòÂÖàÁ∫ßÔºö<span class="hljs-number">5</span><br><br>ÊàëÊòØËÆæÁΩÆËøáÁöÑÁ∫øÁ®ã‰ºòÂÖàÁ∫ßÔºö<span class="hljs-number">10</span><br><br><br></code></pre></td></tr></table></figure>

<p>Êó¢ÁÑ∂Êúâ1-10ÁöÑÁ∫ßÂà´Êù•ËÆæÂÆö‰∫ÜÁ∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ßÔºåËøôÊó∂ÂÄôÂèØËÉΩÊúâ‰∫õËØªËÄÖ‰ºöÈóÆÔºåÈÇ£‰πàÊàëÊòØ‰∏çÊòØÂèØ‰ª•Âú®‰∏öÂä°ÂÆûÁé∞ÁöÑÊó∂ÂÄôÔºåÈááÁî®ËøôÁßçÊñπÊ≥ïÊù•ÊåáÂÆö‰∏Ä‰∫õÁ∫øÁ®ãÊâßË°åÁöÑÂÖàÂêéÈ°∫Â∫èÔºü</p>
<p>ÂØπ‰∫éËøô‰∏™ÈóÆÈ¢òÔºåÊàë‰ª¨ÁöÑÁ≠îÊ°àÊòØ:No!</p>
<p>Java‰∏≠ÁöÑ‰ºòÂÖàÁ∫ßÊù•ËØ¥‰∏çÊòØÁâπÂà´ÁöÑÂèØÈù†Ôºå<strong>JavaÁ®ãÂ∫è‰∏≠ÂØπÁ∫øÁ®ãÊâÄËÆæÁΩÆÁöÑ‰ºòÂÖàÁ∫ßÂè™ÊòØÁªôÊìç‰ΩúÁ≥ªÁªü‰∏Ä‰∏™Âª∫ËÆÆÔºåÊìç‰ΩúÁ≥ªÁªü‰∏ç‰∏ÄÂÆö‰ºöÈááÁ∫≥„ÄÇËÄåÁúüÊ≠£ÁöÑË∞ÉÁî®È°∫Â∫èÔºåÊòØÁî±Êìç‰ΩúÁ≥ªÁªüÁöÑÁ∫øÁ®ãË∞ÉÂ∫¶ÁÆóÊ≥ïÂÜ≥ÂÆöÁöÑ</strong>„ÄÇ</p>
<p>Êàë‰ª¨ÈÄöËøá‰ª£Á†ÅÊù•È™åËØÅ‰∏Ä‰∏ãÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">T1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-built_in">super</span>.run();<br>            System.out.println(String.format(<span class="hljs-string">&quot;ÂΩìÂâçÊâßË°åÁöÑÁ∫øÁ®ãÊòØÔºö%sÔºå‰ºòÂÖàÁ∫ßÔºö%d&quot;</span>,<br>                    Thread.currentThread().getName(),<br>                    Thread.currentThread().getPriority()));<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        IntStream.range(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>).forEach(i -&gt; &#123;<br>            <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">T1</span>());<br>            thread.setPriority(i);<br>            thread.start();<br>        &#125;);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>ÊüêÊ¨°ËæìÂá∫Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java">ÂΩìÂâçÊâßË°åÁöÑÁ∫øÁ®ãÊòØÔºöThread-<span class="hljs-number">17</span>Ôºå‰ºòÂÖàÁ∫ßÔºö<span class="hljs-number">9</span><br><br>ÂΩìÂâçÊâßË°åÁöÑÁ∫øÁ®ãÊòØÔºöThread-<span class="hljs-number">1</span>Ôºå‰ºòÂÖàÁ∫ßÔºö<span class="hljs-number">1</span><br><br>ÂΩìÂâçÊâßË°åÁöÑÁ∫øÁ®ãÊòØÔºöThread-<span class="hljs-number">13</span>Ôºå‰ºòÂÖàÁ∫ßÔºö<span class="hljs-number">7</span><br><br>ÂΩìÂâçÊâßË°åÁöÑÁ∫øÁ®ãÊòØÔºöThread-<span class="hljs-number">11</span>Ôºå‰ºòÂÖàÁ∫ßÔºö<span class="hljs-number">6</span><br><br>ÂΩìÂâçÊâßË°åÁöÑÁ∫øÁ®ãÊòØÔºöThread-<span class="hljs-number">15</span>Ôºå‰ºòÂÖàÁ∫ßÔºö<span class="hljs-number">8</span><br><br>ÂΩìÂâçÊâßË°åÁöÑÁ∫øÁ®ãÊòØÔºöThread-<span class="hljs-number">7</span>Ôºå‰ºòÂÖàÁ∫ßÔºö<span class="hljs-number">4</span><br><br>ÂΩìÂâçÊâßË°åÁöÑÁ∫øÁ®ãÊòØÔºöThread-<span class="hljs-number">9</span>Ôºå‰ºòÂÖàÁ∫ßÔºö<span class="hljs-number">5</span><br><br>ÂΩìÂâçÊâßË°åÁöÑÁ∫øÁ®ãÊòØÔºöThread-<span class="hljs-number">3</span>Ôºå‰ºòÂÖàÁ∫ßÔºö<span class="hljs-number">2</span><br><br>ÂΩìÂâçÊâßË°åÁöÑÁ∫øÁ®ãÊòØÔºöThread-<span class="hljs-number">5</span>Ôºå‰ºòÂÖàÁ∫ßÔºö<span class="hljs-number">3</span><br><br><br></code></pre></td></tr></table></figure>

<p>JavaÊèê‰æõ‰∏Ä‰∏™<strong>Á∫øÁ®ãË∞ÉÂ∫¶Âô®</strong>Êù•ÁõëËßÜÂíåÊéßÂà∂Â§Ñ‰∫é<strong>RUNNABLEÁä∂ÊÄÅ</strong>ÁöÑÁ∫øÁ®ã„ÄÇÁ∫øÁ®ãÁöÑË∞ÉÂ∫¶Á≠ñÁï•ÈááÁî®<strong>Êä¢Âç†Âºè</strong>Ôºå‰ºòÂÖàÁ∫ßÈ´òÁöÑÁ∫øÁ®ãÊØî‰ºòÂÖàÁ∫ß‰ΩéÁöÑÁ∫øÁ®ã‰ºöÊúâÊõ¥Â§ßÁöÑÂá†Áéá‰ºòÂÖàÊâßË°å„ÄÇÂú®‰ºòÂÖàÁ∫ßÁõ∏ÂêåÁöÑÊÉÖÂÜµ‰∏ãÔºåÊåâÁÖß‚ÄúÂÖàÂà∞ÂÖàÂæó‚ÄùÁöÑÂéüÂàô„ÄÇÊØè‰∏™JavaÁ®ãÂ∫èÈÉΩÊúâ‰∏Ä‰∏™ÈªòËÆ§ÁöÑ‰∏ªÁ∫øÁ®ãÔºåÂ∞±ÊòØÈÄöËøáJVMÂêØÂä®ÁöÑÁ¨¨‰∏Ä‰∏™Á∫øÁ®ãmainÁ∫øÁ®ã„ÄÇ</p>
<p>ËøòÊúâ‰∏ÄÁßçÁ∫øÁ®ãÁß∞‰∏∫<strong>ÂÆàÊä§Á∫øÁ®ãÔºàDaemonÔºâ</strong>ÔºåÂÆàÊä§Á∫øÁ®ãÈªòËÆ§ÁöÑ‰ºòÂÖàÁ∫ßÊØîËæÉ‰Ωé„ÄÇ</p>
<blockquote>
<p>Â¶ÇÊûúÊüêÁ∫øÁ®ãÊòØÂÆàÊä§Á∫øÁ®ãÔºåÈÇ£Â¶ÇÊûúÊâÄ‰ª•ÁöÑÈùûÂÆàÊä§Á∫øÁ®ãÁªìÊùüÔºåËøô‰∏™ÂÆàÊä§Á∫øÁ®ã‰πü‰ºöËá™Âä®ÁªìÊùü„ÄÇ</p>
<p>Â∫îÁî®Âú∫ÊôØÊòØÔºöÂΩìÊâÄÊúâÈùûÂÆàÊä§Á∫øÁ®ãÁªìÊùüÊó∂ÔºåÁªìÊùüÂÖ∂‰ΩôÁöÑÂ≠êÁ∫øÁ®ãÔºàÂÆàÊä§Á∫øÁ®ãÔºâËá™Âä®ÂÖ≥Èó≠ÔºåÂ∞±ÂÖçÂéª‰∫ÜËøòË¶ÅÁªßÁª≠ÂÖ≥Èó≠Â≠êÁ∫øÁ®ãÁöÑÈ∫ªÁÉ¶„ÄÇ</p>
<p>‰∏Ä‰∏™Á∫øÁ®ãÈªòËÆ§ÊòØÈùûÂÆàÊä§Á∫øÁ®ãÔºåÂèØ‰ª•ÈÄöËøáThreadÁ±ªÁöÑsetDaemon(boolean on)Êù•ËÆæÁΩÆ„ÄÇ</p>
</blockquote>
<p>Âú®‰πãÂâçÔºåÊàë‰ª¨ÊúâË∞àÂà∞‰∏Ä‰∏™Á∫øÁ®ãÂøÖÁÑ∂Â≠òÂú®‰∫é‰∏Ä‰∏™Á∫øÁ®ãÁªÑ‰∏≠ÔºåÈÇ£‰πàÂΩìÁ∫øÁ®ãÂíåÁ∫øÁ®ãÁªÑÁöÑ‰ºòÂÖàÁ∫ß‰∏ç‰∏ÄËá¥ÁöÑÊó∂ÂÄôÂ∞Ü‰ºöÊÄéÊ†∑Âë¢ÔºüÊàë‰ª¨Áî®‰∏ãÈù¢ÁöÑÊ°à‰æãÊù•È™åËØÅ‰∏Ä‰∏ãÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-type">ThreadGroup</span> <span class="hljs-variable">threadGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadGroup</span>(<span class="hljs-string">&quot;t1&quot;</span>);<br>    threadGroup.setMaxPriority(<span class="hljs-number">6</span>);<br>    <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(threadGroup,<span class="hljs-string">&quot;thread&quot;</span>);<br>    thread.setPriority(<span class="hljs-number">9</span>);<br>    System.out.println(<span class="hljs-string">&quot;ÊàëÊòØÁ∫øÁ®ãÁªÑÁöÑ‰ºòÂÖàÁ∫ß&quot;</span>+threadGroup.getMaxPriority());<br>    System.out.println(<span class="hljs-string">&quot;ÊàëÊòØÁ∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ß&quot;</span>+thread.getPriority());<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ËæìÂá∫Ôºö</p>
<blockquote>
<p>ÊàëÊòØÁ∫øÁ®ãÁªÑÁöÑ‰ºòÂÖàÁ∫ß6 ÊàëÊòØÁ∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ß6</p>
</blockquote>
<p>ÊâÄ‰ª•ÔºåÂ¶ÇÊûúÊüê‰∏™Á∫øÁ®ã‰ºòÂÖàÁ∫ßÂ§ß‰∫éÁ∫øÁ®ãÊâÄÂú®<strong>Á∫øÁ®ãÁªÑÁöÑÊúÄÂ§ß‰ºòÂÖàÁ∫ß</strong>ÔºåÈÇ£‰πàËØ•Á∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ßÂ∞Ü‰ºöÂ§±ÊïàÔºåÂèñËÄå‰ª£‰πãÁöÑÊòØÁ∫øÁ®ãÁªÑÁöÑÊúÄÂ§ß‰ºòÂÖàÁ∫ß„ÄÇ</p>
<h2 id="3-3-Á∫øÁ®ãÁªÑÁöÑÂ∏∏Áî®ÊñπÊ≥ïÂèäÊï∞ÊçÆÁªìÊûÑ"><a href="#3-3-Á∫øÁ®ãÁªÑÁöÑÂ∏∏Áî®ÊñπÊ≥ïÂèäÊï∞ÊçÆÁªìÊûÑ" class="headerlink" title="3.3 Á∫øÁ®ãÁªÑÁöÑÂ∏∏Áî®ÊñπÊ≥ïÂèäÊï∞ÊçÆÁªìÊûÑ"></a>3.3 Á∫øÁ®ãÁªÑÁöÑÂ∏∏Áî®ÊñπÊ≥ïÂèäÊï∞ÊçÆÁªìÊûÑ</h2><h3 id="3-3-1-Á∫øÁ®ãÁªÑÁöÑÂ∏∏Áî®ÊñπÊ≥ï"><a href="#3-3-1-Á∫øÁ®ãÁªÑÁöÑÂ∏∏Áî®ÊñπÊ≥ï" class="headerlink" title="3.3.1 Á∫øÁ®ãÁªÑÁöÑÂ∏∏Áî®ÊñπÊ≥ï"></a>3.3.1 Á∫øÁ®ãÁªÑÁöÑÂ∏∏Áî®ÊñπÊ≥ï</h3><p><strong>Ëé∑ÂèñÂΩìÂâçÁöÑÁ∫øÁ®ãÁªÑÂêçÂ≠ó</strong></p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Thread</span>.</span></span>current<span class="hljs-constructor">Thread()</span>.get<span class="hljs-constructor">ThreadGroup()</span>.get<span class="hljs-constructor">Name()</span><br></code></pre></td></tr></table></figure>

<p><strong>Â§çÂà∂Á∫øÁ®ãÁªÑ</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Â§çÂà∂‰∏Ä‰∏™Á∫øÁ®ãÊï∞ÁªÑÂà∞‰∏Ä‰∏™Á∫øÁ®ãÁªÑ</span><br>Thread[] threads = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>[threadGroup.activeCount()];<br><span class="hljs-type">TheadGroup</span> <span class="hljs-variable">threadGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadGroup</span>();<br>threadGroup.enumerate(threads);<br></code></pre></td></tr></table></figure>

<p><strong>Á∫øÁ®ãÁªÑÁªü‰∏ÄÂºÇÂ∏∏Â§ÑÁêÜ</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.func.axc.threadgroup;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadGroupDemo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ThreadGroup</span> <span class="hljs-variable">threadGroup1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadGroup</span>(<span class="hljs-string">&quot;group1&quot;</span>) &#123;<br>            <span class="hljs-comment">// ÁªßÊâøThreadGroupÂπ∂ÈáçÊñ∞ÂÆö‰πâ‰ª•‰∏ãÊñπÊ≥ï</span><br>            <span class="hljs-comment">// Âú®Á∫øÁ®ãÊàêÂëòÊäõÂá∫unchecked exception</span><br>            <span class="hljs-comment">// ‰ºöÊâßË°åÊ≠§ÊñπÊ≥ï</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">uncaughtException</span><span class="hljs-params">(Thread t, Throwable e)</span> &#123;<br>                System.out.println(t.getName() + <span class="hljs-string">&quot;: &quot;</span> + e.getMessage());<br>            &#125;<br>        &#125;;<br><br>        <span class="hljs-comment">// Ëøô‰∏™Á∫øÁ®ãÊòØthreadGroup1ÁöÑ‰∏ÄÂëò</span><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(threadGroup1, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-comment">// ÊäõÂá∫uncheckedÂºÇÂ∏∏</span><br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;ÊµãËØïÂºÇÂ∏∏&quot;</span>);<br>            &#125;<br>        &#125;);<br>    <br>        thread1.start();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="3-3-2-Á∫øÁ®ãÁªÑÁöÑÊï∞ÊçÆÁªìÊûÑ"><a href="#3-3-2-Á∫øÁ®ãÁªÑÁöÑÊï∞ÊçÆÁªìÊûÑ" class="headerlink" title="3.3.2 Á∫øÁ®ãÁªÑÁöÑÊï∞ÊçÆÁªìÊûÑ"></a>3.3.2 Á∫øÁ®ãÁªÑÁöÑÊï∞ÊçÆÁªìÊûÑ</h3><p>Á∫øÁ®ãÁªÑËøòÂèØ‰ª•ÂåÖÂê´ÂÖ∂‰ªñÁöÑÁ∫øÁ®ãÁªÑÔºå‰∏ç‰ªÖ‰ªÖÊòØÁ∫øÁ®ã„ÄÇ</p>
<p>È¶ñÂÖàÁúãÁúã <code>ThreadGroup</code>Ê∫êÁ†Å‰∏≠ÁöÑÊàêÂëòÂèòÈáè</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadGroup</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Thread</span>.UncaughtExceptionHandler &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ThreadGroup parent; <span class="hljs-comment">// Áà∂‰∫≤ThreadGroup</span><br>    String name; <span class="hljs-comment">// ThreadGroupr ÁöÑÂêçÁß∞</span><br>    <span class="hljs-type">int</span> maxPriority; <span class="hljs-comment">// Á∫øÁ®ãÊúÄÂ§ß‰ºòÂÖàÁ∫ß</span><br>    <span class="hljs-type">boolean</span> destroyed; <span class="hljs-comment">// ÊòØÂê¶Ë¢´ÈîÄÊØÅ</span><br>    <span class="hljs-type">boolean</span> daemon; <span class="hljs-comment">// ÊòØÂê¶ÂÆàÊä§Á∫øÁ®ã</span><br>    <span class="hljs-type">boolean</span> vmAllowSuspension; <span class="hljs-comment">// ÊòØÂê¶ÂèØ‰ª•‰∏≠Êñ≠</span><br><br>    <span class="hljs-type">int</span> <span class="hljs-variable">nUnstartedThreads</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// ËøòÊú™ÂêØÂä®ÁöÑÁ∫øÁ®ã</span><br>    <span class="hljs-type">int</span> nthreads; <span class="hljs-comment">// ThreadGroup‰∏≠Á∫øÁ®ãÊï∞ÁõÆ</span><br>    Thread threads[]; <span class="hljs-comment">// ThreadGroup‰∏≠ÁöÑÁ∫øÁ®ã</span><br>    <br>    <span class="hljs-type">int</span> ngroups; <span class="hljs-comment">// Á∫øÁ®ãÁªÑÊï∞ÁõÆ</span><br>    ThreadGroup groups[]; <span class="hljs-comment">// Á∫øÁ®ãÁªÑÊï∞ÁªÑ</span><br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>ÁÑ∂ÂêéÁúãÁúãÊûÑÈÄ†ÂáΩÊï∞Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ÁßÅÊúâÊûÑÈÄ†ÂáΩÊï∞</span><br><span class="hljs-keyword">private</span> <span class="hljs-title function_">ThreadGroup</span><span class="hljs-params">()</span> &#123; <br>    <span class="hljs-built_in">this</span>.name = <span class="hljs-string">&quot;system&quot;</span>;<br>    <span class="hljs-built_in">this</span>.maxPriority = Thread.MAX_PRIORITY;<br>    <span class="hljs-built_in">this</span>.parent = <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-comment">// ÈªòËÆ§ÊòØ‰ª•ÂΩìÂâçThreadGroup‰º†ÂÖ•‰Ωú‰∏∫parent  ThreadGroupÔºåÊñ∞Á∫øÁ®ãÁªÑÁöÑÁà∂Á∫øÁ®ãÁªÑÊòØÁõÆÂâçÊ≠£Âú®ËøêË°åÁ∫øÁ®ãÁöÑÁ∫øÁ®ãÁªÑ„ÄÇ</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">ThreadGroup</span><span class="hljs-params">(String name)</span> &#123;<br>    <span class="hljs-built_in">this</span>(Thread.currentThread().getThreadGroup(), name);<br>&#125;<br><br><span class="hljs-comment">// ÊûÑÈÄ†ÂáΩÊï∞</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">ThreadGroup</span><span class="hljs-params">(ThreadGroup parent, String name)</span> &#123;<br>    <span class="hljs-built_in">this</span>(checkParentAccess(parent), parent, name);<br>&#125;<br><br><span class="hljs-comment">// ÁßÅÊúâÊûÑÈÄ†ÂáΩÊï∞Ôºå‰∏ªË¶ÅÁöÑÊûÑÈÄ†ÂáΩÊï∞</span><br><span class="hljs-keyword">private</span> <span class="hljs-title function_">ThreadGroup</span><span class="hljs-params">(Void unused, ThreadGroup parent, String name)</span> &#123;<br>    <span class="hljs-built_in">this</span>.name = name;<br>    <span class="hljs-built_in">this</span>.maxPriority = parent.maxPriority;<br>    <span class="hljs-built_in">this</span>.daemon = parent.daemon;<br>    <span class="hljs-built_in">this</span>.vmAllowSuspension = parent.vmAllowSuspension;<br>    <span class="hljs-built_in">this</span>.parent = parent;<br>    parent.add(<span class="hljs-built_in">this</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Á¨¨‰∏â‰∏™ÊûÑÈÄ†ÂáΩÊï∞ÈáåË∞ÉÁî®‰∫Ü<code>checkParentAccess</code>ÊñπÊ≥ïÔºåËøôÈáåÁúãÁúãËøô‰∏™ÊñπÊ≥ïÁöÑÊ∫êÁ†ÅÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Ê£ÄÊü•parent ThreadGroup</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Void <span class="hljs-title function_">checkParentAccess</span><span class="hljs-params">(ThreadGroup parent)</span> &#123;<br>    parent.checkAccess();<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-comment">// Âà§Êñ≠ÂΩìÂâçËøêË°åÁöÑÁ∫øÁ®ãÊòØÂê¶ÂÖ∑Êúâ‰øÆÊîπÁ∫øÁ®ãÁªÑÁöÑÊùÉÈôê</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkAccess</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">SecurityManager</span> <span class="hljs-variable">security</span> <span class="hljs-operator">=</span> System.getSecurityManager();<br>    <span class="hljs-keyword">if</span> (security != <span class="hljs-literal">null</span>) &#123;<br>        security.checkAccess(<span class="hljs-built_in">this</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<blockquote>
<p>ËøôÈáåÊ∂âÂèäÂà∞<code>SecurityManager</code>Ëøô‰∏™Á±ªÔºåÂÆÉÊòØJavaÁöÑÂÆâÂÖ®ÁÆ°ÁêÜÂô®ÔºåÂÆÉÂÖÅËÆ∏Â∫îÁî®Á®ãÂ∫èÂú®ÊâßË°å‰∏Ä‰∏™ÂèØËÉΩ‰∏çÂÆâÂÖ®ÊàñÊïèÊÑüÁöÑÊìç‰ΩúÂâçÁ°ÆÂÆöËØ•Êìç‰ΩúÊòØ‰ªÄ‰πàÔºå‰ª•ÂèäÊòØÂê¶ÊòØÂú®ÂÖÅËÆ∏ÊâßË°åËØ•Êìç‰ΩúÁöÑÂÆâÂÖ®‰∏ä‰∏ãÊñá‰∏≠ÊâßË°åÂÆÉ„ÄÇÂ∫îÁî®Á®ãÂ∫èÂèØ‰ª•ÂÖÅËÆ∏Êàñ‰∏çÂÖÅËÆ∏ËØ•Êìç‰Ωú„ÄÇ</p>
<p>ÊØîÂ¶ÇÂºïÂÖ•‰∫ÜÁ¨¨‰∏âÊñπÁ±ªÂ∫ìÔºå‰ΩÜÊòØÂπ∂‰∏çËÉΩ‰øùËØÅÂÆÉÁöÑÂÆâÂÖ®ÊÄß„ÄÇ</p>
<p>ÂÖ∂ÂÆûThreadÁ±ª‰πüÊúâ‰∏Ä‰∏™checkAccess()ÊñπÊ≥ïÔºå‰∏çËøáÊòØÁî®Êù•ÂΩìÂâçËøêË°åÁöÑÁ∫øÁ®ãÊòØÂê¶ÊúâÊùÉÈôê‰øÆÊîπË¢´Ë∞ÉÁî®ÁöÑËøô‰∏™Á∫øÁ®ãÂÆû‰æã„ÄÇÔºàDetermines if the currently running thread has permission to modify this thread.Ôºâ</p>
</blockquote>
<p>ÊÄªÁªìÊù•ËØ¥ÔºåÁ∫øÁ®ãÁªÑÊòØ‰∏Ä‰∏™Ê†ëÁä∂ÁöÑÁªìÊûÑÔºåÊØè‰∏™Á∫øÁ®ãÁªÑ‰∏ãÈù¢ÂèØ‰ª•ÊúâÂ§ö‰∏™Á∫øÁ®ãÊàñËÄÖÁ∫øÁ®ãÁªÑ„ÄÇÁ∫øÁ®ãÁªÑÂèØ‰ª•Ëµ∑Âà∞Áªü‰∏ÄÊéßÂà∂Á∫øÁ®ãÁöÑ‰ºòÂÖàÁ∫ßÂíåÊ£ÄÊü•Á∫øÁ®ãÁöÑÊùÉÈôêÁöÑ‰ΩúÁî®„ÄÇ</p>
<p><strong>ÂèÇËÄÉËµÑÊñô</strong></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/Evankaka/article/details/51627380">https://blog.csdn.net/Evankaka/article/details/51627380</a></p>
<p>- </p>
<p>  „ÄäJavaÂπ∂ÂèëÁºñÁ®ãÂÆûË∑µ„Äã</p>
<p>- </p>
<p>  „ÄäJavaÂ§öÁ∫øÁ®ãÁºñÁ®ãÊ†∏ÂøÉÊäÄÊúØ„Äã</p>
<p>4 JavaÁ∫øÁ®ãÁöÑÁä∂ÊÄÅÂèä‰∏ªË¶ÅËΩ¨ÂåñÊñπÊ≥ï</p>
<h1 id="4-JavaÁ∫øÁ®ãÁöÑÁä∂ÊÄÅÂèä‰∏ªË¶ÅËΩ¨ÂåñÊñπÊ≥ï"><a href="#4-JavaÁ∫øÁ®ãÁöÑÁä∂ÊÄÅÂèä‰∏ªË¶ÅËΩ¨ÂåñÊñπÊ≥ï" class="headerlink" title="4 JavaÁ∫øÁ®ãÁöÑÁä∂ÊÄÅÂèä‰∏ªË¶ÅËΩ¨ÂåñÊñπÊ≥ï"></a>4 JavaÁ∫øÁ®ãÁöÑÁä∂ÊÄÅÂèä‰∏ªË¶ÅËΩ¨ÂåñÊñπÊ≥ï</h1><h2 id="4-1-Êìç‰ΩúÁ≥ªÁªü‰∏≠ÁöÑÁ∫øÁ®ãÁä∂ÊÄÅËΩ¨Êç¢"><a href="#4-1-Êìç‰ΩúÁ≥ªÁªü‰∏≠ÁöÑÁ∫øÁ®ãÁä∂ÊÄÅËΩ¨Êç¢" class="headerlink" title="4.1 Êìç‰ΩúÁ≥ªÁªü‰∏≠ÁöÑÁ∫øÁ®ãÁä∂ÊÄÅËΩ¨Êç¢"></a>4.1 Êìç‰ΩúÁ≥ªÁªü‰∏≠ÁöÑÁ∫øÁ®ãÁä∂ÊÄÅËΩ¨Êç¢</h2><p>È¶ñÂÖàÊàë‰ª¨Êù•ÁúãÁúãÊìç‰ΩúÁ≥ªÁªü‰∏≠ÁöÑÁ∫øÁ®ãÁä∂ÊÄÅËΩ¨Êç¢„ÄÇ</p>
<blockquote>
<p>Âú®Áé∞Âú®ÁöÑÊìç‰ΩúÁ≥ªÁªü‰∏≠ÔºåÁ∫øÁ®ãÊòØË¢´ËßÜ‰∏∫ËΩªÈáèÁ∫ßËøõÁ®ãÁöÑÔºåÊâÄ‰ª•<strong>Êìç‰ΩúÁ≥ªÁªüÁ∫øÁ®ãÁöÑÁä∂ÊÄÅÂÖ∂ÂÆûÂíåÊìç‰ΩúÁ≥ªÁªüËøõÁ®ãÁöÑÁä∂ÊÄÅÊòØ‰∏ÄËá¥ÁöÑ</strong>„ÄÇ</p>
</blockquote>
<p><img src="https://3803541485-files.gitbook.io/~/files/v0/b/gitbook-28427.appspot.com/o/assets%2F-L_5HvtIhTFW9TQlOF8e%2F-L_5TIKcBFHWPtY3OwUo%2F-L_5TJM1VhwmwbNGzqwJ%2F%E7%B3%BB%E7%BB%9F%E8%BF%9B%E7%A8%8B%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2%E5%9B%BE.png?generation=1551665548910935&alt=media" srcset="/Hexo/img/loading.gif" lazyload alt="img"></p>
<p>Á≥ªÁªüËøõÁ®ã&#x2F;Á∫øÁ®ãËΩ¨Êç¢Âõæ</p>
<p>Êìç‰ΩúÁ≥ªÁªüÁ∫øÁ®ã‰∏ªË¶ÅÊúâ‰ª•‰∏ã‰∏â‰∏™Áä∂ÊÄÅÔºö</p>
<p>- </p>
<p>  Â∞±Áª™Áä∂ÊÄÅ(ready)ÔºöÁ∫øÁ®ãÊ≠£Âú®Á≠âÂæÖ‰ΩøÁî®CPUÔºåÁªèË∞ÉÂ∫¶Á®ãÂ∫èË∞ÉÁî®‰πãÂêéÂèØËøõÂÖ•runningÁä∂ÊÄÅ„ÄÇ</p>
<p>- </p>
<p>  ÊâßË°åÁä∂ÊÄÅ(running)ÔºöÁ∫øÁ®ãÊ≠£Âú®‰ΩøÁî®CPU„ÄÇ</p>
<p>- </p>
<p>  Á≠âÂæÖÁä∂ÊÄÅ(waiting): Á∫øÁ®ãÁªèËøáÁ≠âÂæÖ‰∫ã‰ª∂ÁöÑË∞ÉÁî®ÊàñËÄÖÊ≠£Âú®Á≠âÂæÖÂÖ∂‰ªñËµÑÊ∫êÔºàÂ¶ÇI&#x2F;OÔºâ„ÄÇ</p>
<p>- </p>
<h2 id="4-2-JavaÁ∫øÁ®ãÁöÑ6‰∏™Áä∂ÊÄÅ"><a href="#4-2-JavaÁ∫øÁ®ãÁöÑ6‰∏™Áä∂ÊÄÅ" class="headerlink" title="4.2 JavaÁ∫øÁ®ãÁöÑ6‰∏™Áä∂ÊÄÅ"></a>4.2 JavaÁ∫øÁ®ãÁöÑ6‰∏™Áä∂ÊÄÅ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Thread.State Ê∫êÁ†Å</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">State</span> &#123;<br>    NEW,<br>    RUNNABLE,<br>    BLOCKED,<br>    WAITING,<br>    TIMED_WAITING,<br>    TERMINATED;<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="4-2-1-NEW"><a href="#4-2-1-NEW" class="headerlink" title="4.2.1 NEW"></a>4.2.1 NEW</h3><p>Â§Ñ‰∫éNEWÁä∂ÊÄÅÁöÑÁ∫øÁ®ãÊ≠§Êó∂Â∞öÊú™ÂêØÂä®„ÄÇËøôÈáåÁöÑÂ∞öÊú™ÂêØÂä®ÊåáÁöÑÊòØËøòÊ≤°Ë∞ÉÁî®ThreadÂÆû‰æãÁöÑstart()ÊñπÊ≥ï„ÄÇ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testStateNew</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; &#123;&#125;);<br>    System.out.println(thread.getState()); <span class="hljs-comment">// ËæìÂá∫ NEW </span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>‰ªé‰∏äÈù¢ÂèØ‰ª•ÁúãÂá∫ÔºåÂè™ÊòØÂàõÂª∫‰∫ÜÁ∫øÁ®ãËÄåÂπ∂Ê≤°ÊúâË∞ÉÁî®start()ÊñπÊ≥ïÔºåÊ≠§Êó∂Á∫øÁ®ãÂ§Ñ‰∫éNEWÁä∂ÊÄÅ„ÄÇ</p>
<p><strong>ÂÖ≥‰∫éstart()ÁöÑ‰∏§‰∏™ÂºïÁî≥ÈóÆÈ¢ò</strong></p>
<ol>
<li><ol>
<li></li>
</ol>
<p>ÂèçÂ§çË∞ÉÁî®Âêå‰∏Ä‰∏™Á∫øÁ®ãÁöÑstart()ÊñπÊ≥ïÊòØÂê¶ÂèØË°åÔºü</p>
</li>
<li><ol start="2">
<li></li>
</ol>
<p>ÂÅáÂ¶Ç‰∏Ä‰∏™Á∫øÁ®ãÊâßË°åÂÆåÊØïÔºàÊ≠§Êó∂Â§Ñ‰∫éTERMINATEDÁä∂ÊÄÅÔºâÔºåÂÜçÊ¨°Ë∞ÉÁî®Ëøô‰∏™Á∫øÁ®ãÁöÑstart()ÊñπÊ≥ïÊòØÂê¶ÂèØË°åÔºü</p>
</li>
</ol>
<p>Ë¶ÅÂàÜÊûêËøô‰∏§‰∏™ÈóÆÈ¢òÔºåÊàë‰ª¨ÂÖàÊù•ÁúãÁúãstart()ÁöÑÊ∫êÁ†ÅÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (threadStatus != <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalThreadStateException</span>();<br><br>    group.add(<span class="hljs-built_in">this</span>);<br>    <br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">started</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        start0();<br>        started = <span class="hljs-literal">true</span>;<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">if</span> (!started) &#123;<br>                group.threadStartFailed(<span class="hljs-built_in">this</span>);<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable ignore) &#123;<br>    <br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÂú®start()ÂÜÖÈÉ®ÔºåËøôÈáåÊúâ‰∏Ä‰∏™threadStatusÁöÑÂèòÈáè„ÄÇÂ¶ÇÊûúÂÆÉ‰∏çÁ≠â‰∫é0ÔºåË∞ÉÁî®start()ÊòØ‰ºöÁõ¥Êé•ÊäõÂá∫ÂºÇÂ∏∏ÁöÑ„ÄÇ</p>
<p>Êàë‰ª¨Êé•ÁùÄÂæÄ‰∏ãÁúãÔºåÊúâ‰∏Ä‰∏™nativeÁöÑ<code>start0()</code>ÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ïÈáåÂπ∂Ê≤°ÊúâÂØπ<strong>threadStatus</strong>ÁöÑÂ§ÑÁêÜ„ÄÇÂà∞‰∫ÜËøôÈáåÊàë‰ª¨‰ªø‰ΩõÂ∞±ÊãøËøô‰∏™threadStatusÊ≤°Ëæô‰∫ÜÔºåÊàë‰ª¨ÈÄöËøádebugÁöÑÊñπÂºèÂÜçÁúã‰∏Ä‰∏ã:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testStartMethod</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; &#123;&#125;);<br>    thread.start(); <span class="hljs-comment">// Á¨¨‰∏ÄÊ¨°Ë∞ÉÁî®</span><br>    thread.start(); <span class="hljs-comment">// Á¨¨‰∫åÊ¨°Ë∞ÉÁî®</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>ÊàëÊòØÂú®start()ÊñπÊ≥ïÂÜÖÈÉ®ÁöÑÊúÄÂºÄÂßãÊâìÁöÑÊñ≠ÁÇπÔºåÂèôËø∞‰∏ãÂú®ÊàëËøôÈáåÊâìÊñ≠ÁÇπÁúãÂà∞ÁöÑÁªìÊûúÔºö</p>
<p>- </p>
<p>  Á¨¨‰∏ÄÊ¨°Ë∞ÉÁî®Êó∂threadStatusÁöÑÂÄºÊòØ0„ÄÇ</p>
<p>- </p>
<p>  Á¨¨‰∫åÊ¨°Ë∞ÉÁî®Êó∂threadStatusÁöÑÂÄº‰∏ç‰∏∫0„ÄÇ</p>
<p>Êü•ÁúãÂΩìÂâçÁ∫øÁ®ãÁä∂ÊÄÅÁöÑÊ∫êÁ†ÅÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Thread.getStateÊñπÊ≥ïÊ∫êÁ†ÅÔºö</span><br><span class="hljs-keyword">public</span> State <span class="hljs-title function_">getState</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// get current thread state</span><br>    <span class="hljs-keyword">return</span> sun.misc.VM.toThreadState(threadStatus);<br>&#125;<br><br><span class="hljs-comment">// sun.misc.VM Ê∫êÁ†ÅÔºö</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> State <span class="hljs-title function_">toThreadState</span><span class="hljs-params">(<span class="hljs-type">int</span> var0)</span> &#123;<br>    <span class="hljs-keyword">if</span> ((var0 &amp; <span class="hljs-number">4</span>) != <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> State.RUNNABLE;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((var0 &amp; <span class="hljs-number">1024</span>) != <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> State.BLOCKED;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((var0 &amp; <span class="hljs-number">16</span>) != <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> State.WAITING;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((var0 &amp; <span class="hljs-number">32</span>) != <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> State.TIMED_WAITING;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((var0 &amp; <span class="hljs-number">2</span>) != <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> State.TERMINATED;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> (var0 &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span> ? State.NEW : State.RUNNABLE;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ÊâÄ‰ª•ÔºåÊàë‰ª¨ÁªìÂêà‰∏äÈù¢ÁöÑÊ∫êÁ†ÅÂèØ‰ª•ÂæóÂà∞ÂºïÁî≥ÁöÑ‰∏§‰∏™ÈóÆÈ¢òÁöÑÁªìÊûúÔºö</p>
<blockquote>
<p>‰∏§‰∏™ÈóÆÈ¢òÁöÑÁ≠îÊ°àÈÉΩÊòØ‰∏çÂèØË°åÔºåÂú®Ë∞ÉÁî®‰∏ÄÊ¨°start()‰πãÂêéÔºåthreadStatusÁöÑÂÄº‰ºöÊîπÂèòÔºàthreadStatus !&#x3D;0ÔºâÔºåÊ≠§Êó∂ÂÜçÊ¨°Ë∞ÉÁî®start()ÊñπÊ≥ï‰ºöÊäõÂá∫IllegalThreadStateExceptionÂºÇÂ∏∏„ÄÇ</p>
<p>ÊØîÂ¶ÇÔºåthreadStatus‰∏∫2‰ª£Ë°®ÂΩìÂâçÁ∫øÁ®ãÁä∂ÊÄÅ‰∏∫TERMINATED„ÄÇ</p>
</blockquote>
<h3 id="4-2-2-RUNNABLE"><a href="#4-2-2-RUNNABLE" class="headerlink" title="4.2.2 RUNNABLE"></a>4.2.2 RUNNABLE</h3><p>Ë°®Á§∫ÂΩìÂâçÁ∫øÁ®ãÊ≠£Âú®ËøêË°å‰∏≠„ÄÇÂ§Ñ‰∫éRUNNABLEÁä∂ÊÄÅÁöÑÁ∫øÁ®ãÂú®JavaËôöÊãüÊú∫‰∏≠ËøêË°åÔºå‰πüÊúâÂèØËÉΩÂú®Á≠âÂæÖÂÖ∂‰ªñÁ≥ªÁªüËµÑÊ∫êÔºàÊØîÂ¶ÇI&#x2F;OÔºâ„ÄÇ</p>
<p><strong>Java‰∏≠Á∫øÁ®ãÁöÑRUNNABLEÁä∂ÊÄÅ</strong></p>
<p>Áúã‰∫ÜÊìç‰ΩúÁ≥ªÁªüÁ∫øÁ®ãÁöÑÂá†‰∏™Áä∂ÊÄÅ‰πãÂêéÊàë‰ª¨Êù•ÁúãÁúãThreadÊ∫êÁ†ÅÈáåÂØπRUNNABLEÁä∂ÊÄÅÁöÑÂÆö‰πâÔºö</p>
<ul>
<li><pre><code class="java"> /**
</code></pre>
</li>
<li><p>Thread state for a runnable thread.  A thread in the runnable</p>
</li>
<li><p>state is executing in the Java virtual machine but it may</p>
</li>
<li><p>be waiting for other resources from the operating system</p>
</li>
<li><p>such as processor.<br>*&#x2F;</p>
 <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><code class="hljs csharp"> <br> <br><br>&gt; JavaÁ∫øÁ®ãÁöÑ**RUNNABLE**Áä∂ÊÄÅÂÖ∂ÂÆûÊòØÂåÖÊã¨‰∫Ü‰º†ÁªüÊìç‰ΩúÁ≥ªÁªüÁ∫øÁ®ãÁöÑ**ready**Âíå**running**‰∏§‰∏™Áä∂ÊÄÅÁöÑ„ÄÇ<br><br><span class="hljs-meta">## 4.2.3 BLOCKED</span><br><br>ÈòªÂ°ûÁä∂ÊÄÅ„ÄÇÂ§Ñ‰∫éBLOCKEDÁä∂ÊÄÅÁöÑÁ∫øÁ®ãÊ≠£Á≠âÂæÖÈîÅÁöÑÈáäÊîæ‰ª•ËøõÂÖ•ÂêåÊ≠•Âå∫„ÄÇ<br><br>Êàë‰ª¨Áî®BLOCKEDÁä∂ÊÄÅ‰∏æ‰∏™ÁîüÊ¥ª‰∏≠ÁöÑ‰æãÂ≠êÔºö<br><br>&gt; ÂÅáÂ¶Ç‰ªäÂ§©‰Ω†‰∏ãÁè≠ÂêéÂáÜÂ§áÂéªÈ£üÂ†ÇÂêÉÈ•≠„ÄÇ‰Ω†Êù•Âà∞È£üÂ†Ç‰ªÖÊúâÁöÑ‰∏Ä‰∏™Á™óÂè£ÔºåÂèëÁé∞ÂâçÈù¢Â∑≤ÁªèÊúâ‰∏™‰∫∫Âú®Á™óÂè£Ââç‰∫ÜÔºåÊ≠§Êó∂‰Ω†ÂøÖÈ°ªÂæóÁ≠âÂâçÈù¢ÁöÑ‰∫∫‰ªéÁ™óÂè£Á¶ªÂºÄÊâçË°å„ÄÇ ÂÅáËÆæ‰Ω†ÊòØÁ∫øÁ®ãt2Ôºå‰Ω†ÂâçÈù¢ÁöÑÈÇ£‰∏™‰∫∫ÊòØÁ∫øÁ®ãt1„ÄÇÊ≠§Êó∂t1Âç†Êúâ‰∫ÜÈîÅÔºàÈ£üÂ†ÇÂîØ‰∏ÄÁöÑÁ™óÂè£ÔºâÔºåt2Ê≠£Âú®Á≠âÂæÖÈîÅÁöÑÈáäÊîæÔºåÊâÄ‰ª•Ê≠§Êó∂t2Â∞±Â§Ñ‰∫éBLOCKEDÁä∂ÊÄÅ„ÄÇ<br><br><span class="hljs-meta">## 4.2.4 WAITING</span><br><br>Á≠âÂæÖÁä∂ÊÄÅ„ÄÇÂ§Ñ‰∫éÁ≠âÂæÖÁä∂ÊÄÅÁöÑÁ∫øÁ®ãÂèòÊàêRUNNABLEÁä∂ÊÄÅÈúÄË¶ÅÂÖ∂‰ªñÁ∫øÁ®ãÂî§ÈÜí„ÄÇ<br><br>Ë∞ÉÁî®Â¶Ç‰∏ã<span class="hljs-number">3</span>‰∏™ÊñπÊ≥ï‰ºö‰ΩøÁ∫øÁ®ãËøõÂÖ•Á≠âÂæÖÁä∂ÊÄÅÔºö<br><br>- <br><br>  Object.wait()Ôºö‰ΩøÂΩìÂâçÁ∫øÁ®ãÂ§Ñ‰∫éÁ≠âÂæÖÁä∂ÊÄÅÁõ¥Âà∞Âè¶‰∏Ä‰∏™Á∫øÁ®ãÂî§ÈÜíÂÆÉÔºõ<br><br>- <br><br>  Thread.<span class="hljs-keyword">join</span>()ÔºöÁ≠âÂæÖÁ∫øÁ®ãÊâßË°åÂÆåÊØïÔºåÂ∫ïÂ±ÇË∞ÉÁî®ÁöÑÊòØObjectÂÆû‰æãÁöÑwaitÊñπÊ≥ïÔºõ<br><br>- <br><br>  LockSupport.park()ÔºöÈô§ÈùûËé∑ÂæóË∞ÉÁî®ËÆ∏ÂèØÔºåÂê¶ÂàôÁ¶ÅÁî®ÂΩìÂâçÁ∫øÁ®ãËøõË°åÁ∫øÁ®ãË∞ÉÂ∫¶„ÄÇ  <br><br>Êàë‰ª¨Âª∂Áª≠‰∏äÈù¢ÁöÑ‰æãÂ≠êÁªßÁª≠Ëß£Èáä‰∏Ä‰∏ãWAITINGÁä∂ÊÄÅÔºö<br><br>&gt; ‰Ω†Á≠â‰∫ÜÂ•ΩÂá†ÂàÜÈíüÁé∞Âú®Áªà‰∫éËΩÆÂà∞‰Ω†‰∫ÜÔºåÁ™ÅÁÑ∂‰Ω†‰ª¨Êúâ‰∏Ä‰∏™‚Äú‰∏çÊáÇ‰∫ã‚ÄùÁöÑÁªèÁêÜÁ™ÅÁÑ∂Êù•‰∫Ü„ÄÇ‰Ω†ÁúãÂà∞‰ªñ‰Ω†Â∞±Êúâ‰∏ÄÁßç‰∏çÁ••ÁöÑÈ¢ÑÊÑüÔºåÊûúÁÑ∂Ôºå‰ªñÊòØÊù•Êâæ‰Ω†ÁöÑ„ÄÇ<br>&gt;<br>&gt; ‰ªñÊää‰Ω†ÊãâÂà∞‰∏ÄÊóÅÂè´‰Ω†ÂæÖ‰ºöÂÑøÂÜçÂêÉÈ•≠ÔºåËØ¥‰ªñ‰∏ãÂçàË¶ÅÂéª‰ΩúÊä•ÂëäÔºåËµ∂Á¥ßÊù•Êâæ‰Ω†‰∫ÜËß£‰∏Ä‰∏ãÈ°πÁõÆÁöÑÊÉÖÂÜµ„ÄÇ‰Ω†ÂøÉÈáåËôΩÁÑ∂Êúâ‰∏Ä‰∏á‰∏™‰∏çÊÑøÊÑè‰ΩÜÊòØ‰Ω†ËøòÊòØ‰ªéÈ£üÂ†ÇÁ™óÂè£Ëµ∞ÂºÄ‰∫Ü„ÄÇ<br>&gt;<br>&gt; Ê≠§Êó∂ÔºåÂÅáËÆæ‰Ω†ËøòÊòØÁ∫øÁ®ãt2Ôºå‰Ω†ÁöÑÁªèÁêÜÊòØÁ∫øÁ®ãt1„ÄÇËôΩÁÑ∂‰Ω†Ê≠§Êó∂ÈÉΩÂç†ÊúâÈîÅÔºàÁ™óÂè£Ôºâ‰∫ÜÔºå‚Äú‰∏çÈÄü‰πãÂÆ¢‚ÄùÊù•‰∫Ü‰Ω†ËøòÊòØÂæóÈáäÊîæÊéâÈîÅ„ÄÇÊ≠§Êó∂‰Ω†t2ÁöÑÁä∂ÊÄÅÂ∞±ÊòØWAITING„ÄÇÁÑ∂ÂêéÁªèÁêÜt1Ëé∑ÂæóÈîÅÔºåËøõÂÖ•RUNNABLEÁä∂ÊÄÅ„ÄÇ<br>&gt;<br>&gt; Ë¶ÅÊòØÁªèÁêÜt1‰∏ç‰∏ªÂä®Âî§ÈÜí‰Ω†t2Ôºànotify„ÄÅnotifyAll..ÔºâÔºåÂèØ‰ª•ËØ¥‰Ω†t2Âè™ËÉΩ‰∏ÄÁõ¥Á≠âÂæÖ‰∫Ü„ÄÇ<br><br><span class="hljs-meta">## 4.2.5 TIMED_WAITING</span><br><br>Ë∂ÖÊó∂Á≠âÂæÖÁä∂ÊÄÅ„ÄÇÁ∫øÁ®ãÁ≠âÂæÖ‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑÊó∂Èó¥ÔºåÊó∂Èó¥Âà∞Âêé‰ºöË¢´Ëá™Âä®Âî§ÈÜí„ÄÇ<br><br>Ë∞ÉÁî®Â¶Ç‰∏ãÊñπÊ≥ï‰ºö‰ΩøÁ∫øÁ®ãËøõÂÖ•Ë∂ÖÊó∂Á≠âÂæÖÁä∂ÊÄÅÔºö<br><br>- <br><br>  Thread.sleep(<span class="hljs-built_in">long</span> millis)Ôºö‰ΩøÂΩìÂâçÁ∫øÁ®ãÁù°Áú†ÊåáÂÆöÊó∂Èó¥Ôºõ<br><br>- <br><br>  Object.wait(<span class="hljs-built_in">long</span> timeout)ÔºöÁ∫øÁ®ã‰ºëÁú†ÊåáÂÆöÊó∂Èó¥ÔºåÁ≠âÂæÖÊúüÈó¥ÂèØ‰ª•ÈÄöËøánotify()/notifyAll()Âî§ÈÜíÔºõ<br><br>- <br><br>  Thread.<span class="hljs-keyword">join</span>(<span class="hljs-built_in">long</span> millis)ÔºöÁ≠âÂæÖÂΩìÂâçÁ∫øÁ®ãÊúÄÂ§öÊâßË°åmillisÊØ´ÁßíÔºåÂ¶ÇÊûúmillis‰∏∫<span class="hljs-number">0</span>ÔºåÂàô‰ºö‰∏ÄÁõ¥ÊâßË°åÔºõ<br><br>- <br><br>  LockSupport.parkNanos(<span class="hljs-built_in">long</span> nanos)Ôºö Èô§ÈùûËé∑ÂæóË∞ÉÁî®ËÆ∏ÂèØÔºåÂê¶ÂàôÁ¶ÅÁî®ÂΩìÂâçÁ∫øÁ®ãËøõË°åÁ∫øÁ®ãË∞ÉÂ∫¶ÊåáÂÆöÊó∂Èó¥Ôºõ<br><br>- <br><br>  LockSupport.parkUntil(<span class="hljs-built_in">long</span> deadline)ÔºöÂêå‰∏äÔºå‰πüÊòØÁ¶ÅÊ≠¢Á∫øÁ®ãËøõË°åË∞ÉÂ∫¶ÊåáÂÆöÊó∂Èó¥Ôºõ<br><br>Êàë‰ª¨ÁªßÁª≠Âª∂Áª≠‰∏äÈù¢ÁöÑ‰æãÂ≠êÊù•Ëß£Èáä‰∏Ä‰∏ãTIMED_WAITINGÁä∂ÊÄÅÔºö<br><br>&gt; Âà∞‰∫ÜÁ¨¨‰∫åÂ§©‰∏≠ÂçàÔºåÂèàÂà∞‰∫ÜÈ•≠ÁÇπÔºå‰Ω†ËøòÊòØÂà∞‰∫ÜÁ™óÂè£Ââç„ÄÇ<br>&gt;<br>&gt; Á™ÅÁÑ∂Èó¥ÊÉ≥Ëµ∑‰Ω†ÁöÑÂêå‰∫ãÂè´‰Ω†Á≠â‰ªñ‰∏ÄËµ∑Ôºå‰ªñËØ¥ËÆ©‰Ω†Á≠â‰ªñÂçÅÂàÜÈíü‰ªñÊîπ‰∏™bug„ÄÇ<br>&gt;<br>&gt; Â•ΩÂêßÔºå‰Ω†ËØ¥ÈÇ£‰Ω†Â∞±Á≠âÁ≠âÂêßÔºå‰Ω†Â∞±Á¶ªÂºÄ‰∫ÜÁ™óÂè£„ÄÇÂæàÂø´ÂçÅÂàÜÈíüËøáÂéª‰∫ÜÔºå‰Ω†ËßÅ‰ªñËøòÊ≤°Êù•Ôºå‰Ω†ÊÉ≥ÈÉΩÁ≠â‰∫ÜËøô‰πà‰πÖ‰∫ÜËøò‰∏çÊù•ÔºåÈÇ£‰Ω†ËøòÊòØÂÖàÂéªÂêÉÈ•≠Â•Ω‰∫Ü„ÄÇ<br>&gt;<br>&gt; ËøôÊó∂‰Ω†ËøòÊòØÁ∫øÁ®ãt1Ôºå‰Ω†ÊîπbugÁöÑÂêå‰∫ãÊòØÁ∫øÁ®ãt2„ÄÇt2ËÆ©t1Á≠âÂæÖ‰∫ÜÊåáÂÆöÊó∂Èó¥Ôºåt1ÂÖà‰∏ªÂä®ÈáäÊîæ‰∫ÜÈîÅ„ÄÇÊ≠§Êó∂t1Á≠âÂæÖÊúüÈó¥Â∞±Â±û‰∫éTIMED_WATINGÁä∂ÊÄÅ„ÄÇ<br>&gt;<br>&gt; t1Á≠âÂæÖ<span class="hljs-number">10</span>ÂàÜÈíüÂêéÔºåÂ∞±Ëá™Âä®Âî§ÈÜíÔºåÊã•Êúâ‰∫ÜÂéª‰∫âÂ§∫ÈîÅÁöÑËµÑÊ†º„ÄÇ<br><br><span class="hljs-meta">## 4.2.6 TERMINATED</span><br><br>ÁªàÊ≠¢Áä∂ÊÄÅ„ÄÇÊ≠§Êó∂Á∫øÁ®ãÂ∑≤ÊâßË°åÂÆåÊØï„ÄÇ<br><br><span class="hljs-meta"># 4.3 Á∫øÁ®ãÁä∂ÊÄÅÁöÑËΩ¨Êç¢</span><br><br>Ê†πÊçÆ‰∏äÈù¢ÂÖ≥‰∫éÁ∫øÁ®ãÁä∂ÊÄÅÁöÑ‰ªãÁªçÊàë‰ª¨ÂèØ‰ª•ÂæóÂà∞‰∏ãÈù¢ÁöÑ**Á∫øÁ®ãÁä∂ÊÄÅËΩ¨Êç¢Âõæ**Ôºö ![img](https:<span class="hljs-comment">//3803541485-files.gitbook.io/~/files/v0/b/gitbook-28427.appspot.com/o/assets%2F-L_5HvtIhTFW9TQlOF8e%2F-L_5TIKcBFHWPtY3OwUo%2F-L_5TJM7CvFzBq6T_50d%2F%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2%E5%9B%BE.png?generation=1551665550335701&amp;alt=media)</span><br><br><span class="hljs-meta">## 4.3.1 BLOCKED‰∏éRUNNABLEÁä∂ÊÄÅÁöÑËΩ¨Êç¢</span><br><br>Êàë‰ª¨Âú®‰∏äÈù¢ËØ¥Âà∞ÔºöÂ§Ñ‰∫éBLOCKEDÁä∂ÊÄÅÁöÑÁ∫øÁ®ãÊòØÂõ†‰∏∫Âú®Á≠âÂæÖÈîÅÁöÑÈáäÊîæ„ÄÇÂÅáÂ¶ÇËøôÈáåÊúâ‰∏§‰∏™Á∫øÁ®ãaÂíåbÔºåaÁ∫øÁ®ãÊèêÂâçËé∑Âæó‰∫ÜÈîÅÂπ∂‰∏îÊöÇÊú™ÈáäÊîæÈîÅÔºåÊ≠§Êó∂bÂ∞±Â§Ñ‰∫éBLOCKEDÁä∂ÊÄÅ„ÄÇÊàë‰ª¨ÂÖàÊù•Áúã‰∏Ä‰∏™‰æãÂ≠êÔºö<br><br>```java<br>@Test<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">blockedTest</span>()</span> &#123;<br><br>    Thread a = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> Runnable() &#123;<br>        @Override<br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span>()</span> &#123;<br>            testMethod();<br>        &#125;<br>    &#125;, <span class="hljs-string">&quot;a&quot;</span>);<br>    Thread b = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> Runnable() &#123;<br>        @Override<br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span>()</span> &#123;<br>            testMethod();<br>        &#125;<br>    &#125;, <span class="hljs-string">&quot;b&quot;</span>);<br>    <br>    a.start();<br>    b.start();<br>    System.<span class="hljs-keyword">out</span>.println(a.getName() + <span class="hljs-string">&quot;:&quot;</span> + a.getState()); <span class="hljs-comment">// ËæìÂá∫Ôºü</span><br>    System.<span class="hljs-keyword">out</span>.println(b.getName() + <span class="hljs-string">&quot;:&quot;</span> + b.getState()); <span class="hljs-comment">// ËæìÂá∫Ôºü</span><br><br>&#125;<br><br><span class="hljs-comment">// ÂêåÊ≠•ÊñπÊ≥ï‰∫âÂ§∫ÈîÅ</span><br><span class="hljs-function"><span class="hljs-keyword">private</span> synchronized <span class="hljs-keyword">void</span> <span class="hljs-title">testMethod</span>()</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        Thread.sleep(<span class="hljs-number">2000L</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>        e.printStackTrace();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<p>ÂàùÁúã‰πã‰∏ãÔºåÂ§ßÂÆ∂ÂèØËÉΩ‰ºöËßâÂæóÁ∫øÁ®ãa‰ºöÂÖàË∞ÉÁî®ÂêåÊ≠•ÊñπÊ≥ïÔºåÂêåÊ≠•ÊñπÊ≥ïÂÜÖÂèàË∞ÉÁî®‰∫ÜThread.sleep()ÊñπÊ≥ïÔºåÂøÖÁÑ∂‰ºöËæìÂá∫TIMED_WAITINGÔºåËÄåÁ∫øÁ®ãbÂõ†‰∏∫Á≠âÂæÖÁ∫øÁ®ãaÈáäÊîæÈîÅÊâÄ‰ª•ÂøÖÁÑ∂‰ºöËæìÂá∫BLOCKED„ÄÇ</p>
<p>ÂÖ∂ÂÆû‰∏çÁÑ∂ÔºåÊúâ‰∏§ÁÇπÈúÄË¶ÅÂÄºÂæóÂ§ßÂÆ∂Ê≥®ÊÑèÔºå‰∏ÄÊòØ<strong>Âú®ÊµãËØïÊñπÊ≥ïblockedTest()ÂÜÖËøòÊúâ‰∏Ä‰∏™mainÁ∫øÁ®ã</strong>Ôºå‰∫åÊòØ<strong>ÂêØÂä®Á∫øÁ®ãÂêéÊâßË°årunÊñπÊ≥ïËøòÊòØÈúÄË¶ÅÊ∂àËÄó‰∏ÄÂÆöÊó∂Èó¥ÁöÑ</strong>„ÄÇ‰∏çÊâìÊñ≠ÁÇπÁöÑÊÉÖÂÜµ‰∏ãÔºå‰∏äÈù¢‰ª£Á†Å‰∏≠ÈÉΩÂ∫îËØ•ËæìÂá∫<strong>RUNNABLE</strong>„ÄÇ</p>
<blockquote>
<p>ÊµãËØïÊñπÊ≥ïÁöÑmainÁ∫øÁ®ãÂè™‰øùËØÅ‰∫ÜaÔºåb‰∏§‰∏™Á∫øÁ®ãË∞ÉÁî®start()ÊñπÊ≥ïÔºàËΩ¨Âåñ‰∏∫RUNNABLEÁä∂ÊÄÅÔºâÔºåËøòÊ≤°Á≠â‰∏§‰∏™Á∫øÁ®ãÁúüÊ≠£ÂºÄÂßã‰∫âÂ§∫ÈîÅÔºåÂ∞±Â∑≤ÁªèÊâìÂç∞Ê≠§Êó∂‰∏§‰∏™Á∫øÁ®ãÁöÑÁä∂ÊÄÅÔºàRUNNABLEÔºâ‰∫Ü„ÄÇ</p>
</blockquote>
<p>ËøôÊó∂‰Ω†ÂèØËÉΩÂèà‰ºöÈóÆ‰∫ÜÔºåË¶ÅÊòØÊàëÊÉ≥Ë¶ÅÊâìÂç∞Âá∫BLOCKEDÁä∂ÊÄÅÊàëËØ•ÊÄé‰πàÂ§ÑÁêÜÂë¢ÔºüÂÖ∂ÂÆûÂ∞±Â§ÑÁêÜ‰∏ãÊµãËØïÊñπÊ≥ïÈáåÁöÑmainÁ∫øÁ®ãÂ∞±ÂèØ‰ª•‰∫ÜÔºå‰Ω†ËÆ©ÂÆÉ‚Äú‰ºëÊÅØ‰∏Ä‰ºöÂÑø‚ÄùÔºåÊâìÊñ≠ÁÇπÊàñËÄÖË∞ÉÁî®Thread.sleepÊñπÊ≥ïÂ∞±Ë°å„ÄÇ</p>
<p>ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØmainÁ∫øÁ®ã‰ºëÊÅØÁöÑÊó∂Èó¥ÔºåË¶Å‰øùËØÅÂú®Á∫øÁ®ã‰∫âÂ§∫ÈîÅÁöÑÊó∂Èó¥ÂÜÖÔºå‰∏çË¶ÅÁ≠âÂà∞Ââç‰∏Ä‰∏™Á∫øÁ®ãÈîÅÈÉΩÈáäÊîæ‰∫Ü‰Ω†ÂÜçÂéª‰∫âÂ§∫ÈîÅÔºåÊ≠§Êó∂ËøòÊòØÂæó‰∏çÂà∞BLOCKEDÁä∂ÊÄÅÁöÑ„ÄÇ</p>
<p>Êàë‰ª¨Êää‰∏äÈù¢ÁöÑÊµãËØïÊñπÊ≥ïblockedTest()ÊîπÂä®‰∏Ä‰∏ãÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">`<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">blockedTest</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;`<br>    `¬∑¬∑¬∑¬∑¬∑¬∑`<br>    `a.start();`<br>    `Thread.sleep(<span class="hljs-number">1000L</span>); <span class="hljs-comment">// ÈúÄË¶ÅÊ≥®ÊÑèËøôÈáåmainÁ∫øÁ®ã‰ºëÁú†‰∫Ü1000ÊØ´ÁßíÔºåËÄåtestMethod()Èáå‰ºëÁú†‰∫Ü2000ÊØ´Áßí`</span><br>    `b.start();`<br>    `System.out.println(a.getName() + <span class="hljs-string">&quot;:&quot;</span> + a.getState()); <span class="hljs-comment">// ËæìÂá∫Ôºü`</span><br>    `System.out.println(b.getName() + <span class="hljs-string">&quot;:&quot;</span> + b.getState()); <span class="hljs-comment">// ËæìÂá∫Ôºü`</span><br>`&#125;`<br></code></pre></td></tr></table></figure>

<p>Âú®Ëøô‰∏™‰æãÂ≠ê‰∏≠ÔºåÁî±‰∫émainÁ∫øÁ®ã‰ºëÁú†ÔºåÊâÄ‰ª•Á∫øÁ®ãaÁöÑrun()ÊñπÊ≥ïË∑üÁùÄÊâßË°åÔºåÁ∫øÁ®ãbÂÜçÊé•ÁùÄÊâßË°å„ÄÇ</p>
<p>Âú®Á∫øÁ®ãaÊâßË°årun()Ë∞ÉÁî®testMethod()‰πãÂêéÔºåÁ∫øÁ®ãa‰ºëÁú†‰∫Ü2000msÔºàÊ≥®ÊÑèËøôÈáåÊòØÊ≤°ÊúâÈáäÊîæÈîÅÁöÑÔºâÔºåmainÁ∫øÁ®ã‰ºëÁú†ÂÆåÊØïÔºåÊé•ÁùÄbÁ∫øÁ®ãÊâßË°åÁöÑÊó∂ÂÄôÊòØ‰∫âÂ§∫‰∏çÂà∞ÈîÅÁöÑÔºåÊâÄ‰ª•ËøôÈáåËæìÂá∫Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">a:TIMED_WAITING<br><br>b:BLOCKED<br></code></pre></td></tr></table></figure>



<h3 id="4-3-2-WAITINGÁä∂ÊÄÅ‰∏éRUNNABLEÁä∂ÊÄÅÁöÑËΩ¨Êç¢"><a href="#4-3-2-WAITINGÁä∂ÊÄÅ‰∏éRUNNABLEÁä∂ÊÄÅÁöÑËΩ¨Êç¢" class="headerlink" title="4.3.2 WAITINGÁä∂ÊÄÅ‰∏éRUNNABLEÁä∂ÊÄÅÁöÑËΩ¨Êç¢"></a>4.3.2 WAITINGÁä∂ÊÄÅ‰∏éRUNNABLEÁä∂ÊÄÅÁöÑËΩ¨Êç¢</h3><p>Ê†πÊçÆËΩ¨Êç¢ÂõæÊàë‰ª¨Áü•ÈÅìÊúâ3‰∏™ÊñπÊ≥ïÂèØ‰ª•‰ΩøÁ∫øÁ®ã‰ªéRUNNABLEÁä∂ÊÄÅËΩ¨‰∏∫WAITINGÁä∂ÊÄÅ„ÄÇÊàë‰ª¨‰∏ªË¶Å‰ªãÁªç‰∏ã**Object.wait()<strong>Âíå</strong>Thread.join()**„ÄÇ <strong>Object.wait()</strong></p>
<blockquote>
<p>Ë∞ÉÁî®wait()ÊñπÊ≥ïÂâçÁ∫øÁ®ãÂøÖÈ°ªÊåÅÊúâÂØπË±°ÁöÑÈîÅ„ÄÇ</p>
<p>Á∫øÁ®ãË∞ÉÁî®wait()ÊñπÊ≥ïÊó∂Ôºå‰ºöÈáäÊîæÂΩìÂâçÁöÑÈîÅÔºåÁõ¥Âà∞ÊúâÂÖ∂‰ªñÁ∫øÁ®ãË∞ÉÁî®notify()&#x2F;notifyAll()ÊñπÊ≥ïÂî§ÈÜíÁ≠âÂæÖÈîÅÁöÑÁ∫øÁ®ã„ÄÇ</p>
<p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂÖ∂‰ªñÁ∫øÁ®ãË∞ÉÁî®notify()ÊñπÊ≥ïÂè™‰ºöÂî§ÈÜíÂçï‰∏™Á≠âÂæÖÈîÅÁöÑÁ∫øÁ®ãÔºåÂ¶ÇÊúâÊúâÂ§ö‰∏™Á∫øÁ®ãÈÉΩÂú®Á≠âÂæÖËøô‰∏™ÈîÅÁöÑËØù‰∏ç‰∏ÄÂÆö‰ºöÂî§ÈÜíÂà∞‰πãÂâçË∞ÉÁî®wait()ÊñπÊ≥ïÁöÑÁ∫øÁ®ã„ÄÇ</p>
<p>ÂêåÊ†∑ÔºåË∞ÉÁî®notifyAll()ÊñπÊ≥ïÂî§ÈÜíÊâÄÊúâÁ≠âÂæÖÈîÅÁöÑÁ∫øÁ®ã‰πãÂêéÔºå‰πü‰∏ç‰∏ÄÂÆö‰ºöÈ©¨‰∏äÊääÊó∂Èó¥ÁâáÂàÜÁªôÂàöÊâçÊîæÂºÉÈîÅÁöÑÈÇ£‰∏™Á∫øÁ®ãÔºåÂÖ∑‰ΩìË¶ÅÁúãÁ≥ªÁªüÁöÑË∞ÉÂ∫¶„ÄÇ</p>
</blockquote>
<p><strong>Thread.join()</strong></p>
<blockquote>
<p>Ë∞ÉÁî®join()ÊñπÊ≥ï‰∏ç‰ºöÈáäÊîæÈîÅÔºå‰ºö‰∏ÄÁõ¥Á≠âÂæÖÂΩìÂâçÁ∫øÁ®ãÊâßË°åÂÆåÊØïÔºàËΩ¨Êç¢‰∏∫TERMINATEDÁä∂ÊÄÅÔºâ„ÄÇ</p>
</blockquote>
<p>Êàë‰ª¨ÂÜçÊää‰∏äÈù¢ÁöÑ‰æãÂ≠êÁ∫øÁ®ãÂêØÂä®ÈÇ£ÈáåÊîπÂèò‰∏Ä‰∏ãÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">blockedTest</span><span class="hljs-params">()</span> &#123;<br>    ¬∑¬∑¬∑¬∑¬∑¬∑<br>    a.start();<br>    a.join();<br>    b.start();<br>    System.out.println(a.getName() + <span class="hljs-string">&quot;:&quot;</span> + a.getState()); <span class="hljs-comment">// ËæìÂá∫ TERMINATED</span><br>    System.out.println(b.getName() + <span class="hljs-string">&quot;:&quot;</span> + b.getState());<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Ë¶ÅÊòØÊ≤°ÊúâË∞ÉÁî®joinÊñπÊ≥ïÔºåmainÁ∫øÁ®ã‰∏çÁÆ°aÁ∫øÁ®ãÊòØÂê¶ÊâßË°åÂÆåÊØïÈÉΩ‰ºöÁªßÁª≠ÂæÄ‰∏ãËµ∞„ÄÇ</p>
<p>aÁ∫øÁ®ãÂêØÂä®‰πãÂêéÈ©¨‰∏äË∞ÉÁî®‰∫ÜjoinÊñπÊ≥ïÔºåËøôÈáåmainÁ∫øÁ®ãÂ∞±‰ºöÁ≠âÂà∞aÁ∫øÁ®ãÊâßË°åÂÆåÊØïÔºåÊâÄ‰ª•ËøôÈáåaÁ∫øÁ®ãÊâìÂç∞ÁöÑÁä∂ÊÄÅÂõ∫ÂÆöÊòØ<strong>TERMIATED</strong>„ÄÇ</p>
<p>Ëá≥‰∫ébÁ∫øÁ®ãÁöÑÁä∂ÊÄÅÔºåÊúâÂèØËÉΩÊâìÂç∞RUNNABLEÔºàÂ∞öÊú™ËøõÂÖ•ÂêåÊ≠•ÊñπÊ≥ïÔºâÔºå‰πüÊúâÂèØËÉΩÊâìÂç∞TIMED_WAITINGÔºàËøõÂÖ•‰∫ÜÂêåÊ≠•ÊñπÊ≥ïÔºâ„ÄÇ</p>
<h3 id="4-3-3-TIMED-WAITING‰∏éRUNNABLEÁä∂ÊÄÅËΩ¨Êç¢"><a href="#4-3-3-TIMED-WAITING‰∏éRUNNABLEÁä∂ÊÄÅËΩ¨Êç¢" class="headerlink" title="4.3.3 TIMED_WAITING‰∏éRUNNABLEÁä∂ÊÄÅËΩ¨Êç¢"></a>4.3.3 TIMED_WAITING‰∏éRUNNABLEÁä∂ÊÄÅËΩ¨Êç¢</h3><p>TIMED_WAITING‰∏éWAITINGÁä∂ÊÄÅÁ±ª‰ººÔºåÂè™ÊòØTIMED_WAITINGÁä∂ÊÄÅÁ≠âÂæÖÁöÑÊó∂Èó¥ÊòØÊåáÂÆöÁöÑ„ÄÇ</p>
<p><strong>Thread.sleep(long)</strong></p>
<blockquote>
<p>‰ΩøÂΩìÂâçÁ∫øÁ®ãÁù°Áú†ÊåáÂÆöÊó∂Èó¥„ÄÇÈúÄË¶ÅÊ≥®ÊÑèËøôÈáåÁöÑ‚ÄúÁù°Áú†‚ÄùÂè™ÊòØÊöÇÊó∂‰ΩøÁ∫øÁ®ãÂÅúÊ≠¢ÊâßË°åÔºåÂπ∂‰∏ç‰ºöÈáäÊîæÈîÅ„ÄÇÊó∂Èó¥Âà∞ÂêéÔºåÁ∫øÁ®ã‰ºöÈáçÊñ∞ËøõÂÖ•RUNNABLEÁä∂ÊÄÅ„ÄÇ</p>
</blockquote>
<p><strong>Object.wait(long)</strong></p>
<blockquote>
<p>wait(long)ÊñπÊ≥ï‰ΩøÁ∫øÁ®ãËøõÂÖ•TIMED_WAITINGÁä∂ÊÄÅ„ÄÇËøôÈáåÁöÑwait(long)ÊñπÊ≥ï‰∏éÊó†ÂèÇÊñπÊ≥ïwait()Áõ∏ÂêåÁöÑÂú∞ÊñπÊòØÔºåÈÉΩÂèØ‰ª•ÈÄöËøáÂÖ∂‰ªñÁ∫øÁ®ãË∞ÉÁî®notify()ÊàñnotifyAll()ÊñπÊ≥ïÊù•Âî§ÈÜí„ÄÇ</p>
<p>‰∏çÂêåÁöÑÂú∞ÊñπÊòØÔºåÊúâÂèÇÊñπÊ≥ïwait(long)Â∞±ÁÆóÂÖ∂‰ªñÁ∫øÁ®ã‰∏çÊù•Âî§ÈÜíÂÆÉÔºåÁªèËøáÊåáÂÆöÊó∂Èó¥long‰πãÂêéÂÆÉ‰ºöËá™Âä®Âî§ÈÜíÔºåÊã•ÊúâÂéª‰∫âÂ§∫ÈîÅÁöÑËµÑÊ†º„ÄÇ</p>
</blockquote>
<p><strong>Thread.join(long)</strong></p>
<blockquote>
<p>join(long)‰ΩøÂΩìÂâçÁ∫øÁ®ãÊâßË°åÊåáÂÆöÊó∂Èó¥ÔºåÂπ∂‰∏î‰ΩøÁ∫øÁ®ãËøõÂÖ•TIMED_WAITINGÁä∂ÊÄÅ„ÄÇ</p>
<p>Êàë‰ª¨ÂÜçÊù•Êîπ‰∏ÄÊîπÂàöÊâçÁöÑÁ§∫‰æã:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">blockedTest</span><span class="hljs-params">()</span> &#123;<br>    ¬∑¬∑¬∑¬∑¬∑¬∑<br>    a.start();<br>    a.join(<span class="hljs-number">1000L</span>);<br>    b.start();<br>    System.out.println(a.getName() + <span class="hljs-string">&quot;:&quot;</span> + a.getState()); <span class="hljs-comment">// ËæìÂá∫ TIEMD_WAITING</span><br>    System.out.println(b.getName() + <span class="hljs-string">&quot;:&quot;</span> + b.getState());<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ËøôÈáåË∞ÉÁî®a.join(1000L)ÔºåÂõ†‰∏∫ÊòØÊåáÂÆö‰∫ÜÂÖ∑‰ΩìaÁ∫øÁ®ãÊâßË°åÁöÑÊó∂Èó¥ÁöÑÔºåÂπ∂‰∏îÊâßË°åÊó∂Èó¥ÊòØÂ∞è‰∫éaÁ∫øÁ®ãsleepÁöÑÊó∂Èó¥ÔºåÊâÄ‰ª•aÁ∫øÁ®ãÁä∂ÊÄÅËæìÂá∫TIMED_WAITING„ÄÇ</p>
</blockquote>
<p>bÁ∫øÁ®ãÁä∂ÊÄÅ‰ªçÁÑ∂‰∏çÂõ∫ÂÆöÔºàRUNNABLEÊàñBLOCKEDÔºâ„ÄÇ</p>
<h3 id="4-3-4-Á∫øÁ®ã‰∏≠Êñ≠"><a href="#4-3-4-Á∫øÁ®ã‰∏≠Êñ≠" class="headerlink" title="4.3.4 Á∫øÁ®ã‰∏≠Êñ≠"></a>4.3.4 Á∫øÁ®ã‰∏≠Êñ≠</h3><blockquote>
<p>Âú®Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨Âú®Á∫øÁ®ãÂêØÂä®ÂêéÂèëÁé∞Âπ∂‰∏çÈúÄË¶ÅÂÆÉÁªßÁª≠ÊâßË°å‰∏ãÂéªÊó∂ÔºåÈúÄË¶Å‰∏≠Êñ≠Á∫øÁ®ã„ÄÇÁõÆÂâçÂú®JavaÈáåËøòÊ≤°ÊúâÂÆâÂÖ®Áõ¥Êé•ÁöÑÊñπÊ≥ïÊù•ÂÅúÊ≠¢Á∫øÁ®ãÔºå‰ΩÜÊòØJavaÊèê‰æõ‰∫ÜÁ∫øÁ®ã‰∏≠Êñ≠Êú∫Âà∂Êù•Â§ÑÁêÜÈúÄË¶Å‰∏≠Êñ≠Á∫øÁ®ãÁöÑÊÉÖÂÜµ„ÄÇ</p>
<p>Á∫øÁ®ã‰∏≠Êñ≠Êú∫Âà∂ÊòØ‰∏ÄÁßçÂçè‰ΩúÊú∫Âà∂„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÔºåÈÄöËøá‰∏≠Êñ≠Êìç‰ΩúÂπ∂‰∏çËÉΩÁõ¥Êé•ÁªàÊ≠¢‰∏Ä‰∏™Á∫øÁ®ãÔºåËÄåÊòØÈÄöÁü•ÈúÄË¶ÅË¢´‰∏≠Êñ≠ÁöÑÁ∫øÁ®ãËá™Ë°åÂ§ÑÁêÜ„ÄÇ</p>
</blockquote>
<p>ÁÆÄÂçï‰ªãÁªç‰∏ãThreadÁ±ªÈáåÊèê‰æõÁöÑÂÖ≥‰∫éÁ∫øÁ®ã‰∏≠Êñ≠ÁöÑÂá†‰∏™ÊñπÊ≥ïÔºö</p>
<p>- </p>
<p>  Thread.interrupt()Ôºö‰∏≠Êñ≠Á∫øÁ®ã„ÄÇËøôÈáåÁöÑ‰∏≠Êñ≠Á∫øÁ®ãÂπ∂‰∏ç‰ºöÁ´ãÂç≥ÂÅúÊ≠¢Á∫øÁ®ãÔºåËÄåÊòØËÆæÁΩÆÁ∫øÁ®ãÁöÑ‰∏≠Êñ≠Áä∂ÊÄÅ‰∏∫trueÔºàÈªòËÆ§ÊòØflaseÔºâÔºõ</p>
<p>- </p>
<p>  Thread.interrupted()ÔºöÊµãËØïÂΩìÂâçÁ∫øÁ®ãÊòØÂê¶Ë¢´‰∏≠Êñ≠„ÄÇÁ∫øÁ®ãÁöÑ‰∏≠Êñ≠Áä∂ÊÄÅÂèóËøô‰∏™ÊñπÊ≥ïÁöÑÂΩ±ÂìçÔºåÊÑèÊÄùÊòØË∞ÉÁî®‰∏ÄÊ¨°‰ΩøÁ∫øÁ®ã‰∏≠Êñ≠Áä∂ÊÄÅËÆæÁΩÆ‰∏∫trueÔºåËøûÁª≠Ë∞ÉÁî®‰∏§Ê¨°‰ºö‰ΩøÂæóËøô‰∏™Á∫øÁ®ãÁöÑ‰∏≠Êñ≠Áä∂ÊÄÅÈáçÊñ∞ËΩ¨‰∏∫falseÔºõ</p>
<p>- </p>
<p>  Thread.isInterrupted()ÔºöÊµãËØïÂΩìÂâçÁ∫øÁ®ãÊòØÂê¶Ë¢´‰∏≠Êñ≠„ÄÇ‰∏é‰∏äÈù¢ÊñπÊ≥ï‰∏çÂêåÁöÑÊòØË∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÂπ∂‰∏ç‰ºöÂΩ±ÂìçÁ∫øÁ®ãÁöÑ‰∏≠Êñ≠Áä∂ÊÄÅ„ÄÇ</p>
<blockquote>
<p>Âú®Á∫øÁ®ã‰∏≠Êñ≠Êú∫Âà∂ÈáåÔºåÂΩìÂÖ∂‰ªñÁ∫øÁ®ãÈÄöÁü•ÈúÄË¶ÅË¢´‰∏≠Êñ≠ÁöÑÁ∫øÁ®ãÂêéÔºåÁ∫øÁ®ã‰∏≠Êñ≠ÁöÑÁä∂ÊÄÅË¢´ËÆæÁΩÆ‰∏∫trueÔºå‰ΩÜÊòØÂÖ∑‰ΩìË¢´Ë¶ÅÊ±Ç‰∏≠Êñ≠ÁöÑÁ∫øÁ®ãË¶ÅÊÄé‰πàÂ§ÑÁêÜÔºåÂÆåÂÖ®Áî±Ë¢´‰∏≠Êñ≠Á∫øÁ®ãËá™Â∑±ËÄåÂÆöÔºåÂèØ‰ª•Âú®ÂêàÈÄÇÁöÑÂÆûÈôÖÂ§ÑÁêÜ‰∏≠Êñ≠ËØ∑Ê±ÇÔºå‰πüÂèØ‰ª•ÂÆåÂÖ®‰∏çÂ§ÑÁêÜÁªßÁª≠ÊâßË°å‰∏ãÂéª„ÄÇ</p>
</blockquote>
<p><strong>ÂèÇËÄÉËµÑÊñô</strong></p>
<p>- </p>
<p>  JDK 1.8 Ê∫êÁ†Å</p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/pangpang123654/article/details/77006244">Ê∑±ÂÖ•Thread.sleep</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://tech.meituan.com/Java_Lock.html">‰∏çÂèØ‰∏çËØ¥ÁöÑJava‚ÄúÈîÅ‚Äù‰∫ã</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://fangjian0423.github.io/2016/06/04/java-thread-state/">JavaÁ∫øÁ®ãÁä∂ÊÄÅÂàÜÊûê</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/CringKong/article/details/79994511">JavaÁ∫øÁ®ãÂíåÊìç‰ΩúÁ≥ªÁªüÁ∫øÁ®ãÁöÑÂÖ≥Á≥ª</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://www.infoq.cn/article/java-interrupt-mechanism">ËØ¶ÁªÜÂàÜÊûê Java ‰∏≠Êñ≠Êú∫Âà∂</a></p>
<h1 id="5-JavaÁ∫øÁ®ãÈó¥ÁöÑÈÄö‰ø°"><a href="#5-JavaÁ∫øÁ®ãÈó¥ÁöÑÈÄö‰ø°" class="headerlink" title="5 JavaÁ∫øÁ®ãÈó¥ÁöÑÈÄö‰ø°"></a>5 JavaÁ∫øÁ®ãÈó¥ÁöÑÈÄö‰ø°</h1><p>ÂêàÁêÜÁöÑ‰ΩøÁî®JavaÂ§öÁ∫øÁ®ãÂèØ‰ª•Êõ¥Â•ΩÂú∞Âà©Áî®ÊúçÂä°Âô®ËµÑÊ∫ê„ÄÇ‰∏ÄËà¨Êù•ËÆ≤ÔºåÁ∫øÁ®ãÂÜÖÈÉ®ÊúâËá™Â∑±ÁßÅÊúâÁöÑÁ∫øÁ®ã‰∏ä‰∏ãÊñáÔºå‰∫í‰∏çÂπ≤Êâ∞„ÄÇ‰ΩÜÊòØÂΩìÊàë‰ª¨ÈúÄË¶ÅÂ§ö‰∏™Á∫øÁ®ã‰πãÈó¥Áõ∏‰∫íÂçè‰ΩúÁöÑÊó∂ÂÄôÔºåÂ∞±ÈúÄË¶ÅÊàë‰ª¨ÊéåÊè°JavaÁ∫øÁ®ãÁöÑÈÄö‰ø°ÊñπÂºè„ÄÇÊú¨ÊñáÂ∞Ü‰ªãÁªçJavaÁ∫øÁ®ã‰πãÈó¥ÁöÑÂá†ÁßçÈÄö‰ø°ÂéüÁêÜ„ÄÇ</p>
<h2 id="5-1-ÈîÅ‰∏éÂêåÊ≠•"><a href="#5-1-ÈîÅ‰∏éÂêåÊ≠•" class="headerlink" title="5.1 ÈîÅ‰∏éÂêåÊ≠•"></a>5.1 ÈîÅ‰∏éÂêåÊ≠•</h2><p>Âú®Java‰∏≠ÔºåÈîÅÁöÑÊ¶ÇÂøµÈÉΩÊòØÂü∫‰∫éÂØπË±°ÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨ÂèàÁªèÂ∏∏Áß∞ÂÆÉ‰∏∫ÂØπË±°ÈîÅ„ÄÇÁ∫øÁ®ãÂíåÈîÅÁöÑÂÖ≥Á≥ªÔºåÊàë‰ª¨ÂèØ‰ª•Áî®Â©öÂßªÂÖ≥Á≥ªÊù•ÁêÜËß£„ÄÇ‰∏Ä‰∏™ÈîÅÂêå‰∏ÄÊó∂Èó¥Âè™ËÉΩË¢´‰∏Ä‰∏™Á∫øÁ®ãÊåÅÊúâ„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºå‰∏Ä‰∏™ÈîÅÂ¶ÇÊûúÂíå‰∏Ä‰∏™Á∫øÁ®ã‚ÄúÁªìÂ©ö‚ÄùÔºàÊåÅÊúâÔºâÔºåÈÇ£ÂÖ∂‰ªñÁ∫øÁ®ãÂ¶ÇÊûúÈúÄË¶ÅÂæóÂà∞Ëøô‰∏™ÈîÅÔºåÂ∞±ÂæóÁ≠âËøô‰∏™Á∫øÁ®ãÂíåËøô‰∏™ÈîÅ‚ÄúÁ¶ªÂ©ö‚ÄùÔºàÈáäÊîæÔºâ„ÄÇ</p>
<p>Âú®Êàë‰ª¨ÁöÑÁ∫øÁ®ã‰πãÈó¥ÔºåÊúâ‰∏Ä‰∏™ÂêåÊ≠•ÁöÑÊ¶ÇÂøµ„ÄÇ‰ªÄ‰πàÊòØÂêåÊ≠•Âë¢ÔºåÂÅáÂ¶ÇÊàë‰ª¨Áé∞Âú®Êúâ2‰ΩçÊ≠£Âú®ÊäÑÊöëÂÅá‰Ωú‰∏öÁ≠îÊ°àÁöÑÂêåÂ≠¶ÔºöÁ∫øÁ®ãAÂíåÁ∫øÁ®ãB„ÄÇÂΩì‰ªñ‰ª¨Ê≠£Âú®ÊäÑÁöÑÊó∂ÂÄôÔºåËÄÅÂ∏àÁ™ÅÁÑ∂Êù•‰øÆÊîπ‰∫Ü‰∏Ä‰∫õÁ≠îÊ°àÔºåÂèØËÉΩAÂíåBÊúÄÂêéÂÜôÂá∫ÁöÑÊöëÂÅá‰Ωú‰∏öÂ∞±‰∏ç‰∏ÄÊ†∑„ÄÇÊàë‰ª¨‰∏∫‰∫ÜA,BËÉΩÂÜôÂá∫2Êú¨Áõ∏ÂêåÁöÑÊöëÂÅá‰Ωú‰∏öÔºåÊàë‰ª¨Â∞±ÈúÄË¶ÅËÆ©ËÄÅÂ∏àÂÖà‰øÆÊîπÁ≠îÊ°àÔºåÁÑ∂ÂêéAÔºåBÂêåÂ≠¶ÂÜçÊäÑ„ÄÇÊàñËÄÖAÔºåBÂêåÂ≠¶ÂÖàÊäÑÂÆåÔºåËÄÅÂ∏àÂÜç‰øÆÊîπÁ≠îÊ°à„ÄÇËøôÂ∞±ÊòØÁ∫øÁ®ãAÔºåÁ∫øÁ®ãBÁöÑÁ∫øÁ®ãÂêåÊ≠•„ÄÇ</p>
<p>ÂèØ‰ª•‰ª•Ëß£Èáä‰∏∫ÔºöÁ∫øÁ®ãÂêåÊ≠•ÊòØÁ∫øÁ®ã‰πãÈó¥ÊåâÁÖß<strong>‰∏ÄÂÆöÁöÑÈ°∫Â∫è</strong>ÊâßË°å„ÄÇ</p>
<p>‰∏∫‰∫ÜËææÂà∞Á∫øÁ®ãÂêåÊ≠•ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÈîÅÊù•ÂÆûÁé∞ÂÆÉ„ÄÇ</p>
<p>Êàë‰ª¨ÂÖàÊù•ÁúãÁúã‰∏Ä‰∏™Êó†ÈîÅÁöÑÁ®ãÂ∫èÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NoneLock</span> &#123;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadA</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;<br>                System.out.println(<span class="hljs-string">&quot;Thread A &quot;</span> + i);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadB</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;<br>                System.out.println(<span class="hljs-string">&quot;Thread B &quot;</span> + i);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadA</span>()).start();<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadB</span>()).start();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>ÊâßË°åËøô‰∏™Á®ãÂ∫èÔºå‰Ω†‰ºöÂú®ÊéßÂà∂Âè∞ÁúãÂà∞ÔºåÁ∫øÁ®ãAÂíåÁ∫øÁ®ãBÂêÑËá™Áã¨Á´ãÂ∑•‰ΩúÔºåËæìÂá∫Ëá™Â∑±ÁöÑÊâìÂç∞ÂÄº„ÄÇÂ¶Ç‰∏ãÊòØÊàëÁöÑÁîµËÑë‰∏äÊüê‰∏ÄÊ¨°ËøêË°åÁöÑÁªìÊûú„ÄÇÊØè‰∏ÄÊ¨°ËøêË°åÁªìÊûúÈÉΩ‰ºö‰∏ç‰∏ÄÊ†∑„ÄÇ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">....<br>Thread A <span class="hljs-number">48</span><br>Thread A <span class="hljs-number">49</span><br>Thread B <span class="hljs-number">0</span><br>Thread A <span class="hljs-number">50</span><br>Thread B <span class="hljs-number">1</span><br>Thread A <span class="hljs-number">51</span><br>Thread A <span class="hljs-number">52</span><br>....<br></code></pre></td></tr></table></figure>

<p>ÈÇ£ÊàëÁé∞Âú®Êúâ‰∏Ä‰∏™ÈúÄÊ±ÇÔºåÊàëÊÉ≥Á≠âAÂÖàÊâßË°åÂÆå‰πãÂêéÔºåÂÜçÁî±BÂéªÊâßË°åÔºåÊÄé‰πàÂäûÂë¢ÔºüÊúÄÁÆÄÂçïÁöÑÊñπÂºèÂ∞±ÊòØ‰ΩøÁî®‰∏Ä‰∏™‚ÄúÂØπË±°ÈîÅ‚ÄùÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectLock</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadA</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">synchronized</span> (lock) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;<br>                    System.out.println(<span class="hljs-string">&quot;Thread A &quot;</span> + i);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadB</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">synchronized</span> (lock) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;<br>                    System.out.println(<span class="hljs-string">&quot;Thread B &quot;</span> + i);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadA</span>()).start();<br>        Thread.sleep(<span class="hljs-number">10</span>);<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadB</span>()).start();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>ËøôÈáåÂ£∞Êòé‰∫Ü‰∏Ä‰∏™ÂêçÂ≠ó‰∏∫<code>lock</code>ÁöÑÂØπË±°ÈîÅ„ÄÇÊàë‰ª¨Âú®<code>ThreadA</code>Âíå<code>ThreadB</code>ÂÜÖÈúÄË¶ÅÂêåÊ≠•ÁöÑ‰ª£Á†ÅÂùóÈáåÔºåÈÉΩÊòØÁî®<code>synchronized</code>ÂÖ≥ÈîÆÂ≠óÂä†‰∏ä‰∫ÜÂêå‰∏Ä‰∏™ÂØπË±°ÈîÅ<code>lock</code>„ÄÇ</p>
<p>‰∏äÊñáÊàë‰ª¨ËØ¥Âà∞‰∫ÜÔºåÊ†πÊçÆÁ∫øÁ®ãÂíåÈîÅÁöÑÂÖ≥Á≥ªÔºåÂêå‰∏ÄÊó∂Èó¥Âè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãÊåÅÊúâ‰∏Ä‰∏™ÈîÅÔºåÈÇ£‰πàÁ∫øÁ®ãBÂ∞±‰ºöÁ≠âÁ∫øÁ®ãAÊâßË°åÂÆåÊàêÂêéÈáäÊîæ<code>lock</code>ÔºåÁ∫øÁ®ãBÊâçËÉΩËé∑ÂæóÈîÅ<code>lock</code>„ÄÇ</p>
<blockquote>
<p>ËøôÈáåÂú®‰∏ªÁ∫øÁ®ãÈáå‰ΩøÁî®sleepÊñπÊ≥ïÁù°Áú†‰∫Ü10ÊØ´ÁßíÔºåÊòØ‰∏∫‰∫ÜÈò≤Ê≠¢Á∫øÁ®ãBÂÖàÂæóÂà∞ÈîÅ„ÄÇÂõ†‰∏∫Â¶ÇÊûúÂêåÊó∂startÔºåÁ∫øÁ®ãAÂíåÁ∫øÁ®ãBÈÉΩÊòØÂá∫‰∫éÂ∞±Áª™Áä∂ÊÄÅÔºåÊìç‰ΩúÁ≥ªÁªüÂèØËÉΩ‰ºöÂÖàËÆ©BËøêË°å„ÄÇËøôÊ†∑Â∞±‰ºöÂÖàËæìÂá∫BÁöÑÂÜÖÂÆπÔºåÁÑ∂ÂêéBÊâßË°åÂÆåÊàê‰πãÂêéËá™Âä®ÈáäÊîæÈîÅÔºåÁ∫øÁ®ãAÂÜçÊâßË°å„ÄÇ</p>
</blockquote>
<h2 id="5-2-Á≠âÂæÖ-x2F-ÈÄöÁü•Êú∫Âà∂"><a href="#5-2-Á≠âÂæÖ-x2F-ÈÄöÁü•Êú∫Âà∂" class="headerlink" title="5.2 Á≠âÂæÖ&#x2F;ÈÄöÁü•Êú∫Âà∂"></a>5.2 Á≠âÂæÖ&#x2F;ÈÄöÁü•Êú∫Âà∂</h2><p>‰∏äÈù¢‰∏ÄÁßçÂü∫‰∫é‚ÄúÈîÅ‚ÄùÁöÑÊñπÂºèÔºåÁ∫øÁ®ãÈúÄË¶Å‰∏çÊñ≠Âú∞ÂéªÂ∞ùËØïËé∑ÂæóÈîÅÔºåÂ¶ÇÊûúÂ§±Ë¥•‰∫ÜÔºåÂÜçÁªßÁª≠Â∞ùËØï„ÄÇËøôÂèØËÉΩ‰ºöËÄóË¥πÊúçÂä°Âô®ËµÑÊ∫ê„ÄÇ</p>
<p>ËÄåÁ≠âÂæÖ&#x2F;ÈÄöÁü•Êú∫Âà∂ÊòØÂè¶‰∏ÄÁßçÊñπÂºè„ÄÇ</p>
<p>JavaÂ§öÁ∫øÁ®ãÁöÑÁ≠âÂæÖ&#x2F;ÈÄöÁü•Êú∫Âà∂ÊòØÂü∫‰∫é<code>Object</code>Á±ªÁöÑ<code>wait()</code>ÊñπÊ≥ïÂíå<code>notify()</code>, <code>notifyAll()</code>ÊñπÊ≥ïÊù•ÂÆûÁé∞ÁöÑ„ÄÇ</p>
<blockquote>
<p>notify()ÊñπÊ≥ï‰ºöÈöèÊú∫Âè´ÈÜí‰∏Ä‰∏™Ê≠£Âú®Á≠âÂæÖÁöÑÁ∫øÁ®ãÔºåËÄånotifyAll()‰ºöÂè´ÈÜíÊâÄÊúâÊ≠£Âú®Á≠âÂæÖÁöÑÁ∫øÁ®ã„ÄÇ</p>
</blockquote>
<p>ÂâçÈù¢Êàë‰ª¨ËÆ≤Âà∞Ôºå‰∏Ä‰∏™ÈîÅÂêå‰∏ÄÊó∂ÂàªÂè™ËÉΩË¢´‰∏Ä‰∏™Á∫øÁ®ãÊåÅÊúâ„ÄÇËÄåÂÅáÂ¶ÇÁ∫øÁ®ãAÁé∞Âú®ÊåÅÊúâ‰∫Ü‰∏Ä‰∏™ÈîÅ<code>lock</code>Âπ∂ÂºÄÂßãÊâßË°åÔºåÂÆÉÂèØ‰ª•‰ΩøÁî®<code>lock.wait()</code>ËÆ©Ëá™Â∑±ËøõÂÖ•Á≠âÂæÖÁä∂ÊÄÅ„ÄÇËøô‰∏™Êó∂ÂÄôÔºå<code>lock</code>Ëøô‰∏™ÈîÅÊòØË¢´ÈáäÊîæ‰∫ÜÁöÑ„ÄÇ</p>
<p>ËøôÊó∂ÔºåÁ∫øÁ®ãBËé∑Âæó‰∫Ü<code>lock</code>Ëøô‰∏™ÈîÅÂπ∂ÂºÄÂßãÊâßË°åÔºåÂÆÉÂèØ‰ª•Âú®Êüê‰∏ÄÊó∂ÂàªÔºå‰ΩøÁî®<code>lock.notify()</code>ÔºåÈÄöÁü•‰πãÂâçÊåÅÊúâ<code>lock</code>ÈîÅÂπ∂ËøõÂÖ•Á≠âÂæÖÁä∂ÊÄÅÁöÑÁ∫øÁ®ãAÔºåËØ¥‚ÄúÁ∫øÁ®ãA‰Ω†‰∏çÁî®Á≠â‰∫ÜÔºåÂèØ‰ª•ÂæÄ‰∏ãÊâßË°å‰∫Ü‚Äù„ÄÇ</p>
<blockquote>
<p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåËøô‰∏™Êó∂ÂÄôÁ∫øÁ®ãBÂπ∂Ê≤°ÊúâÈáäÊîæÈîÅ<code>lock</code>ÔºåÈô§ÈùûÁ∫øÁ®ãBËøô‰∏™Êó∂ÂÄô‰ΩøÁî®<code>lock.wait()</code>ÈáäÊîæÈîÅÔºåÊàñËÄÖÁ∫øÁ®ãBÊâßË°åÁªìÊùüËá™Ë°åÈáäÊîæÈîÅÔºåÁ∫øÁ®ãAÊâçËÉΩÂæóÂà∞<code>lock</code>ÈîÅ„ÄÇ</p>
</blockquote>
<p>Êàë‰ª¨Áî®‰ª£Á†ÅÊù•ÂÆûÁé∞‰∏Ä‰∏ãÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WaitAndNotify</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadA</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">synchronized</span> (lock) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        System.out.println(<span class="hljs-string">&quot;ThreadA: &quot;</span> + i);<br>                        lock.notify();<br>                        lock.wait();<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>                lock.notify();<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadB</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">synchronized</span> (lock) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        System.out.println(<span class="hljs-string">&quot;ThreadB: &quot;</span> + i);<br>                        lock.notify();<br>                        lock.wait();<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>                lock.notify();<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadA</span>()).start();<br>        Thread.sleep(<span class="hljs-number">1000</span>);<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadB</span>()).start();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-comment">// ËæìÂá∫Ôºö</span><br>ThreadA: <span class="hljs-number">0</span><br>ThreadB: <span class="hljs-number">0</span><br>ThreadA: <span class="hljs-number">1</span><br>ThreadB: <span class="hljs-number">1</span><br>ThreadA: <span class="hljs-number">2</span><br>ThreadB: <span class="hljs-number">2</span><br>ThreadA: <span class="hljs-number">3</span><br>ThreadB: <span class="hljs-number">3</span><br>ThreadA: <span class="hljs-number">4</span><br>ThreadB: <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure>

<p>Âú®Ëøô‰∏™DemoÈáåÔºåÁ∫øÁ®ãAÂíåÁ∫øÁ®ãBÈ¶ñÂÖàÊâìÂç∞Âá∫Ëá™Â∑±ÈúÄË¶ÅÁöÑ‰∏úË•øÔºåÁÑ∂Âêé‰ΩøÁî®<code>notify()</code>ÊñπÊ≥ïÂè´ÈÜíÂè¶‰∏Ä‰∏™Ê≠£Âú®Á≠âÂæÖÁöÑÁ∫øÁ®ãÔºåÁÑ∂ÂêéËá™Â∑±‰ΩøÁî®<code>wait()</code>ÊñπÊ≥ïÈô∑ÂÖ•Á≠âÂæÖÂπ∂ÈáäÊîæ<code>lock</code>ÈîÅ„ÄÇ</p>
<blockquote>
<p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÁ≠âÂæÖ&#x2F;ÈÄöÁü•Êú∫Âà∂‰ΩøÁî®ÁöÑÊòØ‰ΩøÁî®Âêå‰∏Ä‰∏™ÂØπË±°ÈîÅÔºåÂ¶ÇÊûú‰Ω†‰∏§‰∏™Á∫øÁ®ã‰ΩøÁî®ÁöÑÊòØ‰∏çÂêåÁöÑÂØπË±°ÈîÅÔºåÈÇ£ÂÆÉ‰ª¨‰πãÈó¥ÊòØ‰∏çËÉΩÁî®Á≠âÂæÖ&#x2F;ÈÄöÁü•Êú∫Âà∂ÈÄö‰ø°ÁöÑ„ÄÇ</p>
</blockquote>
<h2 id="5-3-‰ø°Âè∑Èáè"><a href="#5-3-‰ø°Âè∑Èáè" class="headerlink" title="5.3 ‰ø°Âè∑Èáè"></a>5.3 ‰ø°Âè∑Èáè</h2><p>JDKÊèê‰æõ‰∫Ü‰∏Ä‰∏™Á±ª‰ºº‰∫é‚Äú‰ø°Âè∑Èáè‚ÄùÂäüËÉΩÁöÑÁ±ª<code>Semaphore</code>„ÄÇ‰ΩÜÊú¨Êñá‰∏çÊòØË¶Å‰ªãÁªçËøô‰∏™Á±ªÔºåËÄåÊòØ‰ªãÁªç‰∏ÄÁßçÂü∫‰∫é<code>volatile</code>ÂÖ≥ÈîÆÂ≠óÁöÑËá™Â∑±ÂÆûÁé∞ÁöÑ‰ø°Âè∑ÈáèÈÄö‰ø°„ÄÇ</p>
<p>ÂêéÈù¢‰ºöÊúâ‰∏ìÈó®ÁöÑÁ´†ËäÇ‰ªãÁªç<code>volatile</code>ÂÖ≥ÈîÆÂ≠óÔºåËøôÈáåÂè™ÊòØÂÅö‰∏Ä‰∏™ÁÆÄÂçïÁöÑ‰ªãÁªç„ÄÇ</p>
<blockquote>
<p>volitileÂÖ≥ÈîÆÂ≠óËÉΩÂ§ü‰øùËØÅÂÜÖÂ≠òÁöÑÂèØËßÅÊÄßÔºåÂ¶ÇÊûúÁî®volitileÂÖ≥ÈîÆÂ≠óÂ£∞Êòé‰∫Ü‰∏Ä‰∏™ÂèòÈáèÔºåÂú®‰∏Ä‰∏™Á∫øÁ®ãÈáåÈù¢ÊîπÂèò‰∫ÜËøô‰∏™ÂèòÈáèÁöÑÂÄºÔºåÈÇ£ÂÖ∂ÂÆÉÁ∫øÁ®ãÊòØÁ´ãÈ©¨ÂèØËßÅÊõ¥ÊîπÂêéÁöÑÂÄºÁöÑ„ÄÇ</p>
</blockquote>
<p>ÊØîÂ¶ÇÊàëÁé∞Âú®Êúâ‰∏Ä‰∏™ÈúÄÊ±ÇÔºåÊàëÊÉ≥ËÆ©Á∫øÁ®ãAËæìÂá∫0ÔºåÁÑ∂ÂêéÁ∫øÁ®ãBËæìÂá∫1ÔºåÂÜçÁÑ∂ÂêéÁ∫øÁ®ãAËæìÂá∫2‚Ä¶‰ª•Ê≠§Á±ªÊé®„ÄÇÊàëÂ∫îËØ•ÊÄéÊ†∑ÂÆûÁé∞Âë¢Ôºü</p>
<p>‰ª£Á†ÅÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Signal</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">signal</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadA</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">while</span> (signal &lt; <span class="hljs-number">5</span>) &#123;<br>                <span class="hljs-keyword">if</span> (signal % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) &#123;<br>                    System.out.println(<span class="hljs-string">&quot;threadA: &quot;</span> + signal);<br>                    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>                        signal++;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadB</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">while</span> (signal &lt; <span class="hljs-number">5</span>) &#123;<br>                <span class="hljs-keyword">if</span> (signal % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) &#123;<br>                    System.out.println(<span class="hljs-string">&quot;threadB: &quot;</span> + signal);<br>                    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>                        signal = signal + <span class="hljs-number">1</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadA</span>()).start();<br>        Thread.sleep(<span class="hljs-number">1000</span>);<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadB</span>()).start();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-comment">// ËæìÂá∫Ôºö</span><br>threadA: <span class="hljs-number">0</span><br>threadB: <span class="hljs-number">1</span><br>threadA: <span class="hljs-number">2</span><br>threadB: <span class="hljs-number">3</span><br>threadA: <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure>

<p>Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Ôºå‰ΩøÁî®‰∫Ü‰∏Ä‰∏™<code>volatile</code>ÂèòÈáè<code>signal</code>Êù•ÂÆûÁé∞‰∫Ü‚Äú‰ø°Âè∑Èáè‚ÄùÁöÑÊ®°Âûã„ÄÇËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºå<code>volatile</code>ÂèòÈáèÈúÄË¶ÅËøõË°åÂéüÂ≠êÊìç‰Ωú„ÄÇ<code>signal++</code>Âπ∂‰∏çÊòØ‰∏Ä‰∏™ÂéüÂ≠êÊìç‰ΩúÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶Å‰ΩøÁî®<code>synchronized</code>ÁªôÂÆÉ‚Äú‰∏äÈîÅ‚Äù„ÄÇ</p>
<blockquote>
<p>ËøôÁßçÂÆûÁé∞ÊñπÂºèÂπ∂‰∏ç‰∏ÄÂÆöÈ´òÊïàÔºåÊú¨‰æãÂè™ÊòØÊºîÁ§∫‰ø°Âè∑Èáè</p>
</blockquote>
<h3 id="‰ø°Âè∑ÈáèÁöÑÂ∫îÁî®Âú∫ÊôØÔºö"><a href="#‰ø°Âè∑ÈáèÁöÑÂ∫îÁî®Âú∫ÊôØÔºö" class="headerlink" title="‰ø°Âè∑ÈáèÁöÑÂ∫îÁî®Âú∫ÊôØÔºö"></a>‰ø°Âè∑ÈáèÁöÑÂ∫îÁî®Âú∫ÊôØÔºö</h3><p>ÂÅáÂ¶ÇÂú®‰∏Ä‰∏™ÂÅúËΩ¶Âú∫‰∏≠ÔºåËΩ¶‰ΩçÊòØÊàë‰ª¨ÁöÑÂÖ¨ÂÖ±ËµÑÊ∫êÔºåÁ∫øÁ®ãÂ∞±Â¶ÇÂêåËΩ¶ËæÜÔºåËÄåÁúãÈó®ÁöÑÁÆ°ÁêÜÂëòÂ∞±ÊòØËµ∑ÁöÑ‚Äú‰ø°Âè∑Èáè‚ÄùÁöÑ‰ΩúÁî®„ÄÇ</p>
<p>Âõ†‰∏∫Âú®ËøôÁßçÂú∫ÊôØ‰∏ãÔºåÂ§ö‰∏™Á∫øÁ®ãÔºàË∂ÖËøá2‰∏™ÔºâÈúÄË¶ÅÁõ∏‰∫íÂêà‰ΩúÔºåÊàë‰ª¨Áî®ÁÆÄÂçïÁöÑ‚ÄúÈîÅ‚ÄùÂíå‚ÄúÁ≠âÂæÖÈÄöÁü•Êú∫Âà∂‚ÄùÂ∞±‰∏çÈÇ£‰πàÊñπ‰æø‰∫Ü„ÄÇËøô‰∏™Êó∂ÂÄôÂ∞±ÂèØ‰ª•Áî®Âà∞‰ø°Âè∑Èáè„ÄÇ</p>
<p>ÂÖ∂ÂÆûJDK‰∏≠Êèê‰æõÁöÑÂæàÂ§öÂ§öÁ∫øÁ®ãÈÄö‰ø°Â∑•ÂÖ∑Á±ªÈÉΩÊòØÂü∫‰∫é‰ø°Âè∑ÈáèÊ®°ÂûãÁöÑ„ÄÇÊàë‰ª¨‰ºöÂú®ÂêéÈù¢Á¨¨‰∏âÁØáÁöÑÊñáÁ´†‰∏≠‰ªãÁªç‰∏Ä‰∫õÂ∏∏Áî®ÁöÑÈÄö‰ø°Â∑•ÂÖ∑Á±ª„ÄÇ</p>
<h2 id="5-4-ÁÆ°ÈÅì"><a href="#5-4-ÁÆ°ÈÅì" class="headerlink" title="5.4 ÁÆ°ÈÅì"></a>5.4 ÁÆ°ÈÅì</h2><p>ÁÆ°ÈÅìÊòØÂü∫‰∫é‚ÄúÁÆ°ÈÅìÊµÅ‚ÄùÁöÑÈÄö‰ø°ÊñπÂºè„ÄÇJDKÊèê‰æõ‰∫Ü<code>PipedWriter</code>„ÄÅ <code>PipedReader</code>„ÄÅ <code>PipedOutputStream</code>„ÄÅ <code>PipedInputStream</code>„ÄÇÂÖ∂‰∏≠ÔºåÂâçÈù¢‰∏§‰∏™ÊòØÂü∫‰∫éÂ≠óÁ¨¶ÁöÑÔºåÂêéÈù¢‰∏§‰∏™ÊòØÂü∫‰∫éÂ≠óËäÇÊµÅÁöÑ„ÄÇ</p>
<p>ËøôÈáåÁöÑÁ§∫‰æã‰ª£Á†Å‰ΩøÁî®ÁöÑÊòØÂü∫‰∫éÂ≠óÁ¨¶ÁöÑÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Pipe</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReaderThread</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>        <span class="hljs-keyword">private</span> PipedReader reader;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">ReaderThread</span><span class="hljs-params">(PipedReader reader)</span> &#123;<br>            <span class="hljs-built_in">this</span>.reader = reader;<br>        &#125;<br>    <br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;this is reader&quot;</span>);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">receive</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">while</span> ((receive = reader.read()) != -<span class="hljs-number">1</span>) &#123;<br>                    System.out.print((<span class="hljs-type">char</span>)receive);<br>                &#125;<br>            &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WriterThread</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>    <br>        <span class="hljs-keyword">private</span> PipedWriter writer;<br>    <br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">WriterThread</span><span class="hljs-params">(PipedWriter writer)</span> &#123;<br>            <span class="hljs-built_in">this</span>.writer = writer;<br>        &#125;<br>    <br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;this is writer&quot;</span>);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">receive</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">try</span> &#123;<br>                writer.write(<span class="hljs-string">&quot;test&quot;</span>);<br>            &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                e.printStackTrace();<br>            &#125; <span class="hljs-keyword">finally</span> &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    writer.close();<br>                &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, InterruptedException &#123;<br>        <span class="hljs-type">PipedWriter</span> <span class="hljs-variable">writer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PipedWriter</span>();<br>        <span class="hljs-type">PipedReader</span> <span class="hljs-variable">reader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PipedReader</span>();<br>        writer.connect(reader); <span class="hljs-comment">// ËøôÈáåÊ≥®ÊÑè‰∏ÄÂÆöË¶ÅËøûÊé•ÔºåÊâçËÉΩÈÄö‰ø°</span><br>    <br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ReaderThread</span>(reader)).start();<br>        Thread.sleep(<span class="hljs-number">1000</span>);<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WriterThread</span>(writer)).start();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-comment">// ËæìÂá∫Ôºö</span><br><span class="hljs-built_in">this</span> is reader<br><span class="hljs-built_in">this</span> is writer<br>test<br></code></pre></td></tr></table></figure>

<p>Êàë‰ª¨ÈÄöËøáÁ∫øÁ®ãÁöÑÊûÑÈÄ†ÂáΩÊï∞Ôºå‰º†ÂÖ•‰∫Ü<code>PipedWrite</code>Âíå<code>PipedReader</code>ÂØπË±°„ÄÇÂèØ‰ª•ÁÆÄÂçïÂàÜÊûê‰∏Ä‰∏ãËøô‰∏™Á§∫‰æã‰ª£Á†ÅÁöÑÊâßË°åÊµÅÁ®ãÔºö</p>
<p>1. </p>
<p>   Á∫øÁ®ãReaderThreadÂºÄÂßãÊâßË°åÔºå</p>
<p>2. </p>
<p>   Á∫øÁ®ãReaderThread‰ΩøÁî®ÁÆ°ÈÅìreader.read()ËøõÂÖ•‚ÄùÈòªÂ°û‚ÄúÔºå</p>
<p>3. </p>
<p>   Á∫øÁ®ãWriterThreadÂºÄÂßãÊâßË°åÔºå</p>
<p>4. </p>
<p>   Á∫øÁ®ãWriterThreadÁî®writer.write(‚Äútest‚Äù)ÂæÄÁÆ°ÈÅìÂÜôÂÖ•Â≠óÁ¨¶‰∏≤Ôºå</p>
<p>5. </p>
<p>   Á∫øÁ®ãWriterThread‰ΩøÁî®writer.close()ÁªìÊùüÁÆ°ÈÅìÂÜôÂÖ•ÔºåÂπ∂ÊâßË°åÂÆåÊØïÔºå</p>
<p>6. </p>
<p>   Á∫øÁ®ãReaderThreadÊé•ÂèóÂà∞ÁÆ°ÈÅìËæìÂá∫ÁöÑÂ≠óÁ¨¶‰∏≤Âπ∂ÊâìÂç∞Ôºå</p>
<p>7. </p>
<p>   Á∫øÁ®ãReaderThreadÊâßË°åÂÆåÊØï„ÄÇ</p>
<h3 id="ÁÆ°ÈÅìÈÄö‰ø°ÁöÑÂ∫îÁî®Âú∫ÊôØÔºö"><a href="#ÁÆ°ÈÅìÈÄö‰ø°ÁöÑÂ∫îÁî®Âú∫ÊôØÔºö" class="headerlink" title="ÁÆ°ÈÅìÈÄö‰ø°ÁöÑÂ∫îÁî®Âú∫ÊôØÔºö"></a>ÁÆ°ÈÅìÈÄö‰ø°ÁöÑÂ∫îÁî®Âú∫ÊôØÔºö</h3><p>Ëøô‰∏™ÂæàÂ•ΩÁêÜËß£„ÄÇ‰ΩøÁî®ÁÆ°ÈÅìÂ§öÂçä‰∏éI&#x2F;OÊµÅÁõ∏ÂÖ≥„ÄÇÂΩìÊàë‰ª¨‰∏Ä‰∏™Á∫øÁ®ãÈúÄË¶ÅÂÖàÂè¶‰∏Ä‰∏™Á∫øÁ®ãÂèëÈÄÅ‰∏Ä‰∏™‰ø°ÊÅØÔºàÊØîÂ¶ÇÂ≠óÁ¨¶‰∏≤ÔºâÊàñËÄÖÊñá‰ª∂Á≠âÁ≠âÊó∂ÔºåÂ∞±ÈúÄË¶Å‰ΩøÁî®ÁÆ°ÈÅìÈÄö‰ø°‰∫Ü„ÄÇ</p>
<h2 id="5-5-ÂÖ∂ÂÆÉÈÄö‰ø°Áõ∏ÂÖ≥"><a href="#5-5-ÂÖ∂ÂÆÉÈÄö‰ø°Áõ∏ÂÖ≥" class="headerlink" title="5.5 ÂÖ∂ÂÆÉÈÄö‰ø°Áõ∏ÂÖ≥"></a>5.5 ÂÖ∂ÂÆÉÈÄö‰ø°Áõ∏ÂÖ≥</h2><p>‰ª•‰∏ä‰ªãÁªç‰∫Ü‰∏Ä‰∫õÁ∫øÁ®ãÈó¥ÈÄö‰ø°ÁöÑÂü∫Êú¨ÂéüÁêÜÂíåÊñπÊ≥ï„ÄÇÈô§Ê≠§‰ª•Â§ñÔºåËøòÊúâ‰∏Ä‰∫õ‰∏éÁ∫øÁ®ãÈÄö‰ø°Áõ∏ÂÖ≥ÁöÑÁü•ËØÜÁÇπÔºåËøôÈáå‰∏ÄÂπ∂‰ªãÁªç„ÄÇ</p>
<h3 id="5-5-1-joinÊñπÊ≥ï"><a href="#5-5-1-joinÊñπÊ≥ï" class="headerlink" title="5.5.1 joinÊñπÊ≥ï"></a>5.5.1 joinÊñπÊ≥ï</h3><p>join()ÊñπÊ≥ïÊòØThreadÁ±ªÁöÑ‰∏Ä‰∏™ÂÆû‰æãÊñπÊ≥ï„ÄÇÂÆÉÁöÑ‰ΩúÁî®ÊòØËÆ©ÂΩìÂâçÁ∫øÁ®ãÈô∑ÂÖ•‚ÄúÁ≠âÂæÖ‚ÄùÁä∂ÊÄÅÔºåÁ≠âjoinÁöÑËøô‰∏™Á∫øÁ®ãÊâßË°åÂÆåÊàêÂêéÔºåÂÜçÁªßÁª≠ÊâßË°åÂΩìÂâçÁ∫øÁ®ã„ÄÇ</p>
<p>ÊúâÊó∂ÂÄôÔºå‰∏ªÁ∫øÁ®ãÂàõÂª∫Âπ∂ÂêØÂä®‰∫ÜÂ≠êÁ∫øÁ®ãÔºåÂ¶ÇÊûúÂ≠êÁ∫øÁ®ã‰∏≠ÈúÄË¶ÅËøõË°åÂ§ßÈáèÁöÑËÄóÊó∂ËøêÁÆóÔºå‰∏ªÁ∫øÁ®ãÂæÄÂæÄÂ∞ÜÊó©‰∫éÂ≠êÁ∫øÁ®ãÁªìÊùü‰πãÂâçÁªìÊùü„ÄÇ</p>
<p>Â¶ÇÊûú‰∏ªÁ∫øÁ®ãÊÉ≥Á≠âÂæÖÂ≠êÁ∫øÁ®ãÊâßË°åÂÆåÊØïÂêéÔºåËé∑ÂæóÂ≠êÁ∫øÁ®ã‰∏≠ÁöÑÂ§ÑÁêÜÂÆåÁöÑÊüê‰∏™Êï∞ÊçÆÔºåÂ∞±Ë¶ÅÁî®Âà∞joinÊñπÊ≥ï‰∫Ü„ÄÇ</p>
<p>Á§∫‰æã‰ª£Á†ÅÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Join</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadA</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                System.out.println(<span class="hljs-string">&quot;ÊàëÊòØÂ≠êÁ∫øÁ®ãÔºåÊàëÂÖàÁù°‰∏ÄÁßí&quot;</span>);<br>                Thread.sleep(<span class="hljs-number">1000</span>);<br>                System.out.println(<span class="hljs-string">&quot;ÊàëÊòØÂ≠êÁ∫øÁ®ãÔºåÊàëÁù°ÂÆå‰∫Ü‰∏ÄÁßí&quot;</span>);<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadA</span>());<br>        thread.start();<br>        thread.join();<br>        System.out.println(<span class="hljs-string">&quot;Â¶ÇÊûú‰∏çÂä†joinÊñπÊ≥ïÔºåÊàë‰ºöÂÖàË¢´ÊâìÂá∫Êù•ÔºåÂä†‰∫ÜÂ∞±‰∏ç‰∏ÄÊ†∑‰∫Ü&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>



<blockquote>
<p>Ê≥®ÊÑèjoin()ÊñπÊ≥ïÊúâ‰∏§‰∏™ÈáçËΩΩÊñπÊ≥ïÔºå‰∏Ä‰∏™ÊòØjoin(long)Ôºå ‰∏Ä‰∏™ÊòØjoin(long, int)„ÄÇ</p>
<p>ÂÆûÈôÖ‰∏äÔºåÈÄöËøáÊ∫êÁ†Å‰Ω†‰ºöÂèëÁé∞Ôºåjoin()ÊñπÊ≥ïÂèäÂÖ∂ÈáçËΩΩÊñπÊ≥ïÂ∫ïÂ±ÇÈÉΩÊòØÂà©Áî®‰∫Üwait(long)Ëøô‰∏™ÊñπÊ≥ï„ÄÇ</p>
<p>ÂØπ‰∫éjoin(long, int)ÔºåÈÄöËøáÊü•ÁúãÊ∫êÁ†Å(JDK 1.8)ÂèëÁé∞ÔºåÂ∫ïÂ±ÇÂπ∂Ê≤°ÊúâÁ≤æÁ°ÆÂà∞Á∫≥ÁßíÔºåËÄåÊòØÂØπÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÂÅö‰∫ÜÁÆÄÂçïÁöÑÂà§Êñ≠ÂíåÂ§ÑÁêÜ„ÄÇ</p>
</blockquote>
<h3 id="5-5-2-sleepÊñπÊ≥ï"><a href="#5-5-2-sleepÊñπÊ≥ï" class="headerlink" title="5.5.2 sleepÊñπÊ≥ï"></a>5.5.2 sleepÊñπÊ≥ï</h3><p>sleepÊñπÊ≥ïÊòØThreadÁ±ªÁöÑ‰∏Ä‰∏™ÈùôÊÄÅÊñπÊ≥ï„ÄÇÂÆÉÁöÑ‰ΩúÁî®ÊòØËÆ©ÂΩìÂâçÁ∫øÁ®ãÁù°Áú†‰∏ÄÊÆµÊó∂Èó¥„ÄÇÂÆÉÊúâËøôÊ†∑‰∏§‰∏™ÊñπÊ≥ïÔºö</p>
<p>- </p>
<p>  Thread.sleep(long)</p>
<p>- </p>
<p>  Thread.sleep(long, int)</p>
<blockquote>
<p>ÂêåÊ†∑ÔºåÊü•ÁúãÊ∫êÁ†Å(JDK 1.8)ÂèëÁé∞ÔºåÁ¨¨‰∫å‰∏™ÊñπÊ≥ïË≤å‰ººÂè™ÂØπÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÂÅö‰∫ÜÁÆÄÂçïÁöÑÂ§ÑÁêÜÔºåÊ≤°ÊúâÁ≤æÁ°ÆÂà∞Á∫≥Áßí„ÄÇÂÆûÈôÖ‰∏äËøòÊòØË∞ÉÁî®ÁöÑÁ¨¨‰∏Ä‰∏™ÊñπÊ≥ï„ÄÇ</p>
</blockquote>
<p>ËøôÈáåÈúÄË¶ÅÂº∫Ë∞É‰∏Ä‰∏ãÔºö<strong>sleepÊñπÊ≥ïÊòØ‰∏ç‰ºöÈáäÊîæÂΩìÂâçÁöÑÈîÅÁöÑÔºåËÄåwaitÊñπÊ≥ï‰ºö„ÄÇ</strong>Ëøô‰πüÊòØÊúÄÂ∏∏ËßÅÁöÑ‰∏Ä‰∏™Â§öÁ∫øÁ®ãÈù¢ËØïÈ¢ò„ÄÇ</p>
<p>ÂÆÉ‰ª¨ËøòÊúâËøô‰∫õÂå∫Âà´Ôºö</p>
<p>- </p>
<p>  waitÂèØ‰ª•ÊåáÂÆöÊó∂Èó¥Ôºå‰πüÂèØ‰ª•‰∏çÊåáÂÆöÔºõËÄåsleepÂøÖÈ°ªÊåáÂÆöÊó∂Èó¥„ÄÇ</p>
<p>- </p>
<p>  waitÈáäÊîæcpuËµÑÊ∫êÔºåÂêåÊó∂ÈáäÊîæÈîÅÔºõsleepÈáäÊîæcpuËµÑÊ∫êÔºå‰ΩÜÊòØ‰∏çÈáäÊîæÈîÅÔºåÊâÄ‰ª•ÊòìÊ≠ªÈîÅ„ÄÇ</p>
<p>- </p>
<p>  waitÂøÖÈ°ªÊîæÂú®ÂêåÊ≠•ÂùóÊàñÂêåÊ≠•ÊñπÊ≥ï‰∏≠ÔºåËÄåsleepÂèØ‰ª•ÂÜç‰ªªÊÑè‰ΩçÁΩÆ</p>
<h3 id="5-5-3-ThreadLocalÁ±ª"><a href="#5-5-3-ThreadLocalÁ±ª" class="headerlink" title="5.5.3 ThreadLocalÁ±ª"></a>5.5.3 ThreadLocalÁ±ª</h3><p>ThreadLocalÊòØ‰∏Ä‰∏™Êú¨Âú∞Á∫øÁ®ãÂâØÊú¨ÂèòÈáèÂ∑•ÂÖ∑Á±ª„ÄÇÂÜÖÈÉ®ÊòØ‰∏Ä‰∏™<strong>Âº±ÂºïÁî®</strong>ÁöÑMapÊù•Áª¥Êä§„ÄÇËøôÈáå‰∏çËØ¶ÁªÜ‰ªãÁªçÂÆÉÁöÑÂéüÁêÜÔºåËÄåÊòØÂè™ÊòØ‰ªãÁªçÂÆÉÁöÑ‰ΩøÁî®Ôºå‰ª•ÂêéÊúâÁã¨Á´ãÁ´†ËäÇÊù•‰ªãÁªçThreadLocalÁ±ªÁöÑÂéüÁêÜ„ÄÇ</p>
<p>Êúâ‰∫õÊúãÂèãÁß∞ThreadLocal‰∏∫<strong>Á∫øÁ®ãÊú¨Âú∞ÂèòÈáè</strong>Êàñ<strong>Á∫øÁ®ãÊú¨Âú∞Â≠òÂÇ®</strong>„ÄÇ‰∏•Ê†ºÊù•ËØ¥ÔºåThreadLocalÁ±ªÂπ∂‰∏çÂ±û‰∫éÂ§öÁ∫øÁ®ãÈó¥ÁöÑÈÄö‰ø°ÔºåËÄåÊòØËÆ©ÊØè‰∏™Á∫øÁ®ãÊúâËá™Â∑±‚ÄùÁã¨Á´ã‚ÄúÁöÑÂèòÈáèÔºåÁ∫øÁ®ã‰πãÈó¥‰∫í‰∏çÂΩ±Âìç„ÄÇÂÆÉ‰∏∫ÊØè‰∏™Á∫øÁ®ãÈÉΩÂàõÂª∫‰∏Ä‰∏™<strong>ÂâØÊú¨</strong>ÔºåÊØè‰∏™Á∫øÁ®ãÂèØ‰ª•ËÆøÈóÆËá™Â∑±ÂÜÖÈÉ®ÁöÑÂâØÊú¨ÂèòÈáè„ÄÇ</p>
<p>ThreadLocalÁ±ªÊúÄÂ∏∏Áî®ÁöÑÂ∞±ÊòØsetÊñπÊ≥ïÂíågetÊñπÊ≥ï„ÄÇÁ§∫‰æã‰ª£Á†ÅÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadLocalDemo</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadA</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>        <span class="hljs-keyword">private</span> ThreadLocal&lt;String&gt; threadLocal;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">ThreadA</span><span class="hljs-params">(ThreadLocal&lt;String&gt; threadLocal)</span> &#123;<br>            <span class="hljs-built_in">this</span>.threadLocal = threadLocal;<br>        &#125;<br>    <br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            threadLocal.set(<span class="hljs-string">&quot;A&quot;</span>);<br>            <span class="hljs-keyword">try</span> &#123;<br>                Thread.sleep(<span class="hljs-number">1000</span>);<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>            System.out.println(<span class="hljs-string">&quot;ThreadAËæìÂá∫Ôºö&quot;</span> + threadLocal.get());<br>        &#125;<br>    <br>        <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadB</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>            <span class="hljs-keyword">private</span> ThreadLocal&lt;String&gt; threadLocal;<br>    <br>            <span class="hljs-keyword">public</span> <span class="hljs-title function_">ThreadB</span><span class="hljs-params">(ThreadLocal&lt;String&gt; threadLocal)</span> &#123;<br>                <span class="hljs-built_in">this</span>.threadLocal = threadLocal;<br>            &#125;<br>    <br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                threadLocal.set(<span class="hljs-string">&quot;B&quot;</span>);<br>                <span class="hljs-keyword">try</span> &#123;<br>                    Thread.sleep(<span class="hljs-number">1000</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>                System.out.println(<span class="hljs-string">&quot;ThreadBËæìÂá∫Ôºö&quot;</span> + threadLocal.get());<br>            &#125;<br>        &#125;<br>    <br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>            ThreadLocal&lt;String&gt; threadLocal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadA</span>(threadLocal)).start();<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadB</span>(threadLocal)).start();<br>        &#125;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-comment">// ËæìÂá∫Ôºö</span><br>ThreadAËæìÂá∫ÔºöA<br>ThreadBËæìÂá∫ÔºöB<br></code></pre></td></tr></table></figure>

<p>ÂèØ‰ª•ÁúãÂà∞ÔºåËôΩÁÑ∂‰∏§‰∏™Á∫øÁ®ã‰ΩøÁî®ÁöÑÂêå‰∏Ä‰∏™ThreadLocalÂÆû‰æãÔºàÈÄöËøáÊûÑÈÄ†ÊñπÊ≥ï‰º†ÂÖ•ÔºâÔºå‰ΩÜÊòØÂÆÉ‰ª¨ÂêÑËá™ÂèØ‰ª•Â≠òÂèñËá™Â∑±ÂΩìÂâçÁ∫øÁ®ãÁöÑ‰∏Ä‰∏™ÂÄº„ÄÇ</p>
<p>ÈÇ£ThreadLocalÊúâ‰ªÄ‰πà‰ΩúÁî®Âë¢ÔºüÂ¶ÇÊûúÂè™ÊòØÂçïÁ∫ØÁöÑÊÉ≥Ë¶ÅÁ∫øÁ®ãÈöîÁ¶ªÔºåÂú®ÊØè‰∏™Á∫øÁ®ã‰∏≠Â£∞Êòé‰∏Ä‰∏™ÁßÅÊúâÂèòÈáèÂ∞±Â•Ω‰∫ÜÂëÄÔºå‰∏∫‰ªÄ‰πàË¶Å‰ΩøÁî®ThreadLocalÔºü</p>
<p>Â¶ÇÊûúÂºÄÂèëËÄÖÂ∏åÊúõÂ∞ÜÁ±ªÁöÑÊüê‰∏™ÈùôÊÄÅÂèòÈáèÔºàuser IDÊàñËÄÖtransaction IDÔºâ‰∏éÁ∫øÁ®ãÁä∂ÊÄÅÂÖ≥ËÅîÔºåÂàôÂèØ‰ª•ËÄÉËôë‰ΩøÁî®ThreadLocal„ÄÇ</p>
<p>ÊúÄÂ∏∏ËßÅÁöÑThreadLocal‰ΩøÁî®Âú∫ÊôØ‰∏∫Áî®Êù•Ëß£ÂÜ≥Êï∞ÊçÆÂ∫ìËøûÊé•„ÄÅSessionÁÆ°ÁêÜÁ≠â„ÄÇÊï∞ÊçÆÂ∫ìËøûÊé•ÂíåSessionÁÆ°ÁêÜÊ∂âÂèäÂ§ö‰∏™Â§çÊùÇÂØπË±°ÁöÑÂàùÂßãÂåñÂíåÂÖ≥Èó≠„ÄÇÂ¶ÇÊûúÂú®ÊØè‰∏™Á∫øÁ®ã‰∏≠Â£∞Êòé‰∏Ä‰∫õÁßÅÊúâÂèòÈáèÊù•ËøõË°åÊìç‰ΩúÔºåÈÇ£Ëøô‰∏™Á∫øÁ®ãÂ∞±ÂèòÂæó‰∏çÈÇ£‰πà‚ÄúËΩªÈáè‚Äù‰∫ÜÔºåÈúÄË¶ÅÈ¢ëÁπÅÁöÑÂàõÂª∫ÂíåÂÖ≥Èó≠ËøûÊé•„ÄÇ</p>
<h3 id="5-5-4-InheritableThreadLocal"><a href="#5-5-4-InheritableThreadLocal" class="headerlink" title="5.5.4 InheritableThreadLocal"></a>5.5.4 InheritableThreadLocal</h3><p>InheritableThreadLocalÁ±ª‰∏éThreadLocalÁ±ªÁ®çÊúâ‰∏çÂêåÔºåInheritableÊòØÁªßÊâøÁöÑÊÑèÊÄù„ÄÇÂÆÉ‰∏ç‰ªÖ‰ªÖÊòØÂΩìÂâçÁ∫øÁ®ãÂèØ‰ª•Â≠òÂèñÂâØÊú¨ÂÄºÔºåËÄå‰∏îÂÆÉÁöÑÂ≠êÁ∫øÁ®ã‰πüÂèØ‰ª•Â≠òÂèñËøô‰∏™ÂâØÊú¨ÂÄº„ÄÇ</p>
<p><strong>ÂèÇËÄÉËµÑÊñô</strong></p>
<p>- </p>
<p>  JDK 1.8 Ê∫êÁ†Å</p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="http://ifeve.com/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E7%BA%BF%E7%A8%8B%E9%80%9A%E4%BF%A1/">Ê∑±ÂÖ•ÁêÜËß£Á∫øÁ®ãÈÄö‰ø°</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="https://www.cnblogs.com/hapjin/p/5492619.html">JAVAÂ§öÁ∫øÁ®ã‰πãÁ∫øÁ®ãÈó¥ÁöÑÈÄö‰ø°ÊñπÂºè</a></p>
<p>- </p>
<p>  <a target="_blank" rel="noopener" href="http://ifeve.com/thread-signaling/">Á∫øÁ®ãÈÄö‰ø°</a></p>
<h1 id="6-JavaÂÜÖÂ≠òÊ®°ÂûãÂü∫Á°ÄÁü•ËØÜ"><a href="#6-JavaÂÜÖÂ≠òÊ®°ÂûãÂü∫Á°ÄÁü•ËØÜ" class="headerlink" title="6 JavaÂÜÖÂ≠òÊ®°ÂûãÂü∫Á°ÄÁü•ËØÜ"></a>6 JavaÂÜÖÂ≠òÊ®°ÂûãÂü∫Á°ÄÁü•ËØÜ</h1><h2 id="6-1-Âπ∂ÂèëÁºñÁ®ãÊ®°ÂûãÁöÑ‰∏§‰∏™ÂÖ≥ÈîÆÈóÆÈ¢ò"><a href="#6-1-Âπ∂ÂèëÁºñÁ®ãÊ®°ÂûãÁöÑ‰∏§‰∏™ÂÖ≥ÈîÆÈóÆÈ¢ò" class="headerlink" title="6.1 Âπ∂ÂèëÁºñÁ®ãÊ®°ÂûãÁöÑ‰∏§‰∏™ÂÖ≥ÈîÆÈóÆÈ¢ò"></a>6.1 Âπ∂ÂèëÁºñÁ®ãÊ®°ÂûãÁöÑ‰∏§‰∏™ÂÖ≥ÈîÆÈóÆÈ¢ò</h2><ul>
<li><p>Á∫øÁ®ãÈó¥Â¶Ç‰ΩïÈÄö‰ø°ÔºüÂç≥ÔºöÁ∫øÁ®ã‰πãÈó¥‰ª•‰ΩïÁßçÊú∫Âà∂Êù•‰∫§Êç¢‰ø°ÊÅØ</p>
</li>
<li><p>Á∫øÁ®ãÈó¥Â¶Ç‰ΩïÂêåÊ≠•ÔºüÂç≥ÔºöÁ∫øÁ®ã‰ª•‰ΩïÁßçÊú∫Âà∂Êù•ÊéßÂà∂‰∏çÂêåÁ∫øÁ®ãÈó¥Êìç‰ΩúÂèëÁîüÁöÑÁõ∏ÂØπÈ°∫Â∫è</p>
</li>
</ul>
<p>Êúâ‰∏§ÁßçÂπ∂ÂèëÊ®°ÂûãÂèØ‰ª•Ëß£ÂÜ≥Ëøô‰∏§‰∏™ÈóÆÈ¢òÔºö</p>
<ul>
<li><p>Ê∂àÊÅØ‰º†ÈÄíÂπ∂ÂèëÊ®°Âûã</p>
</li>
<li><p>ÂÖ±‰∫´ÂÜÖÂ≠òÂπ∂ÂèëÊ®°Âûã</p>
</li>
</ul>
<p>Ëøô‰∏§ÁßçÊ®°Âûã‰πãÈó¥ÁöÑÂå∫Âà´Â¶Ç‰∏ãË°®ÊâÄÁ§∫Ôºö</p>
<p><img src="/Hexo/../img/202202202056330.png" srcset="/Hexo/img/loading.gif" lazyload></p>
<p><strong>Âú®Java‰∏≠Ôºå‰ΩøÁî®ÁöÑÊòØÂÖ±‰∫´ÂÜÖÂ≠òÂπ∂ÂèëÊ®°Âûã</strong>„ÄÇ</p>
<h2 id="6-2-JavaÂÜÖÂ≠òÊ®°ÂûãÁöÑÊäΩË±°ÁªìÊûÑ"><a href="#6-2-JavaÂÜÖÂ≠òÊ®°ÂûãÁöÑÊäΩË±°ÁªìÊûÑ" class="headerlink" title="6.2 JavaÂÜÖÂ≠òÊ®°ÂûãÁöÑÊäΩË±°ÁªìÊûÑ"></a>6.2 JavaÂÜÖÂ≠òÊ®°ÂûãÁöÑÊäΩË±°ÁªìÊûÑ</h2><h3 id="6-2-1-ËøêË°åÊó∂ÂÜÖÂ≠òÁöÑÂàíÂàÜ"><a href="#6-2-1-ËøêË°åÊó∂ÂÜÖÂ≠òÁöÑÂàíÂàÜ" class="headerlink" title="6.2.1  ËøêË°åÊó∂ÂÜÖÂ≠òÁöÑÂàíÂàÜ"></a>6.2.1  ËøêË°åÊó∂ÂÜÖÂ≠òÁöÑÂàíÂàÜ</h3><p>ÂÖàË∞à‰∏Ä‰∏ãËøêË°åÊó∂Êï∞ÊçÆÂå∫Ôºå‰∏ãÈù¢ËøôÂº†ÂõæÁõ∏‰ø°Â§ßÂÆ∂‰∏ÄÁÇπÈÉΩ‰∏çÈôåÁîüÔºö </p>
<p><img src="https://i0.hdslb.com/bfs/album/bff966ed2502c1e7a2d24991261581760b10e581.png" srcset="/Hexo/img/loading.gif" lazyload></p>
<p>ÂØπ‰∫éÊØè‰∏Ä‰∏™Á∫øÁ®ãÊù•ËØ¥ÔºåÊ†àÈÉΩÊòØÁßÅÊúâÁöÑÔºåËÄåÂ†ÜÊòØÂÖ±ÊúâÁöÑ„ÄÇ</p>
<p>‰πüÂ∞±ÊòØËØ¥Âú®Ê†à‰∏≠ÁöÑÂèòÈáèÔºàÂ±ÄÈÉ®ÂèòÈáè„ÄÅÊñπÊ≥ïÂÆö‰πâÂèÇÊï∞„ÄÅÂºÇÂ∏∏Â§ÑÁêÜÂô®ÂèÇÊï∞Ôºâ‰∏ç‰ºöÂú®Á∫øÁ®ã‰πãÈó¥ÂÖ±‰∫´Ôºå‰πüÂ∞±‰∏ç‰ºöÊúâ<font color='red'>ÂÜÖÂ≠òÂèØËßÅÊÄß</font>Ôºà‰∏ãÊñá‰ºöËØ¥Âà∞ÔºâÁöÑÈóÆÈ¢òÔºå‰πü‰∏çÂèóÂÜÖÂ≠òÊ®°ÂûãÁöÑÂΩ±Âìç„ÄÇËÄåÂú®Â†Ü‰∏≠ÁöÑÂèòÈáèÊòØÂÖ±‰∫´ÁöÑÔºåÊú¨ÊñáÁß∞‰∏∫ÂÖ±‰∫´ÂèòÈáè„ÄÇ</p>
<p>ÊâÄ‰ª•ÔºåÂÜÖÂ≠òÂèØËßÅÊÄßÊòØÈíàÂØπÁöÑ<strong>ÂÖ±‰∫´ÂèòÈáè</strong>„ÄÇ</p>
<h3 id="6-2-2-Êó¢ÁÑ∂Â†ÜÊòØÂÖ±‰∫´ÁöÑÔºå‰∏∫‰ªÄ‰πàÂú®Â†Ü‰∏≠‰ºöÊúâÂÜÖÂ≠ò‰∏çÂèØËßÅÈóÆÈ¢òÔºü"><a href="#6-2-2-Êó¢ÁÑ∂Â†ÜÊòØÂÖ±‰∫´ÁöÑÔºå‰∏∫‰ªÄ‰πàÂú®Â†Ü‰∏≠‰ºöÊúâÂÜÖÂ≠ò‰∏çÂèØËßÅÈóÆÈ¢òÔºü" class="headerlink" title="6.2.2 Êó¢ÁÑ∂Â†ÜÊòØÂÖ±‰∫´ÁöÑÔºå‰∏∫‰ªÄ‰πàÂú®Â†Ü‰∏≠‰ºöÊúâÂÜÖÂ≠ò‰∏çÂèØËßÅÈóÆÈ¢òÔºü"></a>6.2.2 Êó¢ÁÑ∂Â†ÜÊòØÂÖ±‰∫´ÁöÑÔºå‰∏∫‰ªÄ‰πàÂú®Â†Ü‰∏≠‰ºöÊúâÂÜÖÂ≠ò‰∏çÂèØËßÅÈóÆÈ¢òÔºü</h3><p>ËøôÊòØÂõ†‰∏∫Áé∞‰ª£ËÆ°ÁÆóÊú∫‰∏∫‰∫ÜÈ´òÊïàÔºåÂæÄÂæÄ‰ºöÂú®È´òÈÄüÁºìÂ≠òÂå∫‰∏≠ÁºìÂ≠òÂÖ±‰∫´ÂèòÈáèÔºåÂõ†‰∏∫cpuËÆøÈóÆÁºìÂ≠òÂå∫ÊØîËÆøÈóÆÂÜÖÂ≠òË¶ÅÂø´ÂæóÂ§ö„ÄÇ</p>
<blockquote>
<p>Á∫øÁ®ã‰πãÈó¥ÁöÑÂÖ±‰∫´ÂèòÈáèÂ≠òÂú®‰∏ªÂÜÖÂ≠ò‰∏≠ÔºåÊØè‰∏™Á∫øÁ®ãÈÉΩÊúâ‰∏Ä‰∏™ÁßÅÊúâÁöÑÊú¨Âú∞ÂÜÖÂ≠òÔºåÂ≠òÂÇ®‰∫ÜËØ•Á∫øÁ®ã‰ª•ËØª„ÄÅÂÜôÂÖ±‰∫´ÂèòÈáèÁöÑÂâØÊú¨„ÄÇÊú¨Âú∞ÂÜÖÂ≠òÊòØJavaÂÜÖÂ≠òÊ®°ÂûãÁöÑ‰∏Ä‰∏™ÊäΩË±°Ê¶ÇÂøµÔºåÂπ∂‰∏çÁúüÂÆûÂ≠òÂú®„ÄÇÂÆÉÊ∂µÁõñ‰∫ÜÁºìÂ≠ò„ÄÅÂÜôÁºìÂÜ≤Âå∫„ÄÅÂØÑÂ≠òÂô®Á≠â„ÄÇ</p>
</blockquote>
<p>JavaÁ∫øÁ®ã‰πãÈó¥ÁöÑÈÄö‰ø°Áî±JavaÂÜÖÂ≠òÊ®°ÂûãÔºàÁÆÄÁß∞JMMÔºâÊéßÂà∂Ôºå‰ªéÊäΩË±°ÁöÑËßíÂ∫¶Êù•ËØ¥ÔºåJMMÂÆö‰πâ‰∫ÜÁ∫øÁ®ãÂíå‰∏ªÂÜÖÂ≠ò‰πãÈó¥ÁöÑÊäΩË±°ÂÖ≥Á≥ª„ÄÇJMMÁöÑÊäΩË±°Á§∫ÊÑèÂõæÂ¶ÇÂõæÊâÄÁ§∫Ôºö</p>
<p><img src="https://i0.hdslb.com/bfs/album/160efb4d935c825f7f891f230b31e20ea35aee57.jpg" srcset="/Hexo/img/loading.gif" lazyload></p>
<p>image</p>
<p>‰ªéÂõæ‰∏≠ÂèØ‰ª•ÁúãÂá∫Ôºö 1. ÊâÄÊúâÁöÑÂÖ±‰∫´ÂèòÈáèÈÉΩÂ≠òÂú®‰∏ªÂÜÖÂ≠ò‰∏≠„ÄÇ 2. ÊØè‰∏™Á∫øÁ®ãÈÉΩ‰øùÂ≠ò‰∫Ü‰∏Ä‰ªΩËØ•Á∫øÁ®ã‰ΩøÁî®Âà∞ÁöÑÂÖ±‰∫´ÂèòÈáèÁöÑÂâØÊú¨„ÄÇ 3. Â¶ÇÊûúÁ∫øÁ®ãA‰∏éÁ∫øÁ®ãB‰πãÈó¥Ë¶ÅÈÄö‰ø°ÁöÑËØùÔºåÂøÖÈ°ªÁªèÂéÜ‰∏ãÈù¢2‰∏™Ê≠•È™§Ôºö 1. Á∫øÁ®ãAÂ∞ÜÊú¨Âú∞ÂÜÖÂ≠òA‰∏≠Êõ¥Êñ∞ËøáÁöÑÂÖ±‰∫´ÂèòÈáèÂà∑Êñ∞Âà∞‰∏ªÂÜÖÂ≠ò‰∏≠Âéª„ÄÇ 2. Á∫øÁ®ãBÂà∞‰∏ªÂÜÖÂ≠ò‰∏≠ÂéªËØªÂèñÁ∫øÁ®ãA‰πãÂâçÂ∑≤ÁªèÊõ¥Êñ∞ËøáÁöÑÂÖ±‰∫´ÂèòÈáè„ÄÇ</p>
<p><strong>ÊâÄ‰ª•ÔºåÁ∫øÁ®ãAÊó†Ê≥ïÁõ¥Êé•ËÆøÈóÆÁ∫øÁ®ãBÁöÑÂ∑•‰ΩúÂÜÖÂ≠òÔºåÁ∫øÁ®ãÈó¥ÈÄö‰ø°ÂøÖÈ°ªÁªèËøá‰∏ªÂÜÖÂ≠ò„ÄÇ</strong></p>
<p>Ê≥®ÊÑèÔºåÊ†πÊçÆJMMÁöÑËßÑÂÆöÔºå<strong>Á∫øÁ®ãÂØπÂÖ±‰∫´ÂèòÈáèÁöÑÊâÄÊúâÊìç‰ΩúÈÉΩÂøÖÈ°ªÂú®Ëá™Â∑±ÁöÑÊú¨Âú∞ÂÜÖÂ≠ò‰∏≠ËøõË°åÔºå‰∏çËÉΩÁõ¥Êé•‰ªé‰∏ªÂÜÖÂ≠ò‰∏≠ËØªÂèñ</strong>„ÄÇ</p>
<p>ÊâÄ‰ª•Á∫øÁ®ãBÂπ∂‰∏çÊòØÁõ¥Êé•Âéª‰∏ªÂÜÖÂ≠ò‰∏≠ËØªÂèñÂÖ±‰∫´ÂèòÈáèÁöÑÂÄºÔºåËÄåÊòØÂÖàÂú®Êú¨Âú∞ÂÜÖÂ≠òB‰∏≠ÊâæÂà∞Ëøô‰∏™ÂÖ±‰∫´ÂèòÈáèÔºåÂèëÁé∞Ëøô‰∏™ÂÖ±‰∫´ÂèòÈáèÂ∑≤ÁªèË¢´Êõ¥Êñ∞‰∫ÜÔºåÁÑ∂ÂêéÊú¨Âú∞ÂÜÖÂ≠òBÂéª‰∏ªÂÜÖÂ≠ò‰∏≠ËØªÂèñËøô‰∏™ÂÖ±‰∫´ÂèòÈáèÁöÑÊñ∞ÂÄºÔºåÂπ∂Êã∑Ë¥ùÂà∞Êú¨Âú∞ÂÜÖÂ≠òB‰∏≠ÔºåÊúÄÂêéÁ∫øÁ®ãBÂÜçËØªÂèñÊú¨Âú∞ÂÜÖÂ≠òB‰∏≠ÁöÑÊñ∞ÂÄº„ÄÇ</p>
<p>ÈÇ£‰πàÊÄé‰πàÁü•ÈÅìËøô‰∏™ÂÖ±‰∫´ÂèòÈáèÁöÑË¢´ÂÖ∂‰ªñÁ∫øÁ®ãÊõ¥Êñ∞‰∫ÜÂë¢ÔºüËøôÂ∞±ÊòØJMMÁöÑÂäüÂä≥‰∫ÜÔºå‰πüÊòØJMMÂ≠òÂú®ÁöÑÂøÖË¶ÅÊÄß‰πã‰∏Ä„ÄÇ<strong>JMMÈÄöËøáÊéßÂà∂‰∏ªÂÜÖÂ≠ò‰∏éÊØè‰∏™Á∫øÁ®ãÁöÑÊú¨Âú∞ÂÜÖÂ≠ò‰πãÈó¥ÁöÑ‰∫§‰∫íÔºåÊù•Êèê‰æõÂÜÖÂ≠òÂèØËßÅÊÄß‰øùËØÅ</strong>„ÄÇ</p>
<blockquote>
<p>Java‰∏≠ÁöÑvolatileÂÖ≥ÈîÆÂ≠óÂèØ‰ª•‰øùËØÅÂ§öÁ∫øÁ®ãÊìç‰ΩúÂÖ±‰∫´ÂèòÈáèÁöÑÂèØËßÅÊÄß‰ª•ÂèäÁ¶ÅÊ≠¢Êåá‰ª§ÈáçÊéíÂ∫èÔºåsynchronizedÂÖ≥ÈîÆÂ≠ó‰∏ç‰ªÖ‰øùËØÅÂèØËßÅÊÄßÔºåÂêåÊó∂‰πü‰øùËØÅ‰∫ÜÂéüÂ≠êÊÄßÔºà‰∫íÊñ•ÊÄßÔºâ„ÄÇÂú®Êõ¥Â∫ïÂ±ÇÔºåJMMÈÄöËøáÂÜÖÂ≠òÂ±èÈöúÊù•ÂÆûÁé∞ÂÜÖÂ≠òÁöÑÂèØËßÅÊÄß‰ª•ÂèäÁ¶ÅÊ≠¢ÈáçÊéíÂ∫è„ÄÇ‰∏∫‰∫ÜÁ®ãÂ∫èÂëòÁöÑÊñπ‰æøÁêÜËß£ÔºåÊèêÂá∫‰∫Ühappens-beforeÔºåÂÆÉÊõ¥Âä†ÁöÑÁÆÄÂçïÊòìÊáÇÔºå‰ªéËÄåÈÅøÂÖç‰∫ÜÁ®ãÂ∫èÂëò‰∏∫‰∫ÜÁêÜËß£ÂÜÖÂ≠òÂèØËßÅÊÄßËÄåÂéªÂ≠¶‰π†Â§çÊùÇÁöÑÈáçÊéíÂ∫èËßÑÂàô‰ª•ÂèäËøô‰∫õËßÑÂàôÁöÑÂÖ∑‰ΩìÂÆûÁé∞ÊñπÊ≥ï„ÄÇËøôÈáåÊ∂âÂèäÂà∞ÁöÑÊâÄÊúâÂÜÖÂÆπÂêéÈù¢ÈÉΩ‰ºöÊúâ‰∏ìÈó®ÁöÑÁ´†ËäÇ‰ªãÁªç„ÄÇ</p>
</blockquote>
<h3 id="6-2-3-JMM‰∏éJavaÂÜÖÂ≠òÂå∫ÂüüÂàíÂàÜÁöÑÂå∫Âà´‰∏éËÅîÁ≥ª"><a href="#6-2-3-JMM‰∏éJavaÂÜÖÂ≠òÂå∫ÂüüÂàíÂàÜÁöÑÂå∫Âà´‰∏éËÅîÁ≥ª" class="headerlink" title="6.2.3 JMM‰∏éJavaÂÜÖÂ≠òÂå∫ÂüüÂàíÂàÜÁöÑÂå∫Âà´‰∏éËÅîÁ≥ª"></a>6.2.3 JMM‰∏éJavaÂÜÖÂ≠òÂå∫ÂüüÂàíÂàÜÁöÑÂå∫Âà´‰∏éËÅîÁ≥ª</h3><p>‰∏äÈù¢‰∏§Â∞èËäÇÂàÜÂà´ÊèêÂà∞‰∫ÜJMMÂíåJavaËøêË°åÊó∂ÂÜÖÂ≠òÂå∫ÂüüÁöÑÂàíÂàÜÔºåËøô‰∏§ËÄÖÊó¢ÊúâÂ∑ÆÂà´ÂèàÊúâËÅîÁ≥ªÔºö</p>
<p>- </p>
<p>  Âå∫Âà´</p>
<p>  ‰∏§ËÄÖÊòØ‰∏çÂêåÁöÑÊ¶ÇÂøµÂ±ÇÊ¨°„ÄÇJMMÊòØÊäΩË±°ÁöÑÔºå‰ªñÊòØÁî®Êù•ÊèèËø∞‰∏ÄÁªÑËßÑÂàôÔºåÈÄöËøáËøô‰∏™ËßÑÂàôÊù•ÊéßÂà∂ÂêÑ‰∏™ÂèòÈáèÁöÑËÆøÈóÆÊñπÂºèÔºåÂõ¥ÁªïÂéüÂ≠êÊÄß„ÄÅÊúâÂ∫èÊÄß„ÄÅÂèØËßÅÊÄßÁ≠âÂ±ïÂºÄÁöÑ„ÄÇËÄåJavaËøêË°åÊó∂ÂÜÖÂ≠òÁöÑÂàíÂàÜÊòØÂÖ∑‰ΩìÁöÑÔºåÊòØJVMËøêË°åJavaÁ®ãÂ∫èÊó∂ÔºåÂøÖË¶ÅÁöÑÂÜÖÂ≠òÂàíÂàÜ„ÄÇ</p>
<p>- </p>
<p>  ËÅîÁ≥ª</p>
<p>  ÈÉΩÂ≠òÂú®ÁßÅÊúâÊï∞ÊçÆÂå∫ÂüüÂíåÂÖ±‰∫´Êï∞ÊçÆÂå∫Âüü„ÄÇ‰∏ÄËà¨Êù•ËØ¥ÔºåJMM‰∏≠ÁöÑ‰∏ªÂÜÖÂ≠òÂ±û‰∫éÂÖ±‰∫´Êï∞ÊçÆÂå∫ÂüüÔºå‰ªñÊòØÂåÖÂê´‰∫ÜÂ†ÜÂíåÊñπÊ≥ïÂå∫ÔºõÂêåÊ†∑ÔºåJMM‰∏≠ÁöÑÊú¨Âú∞ÂÜÖÂ≠òÂ±û‰∫éÁßÅÊúâÊï∞ÊçÆÂå∫ÂüüÔºåÂåÖÂê´‰∫ÜÁ®ãÂ∫èËÆ°Êï∞Âô®„ÄÅÊú¨Âú∞ÊñπÊ≥ïÊ†à„ÄÅËôöÊãüÊú∫Ê†à„ÄÇ</p>
<p><strong>ÂÆûÈôÖ‰∏äÔºå‰ªñ‰ª¨Ë°®ËææÁöÑÊòØÂêå‰∏ÄÁßçÂê´‰πâÔºåËøôÈáå‰∏çÂÅöÂå∫ÂàÜ„ÄÇ</strong></p>
<p><strong>ÂèÇËÄÉËµÑÊñô</strong></p>
<ul>
<li>„ÄäJavaÂπ∂ÂèëÁºñÁ®ãÁöÑËâ∫ÊúØ„Äã</li>
<li>„ÄäÂÆûÊàòJavaÈ´òÂπ∂ÂèëÁ®ãÂ∫èËÆæËÆ°„Äã</li>
</ul>
<h1 id="7-ÈáçÊéíÂ∫è‰∏éhappens-before"><a href="#7-ÈáçÊéíÂ∫è‰∏éhappens-before" class="headerlink" title="7 ÈáçÊéíÂ∫è‰∏éhappens-before"></a>7 ÈáçÊéíÂ∫è‰∏éhappens-before</h1><h2 id="7-1-‰ªÄ‰πàÊòØÈáçÊéíÂ∫èÔºü"><a href="#7-1-‰ªÄ‰πàÊòØÈáçÊéíÂ∫èÔºü" class="headerlink" title="7.1 ‰ªÄ‰πàÊòØÈáçÊéíÂ∫èÔºü"></a>7.1 ‰ªÄ‰πàÊòØÈáçÊéíÂ∫èÔºü</h2><p>ËÆ°ÁÆóÊú∫Âú®ÊâßË°åÁ®ãÂ∫èÊó∂Ôºå‰∏∫‰∫ÜÊèêÈ´òÊÄßËÉΩÔºåÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®Â∏∏Â∏∏‰ºöÂØπÊåá‰ª§ÂÅöÈáçÊéí„ÄÇ</p>
<p><strong>‰∏∫‰ªÄ‰πàÊåá‰ª§ÈáçÊéíÂ∫èÂèØ‰ª•ÊèêÈ´òÊÄßËÉΩÔºü</strong></p>
<p>ÁÆÄÂçïÂú∞ËØ¥ÔºåÊØè‰∏Ä‰∏™Êåá‰ª§ÈÉΩ‰ºöÂåÖÂê´Â§ö‰∏™Ê≠•È™§ÔºåÊØè‰∏™Ê≠•È™§ÂèØËÉΩ‰ΩøÁî®‰∏çÂêåÁöÑÁ°¨‰ª∂„ÄÇÂõ†Ê≠§Ôºå<strong>ÊµÅÊ∞¥Á∫øÊäÄÊúØ</strong>‰∫ßÁîü‰∫ÜÔºåÂÆÉÁöÑÂéüÁêÜÊòØÊåá‰ª§1ËøòÊ≤°ÊúâÊâßË°åÂÆåÔºåÂ∞±ÂèØ‰ª•ÂºÄÂßãÊâßË°åÊåá‰ª§2ÔºåËÄå‰∏çÁî®Á≠âÂà∞Êåá‰ª§1ÊâßË°åÁªìÊùü‰πãÂêéÂÜçÊâßË°åÊåá‰ª§2ÔºåËøôÊ†∑Â∞±Â§ßÂ§ßÊèêÈ´ò‰∫ÜÊïàÁéá„ÄÇ</p>
<p>‰ΩÜÊòØÔºåÊµÅÊ∞¥Á∫øÊäÄÊúØÊúÄÂÆ≥ÊÄï<strong>‰∏≠Êñ≠</strong>ÔºåÊÅ¢Â§ç‰∏≠Êñ≠ÁöÑ‰ª£‰ª∑ÊòØÊØîËæÉÂ§ßÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÊÉ≥Â∞ΩÂäûÊ≥ï‰∏çËÆ©ÊµÅÊ∞¥Á∫ø‰∏≠Êñ≠„ÄÇÊåá‰ª§ÈáçÊéíÂ∞±ÊòØÂáèÂ∞ë‰∏≠Êñ≠ÁöÑ‰∏ÄÁßçÊäÄÊúØ„ÄÇ</p>
<p>Êàë‰ª¨ÂàÜÊûê‰∏Ä‰∏ã‰∏ãÈù¢Ëøô‰∏™‰ª£Á†ÅÁöÑÊâßË°åÊÉÖÂÜµÔºö</p>
<p>a &#x3D; b + c;</p>
<p>d &#x3D; e - f ;</p>
<p>ÂÖàÂä†ËΩΩb„ÄÅcÔºà<strong>Ê≥®ÊÑèÔºåÂç≥ÊúâÂèØËÉΩÂÖàÂä†ËΩΩbÔºå‰πüÊúâÂèØËÉΩÂÖàÂä†ËΩΩc</strong>ÔºâÔºå‰ΩÜÊòØÂú®ÊâßË°åadd(b,c)ÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÁ≠âÂæÖb„ÄÅcË£ÖËΩΩÁªìÊùüÊâçËÉΩÁªßÁª≠ÊâßË°åÔºå‰πüÂ∞±ÊòØÂ¢ûÂä†‰∫ÜÂÅúÈ°øÔºåÈÇ£‰πàÂêéÈù¢ÁöÑÊåá‰ª§‰πü‰ºö‰æùÊ¨°ÊúâÂÅúÈ°ø,ËøôÈôç‰Ωé‰∫ÜËÆ°ÁÆóÊú∫ÁöÑÊâßË°åÊïàÁéá„ÄÇ</p>
<p>‰∏∫‰∫ÜÂáèÂ∞ëËøô‰∏™ÂÅúÈ°øÔºåÊàë‰ª¨ÂèØ‰ª•ÂÖàÂä†ËΩΩeÂíåf,ÁÑ∂ÂêéÂÜçÂéªÂä†ËΩΩadd(b,c),ËøôÊ†∑ÂÅöÂØπÁ®ãÂ∫èÔºà‰∏≤Ë°åÔºâÊòØÊ≤°ÊúâÂΩ±ÂìçÁöÑ,‰ΩÜÂç¥ÂáèÂ∞ë‰∫ÜÂÅúÈ°ø„ÄÇÊó¢ÁÑ∂add(b,c)ÈúÄË¶ÅÂÅúÈ°øÔºåÈÇ£Ëøò‰∏çÂ¶ÇÂéªÂÅö‰∏Ä‰∫õÊúâÊÑè‰πâÁöÑ‰∫ãÊÉÖ„ÄÇ</p>
<p>Áªº‰∏äÊâÄËø∞Ôºå<strong>Êåá‰ª§ÈáçÊéíÂØπ‰∫éÊèêÈ´òCPUÂ§ÑÁêÜÊÄßËÉΩÂçÅÂàÜÂøÖË¶Å„ÄÇËôΩÁÑ∂Áî±Ê≠§Â∏¶Êù•‰∫Ü‰π±Â∫èÁöÑÈóÆÈ¢òÔºå‰ΩÜÊòØËøôÁÇπÁâ∫Áâ≤ÊòØÂÄºÂæóÁöÑ„ÄÇ</strong></p>
<p>Êåá‰ª§ÈáçÊéí‰∏ÄËà¨ÂàÜ‰∏∫‰ª•‰∏ã‰∏âÁßçÔºö</p>
<ul>
<li><p><strong>ÁºñËØëÂô®‰ºòÂåñÈáçÊéí</strong></p>
<p>ÁºñËØëÂô®Âú®<strong>‰∏çÊîπÂèòÂçïÁ∫øÁ®ãÁ®ãÂ∫èËØ≠‰πâ</strong>ÁöÑÂâçÊèê‰∏ãÔºåÂèØ‰ª•ÈáçÊñ∞ÂÆâÊéíËØ≠Âè•ÁöÑÊâßË°åÈ°∫Â∫è„ÄÇ</p>
</li>
<li><p><strong>Êåá‰ª§Âπ∂Ë°åÈáçÊéí</strong></p>
<p>Áé∞‰ª£Â§ÑÁêÜÂô®ÈááÁî®‰∫ÜÊåá‰ª§Á∫ßÂπ∂Ë°åÊäÄÊúØÊù•Â∞ÜÂ§öÊù°Êåá‰ª§ÈáçÂè†ÊâßË°å„ÄÇÂ¶ÇÊûú<strong>‰∏çÂ≠òÂú®Êï∞ÊçÆ‰æùËµñÊÄß</strong>(Âç≥Âêé‰∏Ä‰∏™ÊâßË°åÁöÑËØ≠Âè•Êó†ÈúÄ‰æùËµñÂâçÈù¢ÊâßË°åÁöÑËØ≠Âè•ÁöÑÁªìÊûú)ÔºåÂ§ÑÁêÜÂô®ÂèØ‰ª•ÊîπÂèòËØ≠Âè•ÂØπÂ∫îÁöÑÊú∫Âô®Êåá‰ª§ÁöÑÊâßË°åÈ°∫Â∫è„ÄÇ</p>
</li>
<li><p><strong>ÂÜÖÂ≠òÁ≥ªÁªüÈáçÊéí</strong></p>
<p>Áî±‰∫éÂ§ÑÁêÜÂô®‰ΩøÁî®ÁºìÂ≠òÂíåËØªÂÜôÁºìÂ≠òÂÜ≤Âå∫ÔºåËøô‰ΩøÂæóÂä†ËΩΩ(load)ÂíåÂ≠òÂÇ®(store)Êìç‰ΩúÁúã‰∏äÂéªÂèØËÉΩÊòØÂú®‰π±Â∫èÊâßË°åÔºåÂõ†‰∏∫‰∏âÁ∫ßÁºìÂ≠òÁöÑÂ≠òÂú®ÔºåÂØºËá¥ÂÜÖÂ≠ò‰∏éÁºìÂ≠òÁöÑÊï∞ÊçÆÂêåÊ≠•Â≠òÂú®Êó∂Èó¥Â∑Æ„ÄÇ</p>
</li>
</ul>
<p><strong>Êåá‰ª§ÈáçÊéíÂèØ‰ª•‰øùËØÅ‰∏≤Ë°åËØ≠‰πâ‰∏ÄËá¥Ôºå‰ΩÜÊòØÊ≤°Êúâ‰πâÂä°‰øùËØÅÂ§öÁ∫øÁ®ãÈó¥ÁöÑËØ≠‰πâ‰πü‰∏ÄËá¥</strong>„ÄÇÊâÄ‰ª•Âú®Â§öÁ∫øÁ®ã‰∏ãÔºåÊåá‰ª§ÈáçÊéíÂ∫èÂèØËÉΩ‰ºöÂØºËá¥‰∏Ä‰∫õÈóÆÈ¢ò„ÄÇ</p>
<h2 id="7-2-È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã‰∏éJMMÁöÑ‰øùËØÅ"><a href="#7-2-È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã‰∏éJMMÁöÑ‰øùËØÅ" class="headerlink" title="7.2 È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã‰∏éJMMÁöÑ‰øùËØÅ"></a>7.2 È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã‰∏éJMMÁöÑ‰øùËØÅ</h2><p>È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°ÂûãÊòØ‰∏Ä‰∏™<strong>ÁêÜËÆ∫ÂèÇËÄÉÊ®°Âûã</strong>ÔºåÂÜÖÂ≠òÊ®°ÂûãÂú®ËÆæËÆ°ÁöÑÊó∂ÂÄôÈÉΩ‰ºö‰ª•È°∫Â∫è‰∏ÄËá¥ÊÄßÂÜÖÂ≠òÊ®°Âûã‰Ωú‰∏∫ÂèÇËÄÉ„ÄÇ</p>
<h3 id="7-2-1-Êï∞ÊçÆÁ´û‰∫â‰∏éÈ°∫Â∫è‰∏ÄËá¥ÊÄß"><a href="#7-2-1-Êï∞ÊçÆÁ´û‰∫â‰∏éÈ°∫Â∫è‰∏ÄËá¥ÊÄß" class="headerlink" title="7.2.1 Êï∞ÊçÆÁ´û‰∫â‰∏éÈ°∫Â∫è‰∏ÄËá¥ÊÄß"></a>7.2.1 Êï∞ÊçÆÁ´û‰∫â‰∏éÈ°∫Â∫è‰∏ÄËá¥ÊÄß</h3><p>ÂΩìÁ®ãÂ∫èÊú™Ê≠£Á°ÆÂêåÊ≠•ÁöÑÊó∂ÂÄôÔºåÂ∞±ÂèØËÉΩÂ≠òÂú®Êï∞ÊçÆÁ´û‰∫â„ÄÇ</p>
<blockquote>
<p>Êï∞ÊçÆÁ´û‰∫âÔºöÂú®‰∏Ä‰∏™Á∫øÁ®ã‰∏≠ÂÜô‰∏Ä‰∏™ÂèòÈáèÔºåÂú®Âè¶‰∏Ä‰∏™Á∫øÁ®ãËØªÂêå‰∏Ä‰∏™ÂèòÈáèÔºåÂπ∂‰∏îÂÜôÂíåËØªÊ≤°ÊúâÈÄöËøáÂêåÊ≠•Êù•ÊéíÂ∫è„ÄÇ</p>
</blockquote>
<p>Â¶ÇÊûúÁ®ãÂ∫è‰∏≠ÂåÖÂê´‰∫ÜÊï∞ÊçÆÁ´û‰∫âÔºåÈÇ£‰πàËøêË°åÁöÑÁªìÊûúÂæÄÂæÄÂÖÖÊª°‰∫Ü<strong>‰∏çÁ°ÆÂÆöÊÄß</strong>ÔºåÊØîÂ¶ÇËØªÂèëÁîüÂú®‰∫ÜÂÜô‰πãÂâçÔºåÂèØËÉΩÂ∞±‰ºöËØªÂà∞ÈîôËØØÁöÑÂÄºÔºõÂ¶ÇÊûú‰∏Ä‰∏™Á∫øÁ®ãÁ®ãÂ∫èËÉΩÂ§üÊ≠£Á°ÆÂêåÊ≠•ÔºåÈÇ£‰πàÂ∞±‰∏çÂ≠òÂú®Êï∞ÊçÆÁ´û‰∫â„ÄÇ</p>
<p>JavaÂÜÖÂ≠òÊ®°ÂûãÔºàJMMÔºâÂØπ‰∫éÊ≠£Á°ÆÂêåÊ≠•Â§öÁ∫øÁ®ãÁ®ãÂ∫èÁöÑÂÜÖÂ≠ò‰∏ÄËá¥ÊÄßÂÅö‰∫Ü‰ª•‰∏ã‰øùËØÅÔºö</p>
<blockquote>
<p><strong>Â¶ÇÊûúÁ®ãÂ∫èÊòØÊ≠£Á°ÆÂêåÊ≠•ÁöÑÔºåÁ®ãÂ∫èÁöÑÊâßË°åÂ∞ÜÂÖ∑ÊúâÈ°∫Â∫è‰∏ÄËá¥ÊÄß</strong>„ÄÇ Âç≥Á®ãÂ∫èÁöÑÊâßË°åÁªìÊûúÂíåËØ•Á®ãÂ∫èÂú®È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã‰∏≠ÊâßË°åÁöÑÁªìÊûúÁõ∏Âêå„ÄÇ</p>
</blockquote>
<p>ËøôÈáåÁöÑÂêåÊ≠•ÂåÖÊã¨‰∫Ü‰ΩøÁî®<code>volatile</code>„ÄÅ<code>final</code>„ÄÅ<code>synchronized</code>Á≠âÂÖ≥ÈîÆÂ≠óÊù•ÂÆûÁé∞<strong>Â§öÁ∫øÁ®ã‰∏ãÁöÑÂêåÊ≠•</strong>„ÄÇ</p>
<p>Â¶ÇÊûúÁ®ãÂ∫èÂëòÊ≤°ÊúâÊ≠£Á°Æ‰ΩøÁî®<code>volatile</code>„ÄÅ<code>final</code>„ÄÅ<code>synchronized</code>ÔºåÈÇ£‰πàÂç≥‰æøÊòØ‰ΩøÁî®‰∫ÜÂêåÊ≠•ÔºàÂçïÁ∫øÁ®ã‰∏ãÁöÑÂêåÊ≠•ÔºâÔºåJMM‰πü‰∏ç‰ºöÊúâÂÜÖÂ≠òÂèØËßÅÊÄßÁöÑ‰øùËØÅÔºåÂèØËÉΩ‰ºöÂØºËá¥‰Ω†ÁöÑÁ®ãÂ∫èÂá∫ÈîôÔºåÂπ∂‰∏îÂÖ∑Êúâ‰∏çÂèØÈáçÁé∞ÊÄßÔºåÂæàÈöæÊéíÊü•„ÄÇ</p>
<p>ÊâÄ‰ª•Â¶Ç‰ΩïÊ≠£Á°Æ‰ΩøÁî®<code>volatile</code>„ÄÅ<code>final</code>„ÄÅ<code>synchronized</code>ÔºåÊòØÁ®ãÂ∫èÂëòÂ∫îËØ•Âéª‰∫ÜËß£ÁöÑ„ÄÇÂêéÈù¢‰ºöÊúâ‰∏ìÈó®ÁöÑÁ´†ËäÇ‰ªãÁªçËøôÂá†‰∏™ÂÖ≥ÈîÆÂ≠óÁöÑÂÜÖÂ≠òËØ≠‰πâÂèä‰ΩøÁî®„ÄÇ</p>
<h3 id="7-2-2-È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã"><a href="#7-2-2-È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã" class="headerlink" title="7.2.2 È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã"></a>7.2.2 È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã</h3><p>È°∫Â∫è‰∏ÄËá¥ÊÄßÂÜÖÂ≠òÊ®°ÂûãÊòØ‰∏Ä‰∏™<strong>ÁêÜÊÉ≥ÂåñÁöÑÁêÜËÆ∫ÂèÇËÄÉÊ®°Âûã</strong>ÔºåÂÆÉ‰∏∫Á®ãÂ∫èÂëòÊèê‰æõ‰∫ÜÊûÅÂº∫ÁöÑÂÜÖÂ≠òÂèØËßÅÊÄß‰øùËØÅ„ÄÇ</p>
<p>È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°ÂûãÊúâ‰∏§Â§ßÁâπÊÄßÔºö</p>
<ul>
<li>‰∏Ä‰∏™Á∫øÁ®ã‰∏≠ÁöÑÊâÄÊúâÊìç‰ΩúÂøÖÈ°ªÊåâÁÖßÁ®ãÂ∫èÁöÑÈ°∫Â∫èÔºàÂç≥Java‰ª£Á†ÅÁöÑÈ°∫Â∫èÔºâÊù•ÊâßË°å„ÄÇ</li>
<li>‰∏çÁÆ°Á®ãÂ∫èÊòØÂê¶ÂêåÊ≠•ÔºåÊâÄÊúâÁ∫øÁ®ãÈÉΩÂè™ËÉΩÁúãÂà∞‰∏Ä‰∏™Âçï‰∏ÄÁöÑÊìç‰ΩúÊâßË°åÈ°∫Â∫è„ÄÇÂç≥Âú®È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã‰∏≠ÔºåÊØè‰∏™Êìç‰ΩúÂøÖÈ°ªÊòØ<strong>ÂéüÂ≠êÊÄßÁöÑÔºå‰∏îÁ´ãÂàªÂØπÊâÄÊúâÁ∫øÁ®ãÂèØËßÅ</strong>„ÄÇ</li>
</ul>
<p>‰∏∫‰∫ÜÁêÜËß£Ëøô‰∏§‰∏™ÁâπÊÄßÔºåÊàë‰ª¨‰∏æ‰∏™‰æãÂ≠êÔºåÂÅáËÆæÊúâ‰∏§‰∏™Á∫øÁ®ãAÂíåBÂπ∂ÂèëÊâßË°åÔºåÁ∫øÁ®ãAÊúâ3‰∏™Êìç‰ΩúÔºå‰ªñ‰ª¨Âú®Á®ãÂ∫è‰∏≠ÁöÑÈ°∫Â∫èÊòØA1-&gt;A2-&gt;A3ÔºåÁ∫øÁ®ãB‰πüÊúâ3‰∏™Êìç‰ΩúÔºåB1-&gt;B2-&gt;B3„ÄÇ</p>
<p>ÂÅáËÆæ<strong>Ê≠£Á°Æ‰ΩøÁî®‰∫ÜÂêåÊ≠•</strong>ÔºåAÁ∫øÁ®ãÁöÑ3‰∏™Êìç‰ΩúÊâßË°åÂêéÈáäÊîæÈîÅÔºåBÁ∫øÁ®ãËé∑ÂèñÂêå‰∏Ä‰∏™ÈîÅ„ÄÇÈÇ£‰πàÂú®<strong>È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã</strong>‰∏≠ÁöÑÊâßË°åÊïàÊûúÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö</p>
<p><img src="https://i0.hdslb.com/bfs/album/a0341b2bab2075883462ea41eccef0d116ab4735.png" srcset="/Hexo/img/loading.gif" lazyload></p>
<p>Ê≠£Á°ÆÂêåÊ≠•Âõæ</p>
<p>Êìç‰ΩúÁöÑÊâßË°åÊï¥‰Ωì‰∏äÊúâÂ∫èÔºåÂπ∂‰∏î‰∏§‰∏™Á∫øÁ®ãÈÉΩÂè™ËÉΩÁúãÂà∞Ëøô‰∏™ÊâßË°åÈ°∫Â∫è„ÄÇ</p>
<p>ÂÅáËÆæ<strong>Ê≤°Êúâ‰ΩøÁî®ÂêåÊ≠•</strong>ÔºåÈÇ£‰πàÂú®<strong>È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã</strong>‰∏≠ÁöÑÊâßË°åÊïàÊûúÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö</p>
<p><img src="https://i0.hdslb.com/bfs/album/df5b8c32ffdfc8d55554f9958bcee19ddc8f61b7.png" srcset="/Hexo/img/loading.gif" lazyload></p>
<p>Ê≤°ÊúâÊ≠£Á°ÆÂêåÊ≠•Âõæ</p>
<p>Êìç‰ΩúÁöÑÊâßË°åÊï¥‰Ωì‰∏äÊó†Â∫èÔºå‰ΩÜÊòØ‰∏§‰∏™Á∫øÁ®ãÈÉΩÂè™ËÉΩÁúãÂà∞Ëøô‰∏™ÊâßË°åÈ°∫Â∫è„ÄÇ‰πãÊâÄ‰ª•ÂèØ‰ª•ÂæóÂà∞Ëøô‰∏™‰øùËØÅÔºåÊòØÂõ†‰∏∫È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã‰∏≠ÁöÑ<strong>ÊØè‰∏™Êìç‰ΩúÂøÖÈ°ªÁ´ãÂç≥ÂØπ‰ªªÊÑèÁ∫øÁ®ãÂèØËßÅ</strong>„ÄÇ</p>
<p><strong>‰ΩÜÊòØJMMÊ≤°ÊúâËøôÊ†∑ÁöÑ‰øùËØÅ„ÄÇ</strong></p>
<p>ÊØîÂ¶ÇÔºåÂú®ÂΩìÂâçÁ∫øÁ®ãÊääÂÜôËøáÁöÑÊï∞ÊçÆÁºìÂ≠òÂú®Êú¨Âú∞ÂÜÖÂ≠ò‰∏≠ÔºåÂú®Ê≤°ÊúâÂà∑Êñ∞Âà∞‰∏ªÂÜÖÂ≠ò‰πãÂâçÔºåËøô‰∏™ÂÜôÊìç‰Ωú‰ªÖÂØπÂΩìÂâçÁ∫øÁ®ãÂèØËßÅÔºõ‰ªéÂÖ∂‰ªñÁ∫øÁ®ãÁöÑËßíÂ∫¶Êù•ËßÇÂØüÔºåËøô‰∏™ÂÜôÊìç‰ΩúÊ†πÊú¨Ê≤°ÊúâË¢´ÂΩìÂâçÁ∫øÁ®ãÊâÄÊâßË°å„ÄÇÂè™ÊúâÂΩìÂâçÁ∫øÁ®ãÊääÊú¨Âú∞ÂÜÖÂ≠ò‰∏≠ÂÜôËøáÁöÑÊï∞ÊçÆÂà∑Êñ∞Âà∞‰∏ªÂÜÖÂ≠ò‰πãÂêéÔºåËøô‰∏™ÂÜôÊìç‰ΩúÊâçÂØπÂÖ∂‰ªñÁ∫øÁ®ãÂèØËßÅ„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂΩìÂâçÁ∫øÁ®ãÂíåÂÖ∂‰ªñÁ∫øÁ®ãÁúãÂà∞ÁöÑÊâßË°åÈ°∫Â∫èÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑ„ÄÇ</p>
<h3 id="7-2-3-JMM‰∏≠ÂêåÊ≠•Á®ãÂ∫èÁöÑÈ°∫Â∫è‰∏ÄËá¥ÊÄßÊïàÊûú"><a href="#7-2-3-JMM‰∏≠ÂêåÊ≠•Á®ãÂ∫èÁöÑÈ°∫Â∫è‰∏ÄËá¥ÊÄßÊïàÊûú" class="headerlink" title="7.2.3 JMM‰∏≠ÂêåÊ≠•Á®ãÂ∫èÁöÑÈ°∫Â∫è‰∏ÄËá¥ÊÄßÊïàÊûú"></a>7.2.3 JMM‰∏≠ÂêåÊ≠•Á®ãÂ∫èÁöÑÈ°∫Â∫è‰∏ÄËá¥ÊÄßÊïàÊûú</h3><p>Âú®È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã‰∏≠ÔºåÊâÄÊúâÊìç‰ΩúÂÆåÂÖ®ÊåâÁÖßÁ®ãÂ∫èÁöÑÈ°∫Â∫è‰∏≤Ë°åÊâßË°å„ÄÇ‰ΩÜÊòØJMM‰∏≠Ôºå‰∏¥ÁïåÂå∫ÂÜÖÔºàÂêåÊ≠•ÂùóÊàñÂêåÊ≠•ÊñπÊ≥ï‰∏≠ÔºâÁöÑ‰ª£Á†ÅÂèØ‰ª•ÂèëÁîüÈáçÊéíÂ∫èÔºà‰ΩÜ‰∏çÂÖÅËÆ∏‰∏¥ÁïåÂå∫ÂÜÖÁöÑ‰ª£Á†Å‚ÄúÈÄÉÈÄ∏‚ÄùÂà∞‰∏¥ÁïåÂå∫‰πãÂ§ñÔºåÂõ†‰∏∫‰ºöÁ†¥ÂùèÈîÅÁöÑÂÜÖÂ≠òËØ≠‰πâÔºâ„ÄÇ</p>
<p>ËôΩÁÑ∂Á∫øÁ®ãAÂú®‰∏¥ÁïåÂå∫ÂÅö‰∫ÜÈáçÊéíÂ∫èÔºå‰ΩÜÊòØÂõ†‰∏∫ÈîÅÁöÑÁâπÊÄßÔºåÁ∫øÁ®ãBÊó†Ê≥ïËßÇÂØüÂà∞Á∫øÁ®ãAÂú®‰∏¥ÁïåÂå∫ÁöÑÈáçÊéíÂ∫è„ÄÇËøôÁßçÈáçÊéíÂ∫èÊó¢ÊèêÈ´ò‰∫ÜÊâßË°åÊïàÁéáÔºåÂèàÊ≤°ÊúâÊîπÂèòÁ®ãÂ∫èÁöÑÊâßË°åÁªìÊûú„ÄÇ</p>
<p>ÂêåÊó∂ÔºåJMM‰ºöÂú®ÈÄÄÂá∫‰∏¥ÁïåÂå∫ÂíåËøõÂÖ•‰∏¥ÁïåÂå∫ÂÅöÁâπÊÆäÁöÑÂ§ÑÁêÜÔºå‰ΩøÂæóÂú®‰∏¥ÁïåÂå∫ÂÜÖÁ®ãÂ∫èËé∑Âæó‰∏éÈ°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°ÂûãÁõ∏ÂêåÁöÑÂÜÖÂ≠òËßÜÂõæ„ÄÇ</p>
<p><strong>Áî±Ê≠§ÂèØËßÅÔºåJMMÁöÑÂÖ∑‰ΩìÂÆûÁé∞ÊñπÈíàÊòØÔºöÂú®‰∏çÊîπÂèòÔºàÊ≠£Á°ÆÂêåÊ≠•ÁöÑÔºâÁ®ãÂ∫èÊâßË°åÁªìÊûúÁöÑÂâçÊèê‰∏ãÔºåÂ∞ΩÈáè‰∏∫ÁºñËØëÊúüÂíåÂ§ÑÁêÜÂô®ÁöÑ‰ºòÂåñÊâìÂºÄÊñπ‰æø‰πãÈó®</strong>„ÄÇ</p>
<h3 id="7-2-4-JMM‰∏≠Êú™ÂêåÊ≠•Á®ãÂ∫èÁöÑÈ°∫Â∫è‰∏ÄËá¥ÊÄßÊïàÊûú"><a href="#7-2-4-JMM‰∏≠Êú™ÂêåÊ≠•Á®ãÂ∫èÁöÑÈ°∫Â∫è‰∏ÄËá¥ÊÄßÊïàÊûú" class="headerlink" title="7.2.4 JMM‰∏≠Êú™ÂêåÊ≠•Á®ãÂ∫èÁöÑÈ°∫Â∫è‰∏ÄËá¥ÊÄßÊïàÊûú"></a>7.2.4 JMM‰∏≠Êú™ÂêåÊ≠•Á®ãÂ∫èÁöÑÈ°∫Â∫è‰∏ÄËá¥ÊÄßÊïàÊûú</h3><p>ÂØπ‰∫éÊú™ÂêåÊ≠•ÁöÑÂ§öÁ∫øÁ®ãÁ®ãÂ∫èÔºåJMMÂè™Êèê‰æõ<strong>ÊúÄÂ∞èÂÆâÂÖ®ÊÄß</strong>ÔºöÁ∫øÁ®ãËØªÂèñÂà∞ÁöÑÂÄºÔºåË¶Å‰πàÊòØ‰πãÂâçÊüê‰∏™Á∫øÁ®ãÂÜôÂÖ•ÁöÑÂÄºÔºåË¶Å‰πàÊòØÈªòËÆ§ÂÄºÔºå‰∏ç‰ºöÊó†‰∏≠ÁîüÊúâ„ÄÇ</p>
<p>‰∏∫‰∫ÜÂÆûÁé∞Ëøô‰∏™ÂÆâÂÖ®ÊÄßÔºåJVMÂú®Â†Ü‰∏äÂàÜÈÖçÂØπË±°Êó∂ÔºåÈ¶ñÂÖà‰ºöÂØπÂÜÖÂ≠òÁ©∫Èó¥Ê∏ÖÈõ∂ÔºåÁÑ∂ÂêéÊâç‰ºöÂú®‰∏äÈù¢ÂàÜÈÖçÂØπË±°ÔºàËøô‰∏§‰∏™Êìç‰ΩúÊòØÂêåÊ≠•ÁöÑÔºâ„ÄÇ</p>
<p><strong>JMMÊ≤°Êúâ‰øùËØÅÊú™ÂêåÊ≠•Á®ãÂ∫èÁöÑÊâßË°åÁªìÊûú‰∏éËØ•Á®ãÂ∫èÂú®È°∫Â∫è‰∏ÄËá¥ÊÄß‰∏≠ÊâßË°åÁªìÊûú‰∏ÄËá¥„ÄÇÂõ†‰∏∫Â¶ÇÊûúË¶Å‰øùËØÅÊâßË°åÁªìÊûú‰∏ÄËá¥ÔºåÈÇ£‰πàJMMÈúÄË¶ÅÁ¶ÅÊ≠¢Â§ßÈáèÁöÑ‰ºòÂåñÔºåÂØπÁ®ãÂ∫èÁöÑÊâßË°åÊÄßËÉΩ‰ºö‰∫ßÁîüÂæàÂ§ßÁöÑÂΩ±Âìç„ÄÇ</strong></p>
<p>Êú™ÂêåÊ≠•Á®ãÂ∫èÂú®JMMÂíåÈ°∫Â∫è‰∏ÄËá¥ÊÄßÂÜÖÂ≠òÊ®°Âûã‰∏≠ÁöÑÊâßË°åÁâπÊÄßÊúâÂ¶Ç‰∏ãÂ∑ÆÂºÇÔºö 1. È°∫Â∫è‰∏ÄËá¥ÊÄß‰øùËØÅÂçïÁ∫øÁ®ãÂÜÖÁöÑÊìç‰Ωú‰ºöÊåâÁ®ãÂ∫èÁöÑÈ°∫Â∫èÊâßË°åÔºõJMM‰∏ç‰øùËØÅÂçïÁ∫øÁ®ãÂÜÖÁöÑÊìç‰Ωú‰ºöÊåâÁ®ãÂ∫èÁöÑÈ°∫Â∫èÊâßË°å„ÄÇÔºàÂõ†‰∏∫ÈáçÊéíÂ∫èÔºå‰ΩÜÊòØJMM‰øùËØÅÂçïÁ∫øÁ®ã‰∏ãÁöÑÈáçÊéíÂ∫è‰∏çÂΩ±ÂìçÊâßË°åÁªìÊûúÔºâ 2. È°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã‰øùËØÅÊâÄÊúâÁ∫øÁ®ãÂè™ËÉΩÁúãÂà∞‰∏ÄËá¥ÁöÑÊìç‰ΩúÊâßË°åÈ°∫Â∫èÔºåËÄåJMM‰∏ç‰øùËØÅÊâÄÊúâÁ∫øÁ®ãËÉΩÁúãÂà∞‰∏ÄËá¥ÁöÑÊìç‰ΩúÊâßË°åÈ°∫Â∫è„ÄÇÔºàÂõ†‰∏∫JMM‰∏ç‰øùËØÅÊâÄÊúâÊìç‰ΩúÁ´ãÂç≥ÂèØËßÅÔºâ 3. JMM‰∏ç‰øùËØÅÂØπ64‰ΩçÁöÑlongÂûãÂíådoubleÂûãÂèòÈáèÁöÑÂÜôÊìç‰ΩúÂÖ∑ÊúâÂéüÂ≠êÊÄßÔºåËÄåÈ°∫Â∫è‰∏ÄËá¥ÊÄßÊ®°Âûã‰øùËØÅÂØπÊâÄÊúâÁöÑÂÜÖÂ≠òËØªÂÜôÊìç‰ΩúÈÉΩÂÖ∑ÊúâÂéüÂ≠êÊÄß„ÄÇ</p>
<h2 id="7-3-happens-before"><a href="#7-3-happens-before" class="headerlink" title="7.3 happens-before"></a>7.3 happens-before</h2><h3 id="7-3-1-‰ªÄ‰πàÊòØhappens-before"><a href="#7-3-1-‰ªÄ‰πàÊòØhappens-before" class="headerlink" title="7.3.1 ‰ªÄ‰πàÊòØhappens-before?"></a>7.3.1 ‰ªÄ‰πàÊòØhappens-before?</h3><p>‰∏ÄÊñπÈù¢ÔºåÁ®ãÂ∫èÂëòÈúÄË¶ÅJMMÊèê‰æõ‰∏Ä‰∏™Âº∫ÁöÑÂÜÖÂ≠òÊ®°ÂûãÊù•ÁºñÂÜô‰ª£Á†ÅÔºõÂè¶‰∏ÄÊñπÈù¢ÔºåÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®Â∏åÊúõJMMÂØπÂÆÉ‰ª¨ÁöÑÊùüÁºöË∂äÂ∞ëË∂äÂ•ΩÔºåËøôÊ†∑ÂÆÉ‰ª¨Â∞±ÂèØ‰ª•ÊúÄÂèØËÉΩÂ§öÁöÑÂÅö‰ºòÂåñÊù•ÊèêÈ´òÊÄßËÉΩÔºåÂ∏åÊúõÁöÑÊòØ‰∏Ä‰∏™Âº±ÁöÑÂÜÖÂ≠òÊ®°Âûã„ÄÇ</p>
<p>JMMËÄÉËôë‰∫ÜËøô‰∏§ÁßçÈúÄÊ±ÇÔºåÂπ∂‰∏îÊâæÂà∞‰∫ÜÂπ≥Ë°°ÁÇπÔºåÂØπÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®Êù•ËØ¥Ôºå<strong>Âè™Ë¶Å‰∏çÊîπÂèòÁ®ãÂ∫èÁöÑÊâßË°åÁªìÊûúÔºàÂçïÁ∫øÁ®ãÁ®ãÂ∫èÂíåÊ≠£Á°ÆÂêåÊ≠•‰∫ÜÁöÑÂ§öÁ∫øÁ®ãÁ®ãÂ∫èÔºâÔºåÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®ÊÄé‰πà‰ºòÂåñÈÉΩË°å„ÄÇ</strong></p>
<p>ËÄåÂØπ‰∫éÁ®ãÂ∫èÂëòÔºåJMMÊèê‰æõ‰∫Ü<strong>happens-beforeËßÑÂàô</strong>ÔºàJSR-133ËßÑËåÉÔºâÔºåÊª°Ë∂≥‰∫ÜÁ®ãÂ∫èÂëòÁöÑÈúÄÊ±Ç‚Äî‚Äî<strong>ÁÆÄÂçïÊòìÊáÇÔºåÂπ∂‰∏îÊèê‰æõ‰∫ÜË∂≥Â§üÂº∫ÁöÑÂÜÖÂ≠òÂèØËßÅÊÄß‰øùËØÅ„ÄÇ</strong>Êç¢Ë®Ä‰πãÔºåÁ®ãÂ∫èÂëòÂè™Ë¶ÅÈÅµÂæ™happens-beforeËßÑÂàôÔºåÈÇ£‰ªñÂÜôÁöÑÁ®ãÂ∫èÂ∞±ËÉΩ‰øùËØÅÂú®JMM‰∏≠ÂÖ∑ÊúâÂº∫ÁöÑÂÜÖÂ≠òÂèØËßÅÊÄß„ÄÇ</p>
<p>JMM‰ΩøÁî®happens-beforeÁöÑÊ¶ÇÂøµÊù•ÂÆöÂà∂‰∏§‰∏™Êìç‰Ωú‰πãÈó¥ÁöÑÊâßË°åÈ°∫Â∫è„ÄÇËøô‰∏§‰∏™Êìç‰ΩúÂèØ‰ª•Âú®‰∏Ä‰∏™Á∫øÁ®ã‰ª•ÂÜÖÔºå‰πüÂèØ‰ª•ÊòØ‰∏çÂêåÁöÑÁ∫øÁ®ã‰πãÈó¥„ÄÇÂõ†Ê≠§ÔºåJMMÂèØ‰ª•ÈÄöËøáhappens-beforeÂÖ≥Á≥ªÂêëÁ®ãÂ∫èÂëòÊèê‰æõË∑®Á∫øÁ®ãÁöÑÂÜÖÂ≠òÂèØËßÅÊÄß‰øùËØÅ„ÄÇ</p>
<p>happens-beforeÂÖ≥Á≥ªÁöÑÂÆö‰πâÂ¶Ç‰∏ãÔºö 1. Â¶ÇÊûú‰∏Ä‰∏™Êìç‰Ωúhappens-beforeÂè¶‰∏Ä‰∏™Êìç‰ΩúÔºåÈÇ£‰πàÁ¨¨‰∏Ä‰∏™Êìç‰ΩúÁöÑÊâßË°åÁªìÊûúÂ∞ÜÂØπÁ¨¨‰∫å‰∏™Êìç‰ΩúÂèØËßÅÔºåËÄå‰∏îÁ¨¨‰∏Ä‰∏™Êìç‰ΩúÁöÑÊâßË°åÈ°∫Â∫èÊéíÂú®Á¨¨‰∫å‰∏™Êìç‰Ωú‰πãÂâç„ÄÇ 2. <strong>‰∏§‰∏™Êìç‰Ωú‰πãÈó¥Â≠òÂú®happens-beforeÂÖ≥Á≥ªÔºåÂπ∂‰∏çÊÑèÂë≥ÁùÄJavaÂπ≥Âè∞ÁöÑÂÖ∑‰ΩìÂÆûÁé∞ÂøÖÈ°ªË¶ÅÊåâÁÖßhappens-beforeÂÖ≥Á≥ªÊåáÂÆöÁöÑÈ°∫Â∫èÊù•ÊâßË°å„ÄÇÂ¶ÇÊûúÈáçÊéíÂ∫è‰πãÂêéÁöÑÊâßË°åÁªìÊûúÔºå‰∏éÊåâhappens-beforeÂÖ≥Á≥ªÊù•ÊâßË°åÁöÑÁªìÊûú‰∏ÄËá¥ÔºåÈÇ£‰πàJMM‰πüÂÖÅËÆ∏ËøôÊ†∑ÁöÑÈáçÊéíÂ∫è„ÄÇ</strong></p>
<p>happens-beforeÂÖ≥Á≥ªÊú¨Ë¥®‰∏äÂíåas-if-serialËØ≠‰πâÊòØ‰∏ÄÂõû‰∫ã„ÄÇ</p>
<p>as-if-serialËØ≠‰πâ‰øùËØÅÂçïÁ∫øÁ®ãÂÜÖÈáçÊéíÂ∫èÂêéÁöÑÊâßË°åÁªìÊûúÂíåÁ®ãÂ∫è‰ª£Á†ÅÊú¨Ë∫´Â∫îÊúâÁöÑÁªìÊûúÊòØ‰∏ÄËá¥ÁöÑÔºåhappens-beforeÂÖ≥Á≥ª‰øùËØÅÊ≠£Á°ÆÂêåÊ≠•ÁöÑÂ§öÁ∫øÁ®ãÁ®ãÂ∫èÁöÑÊâßË°åÁªìÊûú‰∏çË¢´ÈáçÊéíÂ∫èÊîπÂèò„ÄÇ</p>
<p>ÊÄª‰πãÔºå<strong>Â¶ÇÊûúÊìç‰ΩúA happens-beforeÊìç‰ΩúBÔºåÈÇ£‰πàÊìç‰ΩúAÂú®ÂÜÖÂ≠ò‰∏äÊâÄÂÅöÁöÑÊìç‰ΩúÂØπÊìç‰ΩúBÈÉΩÊòØÂèØËßÅÁöÑÔºå‰∏çÁÆ°ÂÆÉ‰ª¨Âú®‰∏çÂú®‰∏Ä‰∏™Á∫øÁ®ã„ÄÇ</strong></p>
<h3 id="7-3-2-Â§©ÁÑ∂ÁöÑhappens-beforeÂÖ≥Á≥ª"><a href="#7-3-2-Â§©ÁÑ∂ÁöÑhappens-beforeÂÖ≥Á≥ª" class="headerlink" title="7.3.2 Â§©ÁÑ∂ÁöÑhappens-beforeÂÖ≥Á≥ª"></a>7.3.2 Â§©ÁÑ∂ÁöÑhappens-beforeÂÖ≥Á≥ª</h3><p>Âú®Java‰∏≠ÔºåÊúâ‰ª•‰∏ãÂ§©ÁÑ∂ÁöÑhappens-beforeÂÖ≥Á≥ªÔºö</p>
<ul>
<li>Á®ãÂ∫èÈ°∫Â∫èËßÑÂàôÔºö‰∏Ä‰∏™Á∫øÁ®ã‰∏≠ÁöÑÊØè‰∏Ä‰∏™Êìç‰ΩúÔºåhappens-before‰∫éËØ•Á∫øÁ®ã‰∏≠ÁöÑ‰ªªÊÑèÂêéÁª≠Êìç‰Ωú„ÄÇ</li>
<li>ÁõëËßÜÂô®ÈîÅËßÑÂàôÔºöÂØπ‰∏Ä‰∏™ÈîÅÁöÑËß£ÈîÅÔºåhappens-before‰∫éÈöèÂêéÂØπËøô‰∏™ÈîÅÁöÑÂä†ÈîÅ„ÄÇ</li>
<li>volatileÂèòÈáèËßÑÂàôÔºöÂØπ‰∏Ä‰∏™volatileÂüüÁöÑÂÜôÔºåhappens-before‰∫é‰ªªÊÑèÂêéÁª≠ÂØπËøô‰∏™volatileÂüüÁöÑËØª„ÄÇ</li>
<li>‰º†ÈÄíÊÄßÔºöÂ¶ÇÊûúA happens-before BÔºå‰∏îB happens-before CÔºåÈÇ£‰πàA happens-before C„ÄÇ</li>
<li>startËßÑÂàôÔºöÂ¶ÇÊûúÁ∫øÁ®ãAÊâßË°åÊìç‰ΩúThreadB.start()ÂêØÂä®Á∫øÁ®ãBÔºåÈÇ£‰πàAÁ∫øÁ®ãÁöÑThreadB.startÔºàÔºâÊìç‰Ωúhappens-before‰∫éÁ∫øÁ®ãB‰∏≠ÁöÑ‰ªªÊÑèÊìç‰Ωú„ÄÅ</li>
<li>joinËßÑÂàôÔºöÂ¶ÇÊûúÁ∫øÁ®ãAÊâßË°åÊìç‰ΩúThreadB.joinÔºàÔºâÂπ∂ÊàêÂäüËøîÂõûÔºåÈÇ£‰πàÁ∫øÁ®ãB‰∏≠ÁöÑ‰ªªÊÑèÊìç‰Ωúhappens-before‰∫éÁ∫øÁ®ãA‰ªéThreadB.join()Êìç‰ΩúÊàêÂäüËøîÂõû„ÄÇ</li>
</ul>
<p>‰∏æ‰æãÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; <span class="hljs-comment">// AÊìç‰Ωú</span><br><br><span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; <span class="hljs-comment">// BÊìç‰Ωú</span><br><br><span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> a + b;<span class="hljs-comment">// C Êìç‰Ωú</span><br><br>System.out.println(sum);<br><br><br></code></pre></td></tr></table></figure>

<p>Ê†πÊçÆ‰ª•‰∏ä‰ªãÁªçÁöÑhappens-beforeËßÑÂàôÔºåÂÅáÂ¶ÇÂè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãÔºåÈÇ£‰πà‰∏çÈöæÂæóÂá∫Ôºö1</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl"><span class="hljs-meta prompt_">1&gt; </span>A happens-before B <br><br><span class="hljs-meta prompt_">2&gt; </span>B happens-before C <br><br><span class="hljs-meta prompt_">3&gt; </span>A happens-before C<br></code></pre></td></tr></table></figure>



<p>Copied!</p>
<p>Ê≥®ÊÑèÔºåÁúüÊ≠£Âú®ÊâßË°åÊåá‰ª§ÁöÑÊó∂ÂÄôÔºåÂÖ∂ÂÆûJVMÊúâÂèØËÉΩÂØπÊìç‰ΩúA &amp; BËøõË°åÈáçÊéíÂ∫èÔºåÂõ†‰∏∫Êó†ËÆ∫ÂÖàÊâßË°åAËøòÊòØBÔºå‰ªñ‰ª¨ÈÉΩÂØπÂØπÊñπÊòØÂèØËßÅÁöÑÔºåÂπ∂‰∏î‰∏çÂΩ±ÂìçÊâßË°åÁªìÊûú„ÄÇ</p>
<p>Â¶ÇÊûúËøôÈáåÂèëÁîü‰∫ÜÈáçÊéíÂ∫èÔºåËøôÂú®ËßÜËßâ‰∏äËøùËÉå‰∫Ühappens-beforeÂéüÂàôÔºå‰ΩÜÊòØJMMÊòØÂÖÅËÆ∏ËøôÊ†∑ÁöÑÈáçÊéíÂ∫èÁöÑ„ÄÇ</p>
<p>ÊâÄ‰ª•ÔºåÊàë‰ª¨Âè™ÂÖ≥ÂøÉhappens-beforeËßÑÂàôÔºå‰∏çÁî®ÂÖ≥ÂøÉJVMÂà∞Â∫ïÊòØÊÄéÊ†∑ÊâßË°åÁöÑ„ÄÇÂè™Ë¶ÅÁ°ÆÂÆöÊìç‰ΩúA happens-beforeÊìç‰ΩúBÂ∞±Ë°å‰∫Ü„ÄÇ</p>
<p>ÈáçÊéíÂ∫èÊúâ‰∏§Á±ªÔºåJMMÂØπËøô‰∏§Á±ªÈáçÊéíÂ∫èÊúâ‰∏çÂêåÁöÑÁ≠ñÁï•Ôºö</p>
<ul>
<li>‰ºöÊîπÂèòÁ®ãÂ∫èÊâßË°åÁªìÊûúÁöÑÈáçÊéíÂ∫èÔºåÊØîÂ¶Ç A -&gt; CÔºåJMMË¶ÅÊ±ÇÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®ÈÉΩ‰∏çËÆ∏Á¶ÅÊ≠¢ËøôÁßçÈáçÊéíÂ∫è„ÄÇ</li>
<li>‰∏ç‰ºöÊîπÂèòÁ®ãÂ∫èÊâßË°åÁªìÊûúÁöÑÈáçÊéíÂ∫èÔºåÊØîÂ¶Ç A -&gt; BÔºåJMMÂØπÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®‰∏çÂÅöË¶ÅÊ±ÇÔºåÂÖÅËÆ∏ËøôÁßçÈáçÊéíÂ∫è„ÄÇ</li>
</ul>
<p><strong>ÂèÇËÄÉËµÑÊñô</strong></p>
<ul>
<li>„ÄäJavaÂπ∂ÂèëÁºñÁ®ãÁöÑËâ∫ÊúØ„Äã</li>
</ul>
<h2 id="8-1-Âá†‰∏™Âü∫Êú¨Ê¶ÇÂøµ"><a href="#8-1-Âá†‰∏™Âü∫Êú¨Ê¶ÇÂøµ" class="headerlink" title="8.1 Âá†‰∏™Âü∫Êú¨Ê¶ÇÂøµ"></a>8.1 Âá†‰∏™Âü∫Êú¨Ê¶ÇÂøµ</h2><p>Âú®‰ªãÁªçvolatile‰πãÂâçÔºåÊàë‰ª¨ÂÖàÂõûÈ°æÂèä‰ªãÁªçÂá†‰∏™Âü∫Êú¨ÁöÑÊ¶ÇÂøµ„ÄÇ</p>
<h3 id="8-1-1-ÂÜÖÂ≠òÂèØËßÅÊÄß"><a href="#8-1-1-ÂÜÖÂ≠òÂèØËßÅÊÄß" class="headerlink" title="8.1.1 ÂÜÖÂ≠òÂèØËßÅÊÄß"></a>8.1.1 ÂÜÖÂ≠òÂèØËßÅÊÄß</h3><p>Âú®JavaÂÜÖÂ≠òÊ®°ÂûãÈÇ£‰∏ÄÁ´†Êàë‰ª¨‰ªãÁªç‰∫ÜJMMÊúâ‰∏Ä‰∏™‰∏ªÂÜÖÂ≠òÔºåÊØè‰∏™Á∫øÁ®ãÊúâËá™Â∑±ÁßÅÊúâÁöÑÂ∑•‰ΩúÂÜÖÂ≠òÔºåÂ∑•‰ΩúÂÜÖÂ≠ò‰∏≠‰øùÂ≠ò‰∫Ü‰∏Ä‰∫õÂèòÈáèÂú®‰∏ªÂÜÖÂ≠òÁöÑÊã∑Ë¥ù„ÄÇ</p>
<p><strong>ÂÜÖÂ≠òÂèØËßÅÊÄßÔºåÊåáÁöÑÊòØÁ∫øÁ®ã‰πãÈó¥ÁöÑÂèØËßÅÊÄßÔºåÂΩì‰∏Ä‰∏™Á∫øÁ®ã‰øÆÊîπ‰∫ÜÂÖ±‰∫´ÂèòÈáèÊó∂ÔºåÂè¶‰∏Ä‰∏™Á∫øÁ®ãÂèØ‰ª•ËØªÂèñÂà∞Ëøô‰∏™‰øÆÊîπÂêéÁöÑÂÄº</strong>„ÄÇ</p>
<h3 id="8-1-2-ÈáçÊéíÂ∫è"><a href="#8-1-2-ÈáçÊéíÂ∫è" class="headerlink" title="8.1.2 ÈáçÊéíÂ∫è"></a>8.1.2 ÈáçÊéíÂ∫è</h3><p>‰∏∫‰ºòÂåñÁ®ãÂ∫èÊÄßËÉΩÔºåÂØπÂéüÊúâÁöÑÊåá‰ª§ÊâßË°åÈ°∫Â∫èËøõË°å‰ºòÂåñÈáçÊñ∞ÊéíÂ∫è„ÄÇÈáçÊéíÂ∫èÂèØËÉΩÂèëÁîüÂú®Â§ö‰∏™Èò∂ÊÆµÔºåÊØîÂ¶ÇÁºñËØëÈáçÊéíÂ∫è„ÄÅCPUÈáçÊéíÂ∫èÁ≠â„ÄÇ</p>
<h3 id="8-1-3-happens-beforeËßÑÂàô"><a href="#8-1-3-happens-beforeËßÑÂàô" class="headerlink" title="8.1.3 happens-beforeËßÑÂàô"></a>8.1.3 happens-beforeËßÑÂàô</h3><p>ÊòØ‰∏Ä‰∏™ÁªôÁ®ãÂ∫èÂëò‰ΩøÁî®ÁöÑËßÑÂàôÔºåÂè™Ë¶ÅÁ®ãÂ∫èÂëòÂú®ÂÜô‰ª£Á†ÅÁöÑÊó∂ÂÄôÈÅµÂæ™happens-beforeËßÑÂàôÔºåJVMÂ∞±ËÉΩ‰øùËØÅÊåá‰ª§Âú®Â§öÁ∫øÁ®ã‰πãÈó¥ÁöÑÈ°∫Â∫èÊÄßÁ¨¶ÂêàÁ®ãÂ∫èÂëòÁöÑÈ¢ÑÊúü„ÄÇ</p>
<h2 id="8-2-volatileÁöÑÂÜÖÂ≠òËØ≠‰πâ"><a href="#8-2-volatileÁöÑÂÜÖÂ≠òËØ≠‰πâ" class="headerlink" title="8.2 volatileÁöÑÂÜÖÂ≠òËØ≠‰πâ"></a>8.2 volatileÁöÑÂÜÖÂ≠òËØ≠‰πâ</h2><p>Âú®Java‰∏≠ÔºåvolatileÂÖ≥ÈîÆÂ≠óÊúâÁâπÊÆäÁöÑÂÜÖÂ≠òËØ≠‰πâ„ÄÇvolatile‰∏ªË¶ÅÊúâ‰ª•‰∏ã‰∏§‰∏™ÂäüËÉΩÔºö</p>
<ul>
<li>‰øùËØÅÂèòÈáèÁöÑ<strong>ÂÜÖÂ≠òÂèØËßÅÊÄß</strong></li>
<li>Á¶ÅÊ≠¢volatileÂèòÈáè‰∏éÊôÆÈÄöÂèòÈáè<strong>ÈáçÊéíÂ∫è</strong>ÔºàJSR133ÊèêÂá∫ÔºåJava 5 ÂºÄÂßãÊâçÊúâËøô‰∏™‚ÄúÂ¢ûÂº∫ÁöÑvolatileÂÜÖÂ≠òËØ≠‰πâ‚ÄùÔºâ</li>
</ul>
<h3 id="8-2-1-ÂÜÖÂ≠òÂèØËßÅÊÄß"><a href="#8-2-1-ÂÜÖÂ≠òÂèØËßÅÊÄß" class="headerlink" title="8.2.1 ÂÜÖÂ≠òÂèØËßÅÊÄß"></a>8.2.1 ÂÜÖÂ≠òÂèØËßÅÊÄß</h3><p>‰ª•‰∏ÄÊÆµÁ§∫‰æã‰ª£Á†ÅÂºÄÂßãÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VolatileExample</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writer</span><span class="hljs-params">()</span> &#123;<br>        a = <span class="hljs-number">1</span>; <span class="hljs-comment">// step 1</span><br>        flag = <span class="hljs-literal">true</span>; <span class="hljs-comment">// step 2</span><br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reader</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span> (flag) &#123; <span class="hljs-comment">// step 3</span><br>            System.out.println(a); <span class="hljs-comment">// step 4</span><br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>Âú®ËøôÊÆµ‰ª£Á†ÅÈáåÔºåÊàë‰ª¨‰ΩøÁî®<code>volatile</code>ÂÖ≥ÈîÆÂ≠ó‰øÆÈ•∞‰∫Ü‰∏Ä‰∏™<code>boolean</code>Á±ªÂûãÁöÑÂèòÈáè<code>flag</code>„ÄÇ</p>
<p>ÊâÄË∞ìÂÜÖÂ≠òÂèØËßÅÊÄßÔºåÊåáÁöÑÊòØÂΩì‰∏Ä‰∏™Á∫øÁ®ãÂØπ<code>volatile</code>‰øÆÈ•∞ÁöÑÂèòÈáèËøõË°å<strong>ÂÜôÊìç‰Ωú</strong>ÔºàÊØîÂ¶Çstep 2ÔºâÊó∂ÔºåJMM‰ºöÁ´ãÂç≥ÊääËØ•Á∫øÁ®ãÂØπÂ∫îÁöÑÊú¨Âú∞ÂÜÖÂ≠ò‰∏≠ÁöÑÂÖ±‰∫´ÂèòÈáèÁöÑÂÄºÂà∑Êñ∞Âà∞‰∏ªÂÜÖÂ≠òÔºõÂΩì‰∏Ä‰∏™Á∫øÁ®ãÂØπ<code>volatile</code>‰øÆÈ•∞ÁöÑÂèòÈáèËøõË°å<strong>ËØªÊìç‰Ωú</strong>ÔºàÊØîÂ¶Çstep 3ÔºâÊó∂ÔºåJMM‰ºöÊääÁ´ãÂç≥ËØ•Á∫øÁ®ãÂØπÂ∫îÁöÑÊú¨Âú∞ÂÜÖÂ≠òÁΩÆ‰∏∫Êó†ÊïàÔºå‰ªé‰∏ªÂÜÖÂ≠ò‰∏≠ËØªÂèñÂÖ±‰∫´ÂèòÈáèÁöÑÂÄº„ÄÇ</p>
<blockquote>
<p>Âú®Ëøô‰∏ÄÁÇπ‰∏äÔºåvolatile‰∏éÈîÅÂÖ∑ÊúâÁõ∏ÂêåÁöÑÂÜÖÂ≠òÊïàÊûúÔºåvolatileÂèòÈáèÁöÑÂÜôÂíåÈîÅÁöÑÈáäÊîæÂÖ∑ÊúâÁõ∏ÂêåÁöÑÂÜÖÂ≠òËØ≠‰πâÔºåvolatileÂèòÈáèÁöÑËØªÂíåÈîÅÁöÑËé∑ÂèñÂÖ∑ÊúâÁõ∏ÂêåÁöÑÂÜÖÂ≠òËØ≠‰πâ„ÄÇ</p>
</blockquote>
<p>ÂÅáËÆæÂú®Êó∂Èó¥Á∫ø‰∏äÔºåÁ∫øÁ®ãAÂÖàËá™Ë°åÊñπÊ≥ï<code>writer</code>ÊñπÊ≥ïÔºåÁ∫øÁ®ãBÂêéÊâßË°å<code>reader</code>ÊñπÊ≥ï„ÄÇÈÇ£ÂøÖÁÑ∂‰ºöÊúâ‰∏ãÂõæÔºö</p>
<p>Could not load image</p>
<p>volatileÂÜÖÂ≠òÁ§∫ÊÑèÂõæ</p>
<p>ËÄåÂ¶ÇÊûú<code>flag</code>ÂèòÈáè<strong>Ê≤°Êúâ</strong>Áî®<code>volatile</code>‰øÆÈ•∞ÔºåÂú®step 2ÔºåÁ∫øÁ®ãAÁöÑÊú¨Âú∞ÂÜÖÂ≠òÈáåÈù¢ÁöÑÂèòÈáèÂ∞±‰∏ç‰ºöÁ´ãÂç≥Êõ¥Êñ∞Âà∞‰∏ªÂÜÖÂ≠òÔºåÈÇ£ÈöèÂêéÁ∫øÁ®ãB‰πüÂêåÊ†∑‰∏ç‰ºöÂéª‰∏ªÂÜÖÂ≠òÊãøÊúÄÊñ∞ÁöÑÂÄºÔºå‰ªçÁÑ∂‰ΩøÁî®Á∫øÁ®ãBÊú¨Âú∞ÂÜÖÂ≠òÁºìÂ≠òÁöÑÂèòÈáèÁöÑÂÄº<code>a = 0Ôºåflag = false</code>„ÄÇ</p>
<h3 id="8-2-1-Á¶ÅÊ≠¢ÈáçÊéíÂ∫è"><a href="#8-2-1-Á¶ÅÊ≠¢ÈáçÊéíÂ∫è" class="headerlink" title="8.2.1 Á¶ÅÊ≠¢ÈáçÊéíÂ∫è"></a>8.2.1 Á¶ÅÊ≠¢ÈáçÊéíÂ∫è</h3><p>Âú®JSR-133‰πãÂâçÁöÑÊóßÁöÑJavaÂÜÖÂ≠òÊ®°Âûã‰∏≠ÔºåÊòØÂÖÅËÆ∏volatileÂèòÈáè‰∏éÊôÆÈÄöÂèòÈáèÈáçÊéíÂ∫èÁöÑ„ÄÇÈÇ£‰∏äÈù¢ÁöÑÊ°à‰æã‰∏≠ÔºåÂèØËÉΩÂ∞±‰ºöË¢´ÈáçÊéíÂ∫èÊàê‰∏ãÂàóÊó∂Â∫èÊù•ÊâßË°åÔºö</p>
<ol>
<li>Á∫øÁ®ãAÂÜôvolatileÂèòÈáèÔºåstep 2ÔºåËÆæÁΩÆflag‰∏∫trueÔºõ</li>
<li>Á∫øÁ®ãBËØªÂêå‰∏Ä‰∏™volatileÔºåstep 3ÔºåËØªÂèñÂà∞flag‰∏∫trueÔºõ</li>
<li>Á∫øÁ®ãBËØªÊôÆÈÄöÂèòÈáèÔºåstep 4ÔºåËØªÂèñÂà∞ a &#x3D; 0Ôºõ</li>
<li>Á∫øÁ®ãA‰øÆÊîπÊôÆÈÄöÂèòÈáèÔºåstep 1ÔºåËÆæÁΩÆ a &#x3D; 1Ôºõ</li>
</ol>
<p>ÂèØËßÅÔºåÂ¶ÇÊûúvolatileÂèòÈáè‰∏éÊôÆÈÄöÂèòÈáèÂèëÁîü‰∫ÜÈáçÊéíÂ∫èÔºåËôΩÁÑ∂volatileÂèòÈáèËÉΩ‰øùËØÅÂÜÖÂ≠òÂèØËßÅÊÄßÔºå‰πüÂèØËÉΩÂØºËá¥ÊôÆÈÄöÂèòÈáèËØªÂèñÈîôËØØ„ÄÇ</p>
<p>ÊâÄ‰ª•Âú®ÊóßÁöÑÂÜÖÂ≠òÊ®°Âûã‰∏≠ÔºåvolatileÁöÑÂÜô-ËØªÂ∞±‰∏çËÉΩ‰∏éÈîÅÁöÑÈáäÊîæ-Ëé∑ÂèñÂÖ∑ÊúâÁõ∏ÂêåÁöÑÂÜÖÂ≠òËØ≠‰πâ‰∫Ü„ÄÇ‰∏∫‰∫ÜÊèê‰æõ‰∏ÄÁßçÊØîÈîÅÊõ¥ËΩªÈáèÁ∫ßÁöÑ<strong>Á∫øÁ®ãÈó¥ÁöÑÈÄö‰ø°Êú∫Âà∂</strong>Ôºå<strong>JSR-133</strong>‰∏ìÂÆ∂ÁªÑÂÜ≥ÂÆöÂ¢ûÂº∫volatileÁöÑÂÜÖÂ≠òËØ≠‰πâÔºö‰∏•Ê†ºÈôêÂà∂ÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®ÂØπvolatileÂèòÈáè‰∏éÊôÆÈÄöÂèòÈáèÁöÑÈáçÊéíÂ∫è„ÄÇ</p>
<p>ÁºñËØëÂô®ËøòÂ•ΩËØ¥ÔºåJVMÊòØÊÄé‰πàËøòËÉΩÈôêÂà∂Â§ÑÁêÜÂô®ÁöÑÈáçÊéíÂ∫èÁöÑÂë¢ÔºüÂÆÉÊòØÈÄöËøá<strong>ÂÜÖÂ≠òÂ±èÈöú</strong>Êù•ÂÆûÁé∞ÁöÑ„ÄÇ</p>
<p>‰ªÄ‰πàÊòØÂÜÖÂ≠òÂ±èÈöúÔºüÁ°¨‰ª∂Â±ÇÈù¢ÔºåÂÜÖÂ≠òÂ±èÈöúÂàÜ‰∏§ÁßçÔºöËØªÂ±èÈöúÔºàLoad BarrierÔºâÂíåÂÜôÂ±èÈöúÔºàStore BarrierÔºâ„ÄÇÂÜÖÂ≠òÂ±èÈöúÊúâ‰∏§‰∏™‰ΩúÁî®Ôºö</p>
<ol>
<li>ÈòªÊ≠¢Â±èÈöú‰∏§‰æßÁöÑÊåá‰ª§ÈáçÊéíÂ∫èÔºõ</li>
<li>Âº∫Âà∂ÊääÂÜôÁºìÂÜ≤Âå∫&#x2F;È´òÈÄüÁºìÂ≠ò‰∏≠ÁöÑËÑèÊï∞ÊçÆÁ≠âÂÜôÂõû‰∏ªÂÜÖÂ≠òÔºåÊàñËÄÖËÆ©ÁºìÂ≠ò‰∏≠Áõ∏Â∫îÁöÑÊï∞ÊçÆÂ§±Êïà„ÄÇ</li>
</ol>
<blockquote>
<p>Ê≥®ÊÑèËøôÈáåÁöÑÁºìÂ≠ò‰∏ªË¶ÅÊåáÁöÑÊòØCPUÁºìÂ≠òÔºåÂ¶ÇL1ÔºåL2Á≠â</p>
</blockquote>
<p>ÁºñËØëÂô®Âú®<strong>ÁîüÊàêÂ≠óËäÇÁ†ÅÊó∂</strong>Ôºå‰ºöÂú®Êåá‰ª§Â∫èÂàó‰∏≠ÊèíÂÖ•ÂÜÖÂ≠òÂ±èÈöúÊù•Á¶ÅÊ≠¢ÁâπÂÆöÁ±ªÂûãÁöÑÂ§ÑÁêÜÂô®ÈáçÊéíÂ∫è„ÄÇÁºñËØëÂô®ÈÄâÊã©‰∫Ü‰∏Ä‰∏™<strong>ÊØîËæÉ‰øùÂÆàÁöÑJMMÂÜÖÂ≠òÂ±èÈöúÊèíÂÖ•Á≠ñÁï•</strong>ÔºåËøôÊ†∑ÂèØ‰ª•‰øùËØÅÂú®‰ªª‰ΩïÂ§ÑÁêÜÂô®Âπ≥Âè∞Ôºå‰ªª‰ΩïÁ®ãÂ∫è‰∏≠ÈÉΩËÉΩÂæóÂà∞Ê≠£Á°ÆÁöÑvolatileÂÜÖÂ≠òËØ≠‰πâ„ÄÇËøô‰∏™Á≠ñÁï•ÊòØÔºö</p>
<ul>
<li>Âú®ÊØè‰∏™volatileÂÜôÊìç‰ΩúÂâçÊèíÂÖ•‰∏Ä‰∏™StoreStoreÂ±èÈöúÔºõ</li>
<li>Âú®ÊØè‰∏™volatileÂÜôÊìç‰ΩúÂêéÊèíÂÖ•‰∏Ä‰∏™StoreLoadÂ±èÈöúÔºõ</li>
<li>Âú®ÊØè‰∏™volatileËØªÊìç‰ΩúÂêéÊèíÂÖ•‰∏Ä‰∏™LoadLoadÂ±èÈöúÔºõ</li>
<li>Âú®ÊØè‰∏™volatileËØªÊìç‰ΩúÂêéÂÜçÊèíÂÖ•‰∏Ä‰∏™LoadStoreÂ±èÈöú„ÄÇ</li>
</ul>
<p>ÂÜÖÂ≠òÂ±èÈöú</p>
<blockquote>
<p>ÂÜçÈÄê‰∏™Ëß£Èáä‰∏Ä‰∏ãËøôÂá†‰∏™Â±èÈöú„ÄÇÊ≥®Ôºö‰∏ãËø∞Load‰ª£Ë°®ËØªÊìç‰ΩúÔºåStore‰ª£Ë°®ÂÜôÊìç‰Ωú</p>
<p><strong>LoadLoadÂ±èÈöú</strong>ÔºöÂØπ‰∫éËøôÊ†∑ÁöÑËØ≠Âè•Load1; LoadLoad; Load2ÔºåÂú®Load2ÂèäÂêéÁª≠ËØªÂèñÊìç‰ΩúË¶ÅËØªÂèñÁöÑÊï∞ÊçÆË¢´ËÆøÈóÆÂâçÔºå‰øùËØÅLoad1Ë¶ÅËØªÂèñÁöÑÊï∞ÊçÆË¢´ËØªÂèñÂÆåÊØï„ÄÇ <strong>StoreStoreÂ±èÈöú</strong>ÔºöÂØπ‰∫éËøôÊ†∑ÁöÑËØ≠Âè•Store1; StoreStore; Store2ÔºåÂú®Store2ÂèäÂêéÁª≠ÂÜôÂÖ•Êìç‰ΩúÊâßË°åÂâçÔºå‰øùËØÅStore1ÁöÑÂÜôÂÖ•Êìç‰ΩúÂØπÂÖ∂ÂÆÉÂ§ÑÁêÜÂô®ÂèØËßÅ„ÄÇ <strong>LoadStoreÂ±èÈöú</strong>ÔºöÂØπ‰∫éËøôÊ†∑ÁöÑËØ≠Âè•Load1; LoadStore; Store2ÔºåÂú®Store2ÂèäÂêéÁª≠ÂÜôÂÖ•Êìç‰ΩúË¢´Âà∑Âá∫ÂâçÔºå‰øùËØÅLoad1Ë¶ÅËØªÂèñÁöÑÊï∞ÊçÆË¢´ËØªÂèñÂÆåÊØï„ÄÇ <strong>StoreLoadÂ±èÈöú</strong>ÔºöÂØπ‰∫éËøôÊ†∑ÁöÑËØ≠Âè•Store1; StoreLoad; Load2ÔºåÂú®Load2ÂèäÂêéÁª≠ÊâÄÊúâËØªÂèñÊìç‰ΩúÊâßË°åÂâçÔºå‰øùËØÅStore1ÁöÑÂÜôÂÖ•ÂØπÊâÄÊúâÂ§ÑÁêÜÂô®ÂèØËßÅ„ÄÇÂÆÉÁöÑÂºÄÈîÄÊòØÂõõÁßçÂ±èÈöú‰∏≠ÊúÄÂ§ßÁöÑÔºàÂÜ≤Âà∑ÂÜôÁºìÂÜ≤Âô®ÔºåÊ∏ÖÁ©∫Êó†ÊïàÂåñÈòüÂàóÔºâ„ÄÇÂú®Â§ßÂ§öÊï∞Â§ÑÁêÜÂô®ÁöÑÂÆûÁé∞‰∏≠ÔºåËøô‰∏™Â±èÈöúÊòØ‰∏™‰∏áËÉΩÂ±èÈöúÔºåÂÖºÂÖ∑ÂÖ∂ÂÆÉ‰∏âÁßçÂÜÖÂ≠òÂ±èÈöúÁöÑÂäüËÉΩ</p>
</blockquote>
<p>ÂØπ‰∫éËøûÁª≠Â§ö‰∏™volatileÂèòÈáèËØªÊàñËÄÖËøûÁª≠Â§ö‰∏™volatileÂèòÈáèÂÜôÔºåÁºñËØëÂô®ÂÅö‰∫Ü‰∏ÄÂÆöÁöÑ‰ºòÂåñÊù•ÊèêÈ´òÊÄßËÉΩÔºåÊØîÂ¶ÇÔºö</p>
<blockquote>
<p>Á¨¨‰∏Ä‰∏™volatileËØª;</p>
<p>LoadLoadÂ±èÈöúÔºõ</p>
<p>Á¨¨‰∫å‰∏™volatileËØªÔºõ</p>
<p>LoadStoreÂ±èÈöú</p>
</blockquote>
<p>ÂÜç‰ªãÁªç‰∏Ä‰∏ãvolatile‰∏éÊôÆÈÄöÂèòÈáèÁöÑÈáçÊéíÂ∫èËßÑÂàô:</p>
<ol>
<li>Â¶ÇÊûúÁ¨¨‰∏Ä‰∏™Êìç‰ΩúÊòØvolatileËØªÔºåÈÇ£Êó†ËÆ∫Á¨¨‰∫å‰∏™Êìç‰ΩúÊòØ‰ªÄ‰πàÔºåÈÉΩ‰∏çËÉΩÈáçÊéíÂ∫èÔºõ</li>
<li>Â¶ÇÊûúÁ¨¨‰∫å‰∏™Êìç‰ΩúÊòØvolatileÂÜôÔºåÈÇ£Êó†ËÆ∫Á¨¨‰∏Ä‰∏™Êìç‰ΩúÊòØ‰ªÄ‰πàÔºåÈÉΩ‰∏çËÉΩÈáçÊéíÂ∫èÔºõ</li>
<li>Â¶ÇÊûúÁ¨¨‰∏Ä‰∏™Êìç‰ΩúÊòØvolatileÂÜôÔºåÁ¨¨‰∫å‰∏™Êìç‰ΩúÊòØvolatileËØªÔºåÈÇ£‰∏çËÉΩÈáçÊéíÂ∫è„ÄÇ</li>
</ol>
<p>‰∏æ‰∏™‰æãÂ≠êÔºåÊàë‰ª¨Âú®Ê°à‰æã‰∏≠step 1ÔºåÊòØÊôÆÈÄöÂèòÈáèÁöÑÂÜôÔºåstep 2ÊòØvolatileÂèòÈáèÁöÑÂÜôÔºåÈÇ£Á¨¶ÂêàÁ¨¨2‰∏™ËßÑÂàôÔºåËøô‰∏§‰∏™steps‰∏çËÉΩÈáçÊéíÂ∫è„ÄÇËÄåstep 3ÊòØvolatileÂèòÈáèËØªÔºåstep 4ÊòØÊôÆÈÄöÂèòÈáèËØªÔºåÁ¨¶ÂêàÁ¨¨1‰∏™ËßÑÂàôÔºåÂêåÊ†∑‰∏çËÉΩÈáçÊéíÂ∫è„ÄÇ</p>
<p>‰ΩÜÂ¶ÇÊûúÊòØ‰∏ãÂàóÊÉÖÂÜµÔºöÁ¨¨‰∏Ä‰∏™Êìç‰ΩúÊòØÊôÆÈÄöÂèòÈáèËØªÔºåÁ¨¨‰∫å‰∏™Êìç‰ΩúÊòØvolatileÂèòÈáèËØªÔºåÈÇ£ÊòØÂèØ‰ª•ÈáçÊéíÂ∫èÁöÑÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Â£∞ÊòéÂèòÈáè</span><br><span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// Â£∞ÊòéÊôÆÈÄöÂèòÈáè</span><br><span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// Â£∞ÊòévolatileÂèòÈáè</span><br><br><span class="hljs-comment">// ‰ª•‰∏ã‰∏§‰∏™ÂèòÈáèÁöÑËØªÊìç‰ΩúÊòØÂèØ‰ª•ÈáçÊéíÂ∫èÁöÑ</span><br><span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> a; <span class="hljs-comment">// ÊôÆÈÄöÂèòÈáèËØª</span><br><span class="hljs-type">boolean</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> flag; <span class="hljs-comment">// volatileÂèòÈáèËØª</span><br></code></pre></td></tr></table></figure>



<h2 id="8-3-volatileÁöÑÁî®ÈÄî"><a href="#8-3-volatileÁöÑÁî®ÈÄî" class="headerlink" title="8.3 volatileÁöÑÁî®ÈÄî"></a>8.3 volatileÁöÑÁî®ÈÄî</h2><p>‰ªévolatileÁöÑÂÜÖÂ≠òËØ≠‰πâ‰∏äÊù•ÁúãÔºåvolatileÂèØ‰ª•‰øùËØÅÂÜÖÂ≠òÂèØËßÅÊÄß‰∏îÁ¶ÅÊ≠¢ÈáçÊéíÂ∫è„ÄÇ</p>
<p>Âú®‰øùËØÅÂÜÖÂ≠òÂèØËßÅÊÄßËøô‰∏ÄÁÇπ‰∏äÔºåvolatileÊúâÁùÄ‰∏éÈîÅÁõ∏ÂêåÁöÑÂÜÖÂ≠òËØ≠‰πâÔºåÊâÄ‰ª•ÂèØ‰ª•‰Ωú‰∏∫‰∏Ä‰∏™‚ÄúËΩªÈáèÁ∫ß‚ÄùÁöÑÈîÅÊù•‰ΩøÁî®„ÄÇ‰ΩÜÁî±‰∫évolatile‰ªÖ‰ªÖ‰øùËØÅÂØπÂçï‰∏™volatileÂèòÈáèÁöÑËØª&#x2F;ÂÜôÂÖ∑ÊúâÂéüÂ≠êÊÄßÔºåËÄåÈîÅÂèØ‰ª•‰øùËØÅÊï¥‰∏™<strong>‰∏¥ÁïåÂå∫‰ª£Á†Å</strong>ÁöÑÊâßË°åÂÖ∑ÊúâÂéüÂ≠êÊÄß„ÄÇÊâÄ‰ª•<strong>Âú®ÂäüËÉΩ‰∏äÔºåÈîÅÊØîvolatileÊõ¥Âº∫Â§ßÔºõÂú®ÊÄßËÉΩ‰∏äÔºåvolatileÊõ¥Êúâ‰ºòÂäø</strong>„ÄÇ</p>
<p>Âú®Á¶ÅÊ≠¢ÈáçÊéíÂ∫èËøô‰∏ÄÁÇπ‰∏äÔºåvolatile‰πüÊòØÈùûÂ∏∏ÊúâÁî®ÁöÑ„ÄÇÊØîÂ¶ÇÊàë‰ª¨ÁÜüÊÇâÁöÑÂçï‰æãÊ®°ÂºèÔºåÂÖ∂‰∏≠Êúâ‰∏ÄÁßçÂÆûÁé∞ÊñπÂºèÊòØ‚ÄúÂèåÈáçÈîÅÊ£ÄÊü•‚ÄùÔºåÊØîÂ¶ÇËøôÊ†∑ÁöÑ‰ª£Á†ÅÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Singleton instance; <span class="hljs-comment">// ‰∏ç‰ΩøÁî®volatileÂÖ≥ÈîÆÂ≠ó</span><br>    <br>    <span class="hljs-comment">// ÂèåÈáçÈîÅÊ£ÄÈ™å</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) &#123; <span class="hljs-comment">// Á¨¨7Ë°å</span><br>            <span class="hljs-keyword">synchronized</span> (Singleton.class) &#123;<br>                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) &#123;<br>                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>(); <span class="hljs-comment">// Á¨¨10Ë°å</span><br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>Â¶ÇÊûúËøôÈáåÁöÑÂèòÈáèÂ£∞Êòé‰∏ç‰ΩøÁî®volatileÂÖ≥ÈîÆÂ≠óÔºåÊòØÂèØËÉΩ‰ºöÂèëÁîüÈîôËØØÁöÑ„ÄÇÂÆÉÂèØËÉΩ‰ºöË¢´ÈáçÊéíÂ∫èÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>(); <span class="hljs-comment">// Á¨¨10Ë°å</span><br><br><span class="hljs-comment">// ÂèØ‰ª•ÂàÜËß£‰∏∫‰ª•‰∏ã‰∏â‰∏™Ê≠•È™§</span><br><span class="hljs-number">1</span> memory=allocate();<span class="hljs-comment">// ÂàÜÈÖçÂÜÖÂ≠ò Áõ∏ÂΩì‰∫écÁöÑmalloc</span><br><span class="hljs-number">2</span> ctorInstanc(memory) <span class="hljs-comment">//ÂàùÂßãÂåñÂØπË±°</span><br><span class="hljs-number">3</span> s=memory <span class="hljs-comment">//ËÆæÁΩÆsÊåáÂêëÂàöÂàÜÈÖçÁöÑÂú∞ÂùÄ</span><br><br><span class="hljs-comment">// ‰∏äËø∞‰∏â‰∏™Ê≠•È™§ÂèØËÉΩ‰ºöË¢´ÈáçÊéíÂ∫è‰∏∫ 1-3-2Ôºå‰πüÂ∞±ÊòØÔºö</span><br><span class="hljs-number">1</span> memory=allocate();<span class="hljs-comment">// ÂàÜÈÖçÂÜÖÂ≠ò Áõ∏ÂΩì‰∫écÁöÑmalloc</span><br><span class="hljs-number">3</span> s=memory <span class="hljs-comment">//ËÆæÁΩÆsÊåáÂêëÂàöÂàÜÈÖçÁöÑÂú∞ÂùÄ</span><br><span class="hljs-number">2</span> ctorInstanc(memory) <span class="hljs-comment">//ÂàùÂßãÂåñÂØπË±°</span><br></code></pre></td></tr></table></figure>

<p>ËÄå‰∏ÄÊó¶ÂÅáËÆæÂèëÁîü‰∫ÜËøôÊ†∑ÁöÑÈáçÊéíÂ∫èÔºåÊØîÂ¶ÇÁ∫øÁ®ãAÂú®Á¨¨10Ë°åÊâßË°å‰∫ÜÊ≠•È™§1ÂíåÊ≠•È™§3Ôºå‰ΩÜÊòØÊ≠•È™§2ËøòÊ≤°ÊúâÊâßË°åÂÆå„ÄÇËøô‰∏™Êó∂ÂÄôÁ∫øÁ®ãAÊâßË°åÂà∞‰∫ÜÁ¨¨7Ë°åÔºåÂÆÉ‰ºöÂà§ÂÆöinstance‰∏ç‰∏∫Á©∫ÔºåÁÑ∂ÂêéÁõ¥Êé•ËøîÂõû‰∫Ü‰∏Ä‰∏™Êú™ÂàùÂßãÂåñÂÆåÊàêÁöÑinstanceÔºÅ</p>
<p>ÊâÄ‰ª•JSR-133ÂØπvolatileÂÅö‰∫ÜÂ¢ûÂº∫ÂêéÔºåvolatileÁöÑÁ¶ÅÊ≠¢ÈáçÊéíÂ∫èÂäüËÉΩËøòÊòØÈùûÂ∏∏ÊúâÁî®ÁöÑ„ÄÇ</p>
<p><strong>ÂèÇËÄÉËµÑÊñô</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/u010571316/article/details/64906481">happens-beforeËßÑÂàôÂíåas-if-serialËØ≠‰πâ</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/kg_2012/article/details/79059909">volatileÂÖ≥ÈîÆÂ≠óËØ¶Ëß£</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/humc/p/5426351.html">JavaÂèØËßÅÊÄßÊú∫Âà∂ÁöÑÂéüÁêÜ</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/summerZBH123/article/details/80547516">VolatileÂÖ≥ÈîÆÂ≠ó‰ªãÁªç</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhengbin/p/5654805.html">Java‰∏≠VolatileÂÖ≥ÈîÆÂ≠óËØ¶Ëß£</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/yjp198713/article/details/78839698">JVM(ÂçÅ‰∏Ä)JavaÊåá‰ª§ÈáçÊéíÂ∫è</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/leefreeman/p/7356030.html">Ê∑±ÂÖ•ÁêÜËß£JVMÔºà‰∫åÔºâ‚Äî‚ÄîÂÜÖÂ≠òÊ®°Âûã„ÄÅÂèØËßÅÊÄß„ÄÅÊåá‰ª§ÈáçÊéíÂ∫è</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/hqq2023623/article/details/51013468">JMM-volatile‰∏éÂÜÖÂ≠òÂ±èÈöú</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ef8de88b1343">Âπ∂ÂèëÂÖ≥ÈîÆÂ≠óvolatileÔºàÈáçÊéíÂ∫èÂíåÂÜÖÂ≠òÂ±èÈöúÔºâ</a></li>
</ul>
<h1 id="9-synchronized‰∏éÈîÅ"><a href="#9-synchronized‰∏éÈîÅ" class="headerlink" title="9 synchronized‰∏éÈîÅ"></a>9 synchronized‰∏éÈîÅ</h1><p>ËøôÁØáÊñáÁ´†Êàë‰ª¨Êù•ËÅä‰∏ÄËÅäJavaÂ§öÁ∫øÁ®ãÈáåÈù¢ÁöÑ‚ÄúÈîÅ‚Äù„ÄÇ</p>
<p>È¶ñÂÖàÈúÄË¶ÅÊòéÁ°ÆÁöÑ‰∏ÄÁÇπÊòØÔºö<strong>JavaÂ§öÁ∫øÁ®ãÁöÑÈîÅÈÉΩÊòØÂü∫‰∫éÂØπË±°ÁöÑ</strong>ÔºåJava‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂØπË±°ÈÉΩÂèØ‰ª•‰Ωú‰∏∫‰∏Ä‰∏™ÈîÅ„ÄÇ</p>
<p>ËøòÊúâ‰∏ÄÁÇπÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÊàë‰ª¨Â∏∏Âê¨Âà∞ÁöÑ<strong>Á±ªÈîÅ</strong>ÂÖ∂ÂÆû‰πüÊòØÂØπË±°ÈîÅ„ÄÇ</p>
<p>JavaÁ±ªÂè™Êúâ‰∏Ä‰∏™ClassÂØπË±°ÔºàÂèØ‰ª•ÊúâÂ§ö‰∏™ÂÆû‰æãÂØπË±°ÔºåÂ§ö‰∏™ÂÆû‰æãÂÖ±‰∫´Ëøô‰∏™ClassÂØπË±°ÔºâÔºåËÄåClassÂØπË±°‰πüÊòØÁâπÊÆäÁöÑJavaÂØπË±°„ÄÇÊâÄ‰ª•Êàë‰ª¨Â∏∏ËØ¥ÁöÑÁ±ªÈîÅÔºåÂÖ∂ÂÆûÂ∞±ÊòØClassÂØπË±°ÁöÑÈîÅ„ÄÇ</p>
<h2 id="9-1-SynchronizedÂÖ≥ÈîÆÂ≠ó"><a href="#9-1-SynchronizedÂÖ≥ÈîÆÂ≠ó" class="headerlink" title="9.1 SynchronizedÂÖ≥ÈîÆÂ≠ó"></a>9.1 SynchronizedÂÖ≥ÈîÆÂ≠ó</h2><p>ËØ¥Âà∞ÈîÅÔºåÊàë‰ª¨ÈÄöÂ∏∏‰ºöË∞àÂà∞<code>synchronized</code>Ëøô‰∏™ÂÖ≥ÈîÆÂ≠ó„ÄÇÂÆÉÁøªËØëÊàê‰∏≠ÊñáÂ∞±ÊòØ‚ÄúÂêåÊ≠•‚ÄùÁöÑÊÑèÊÄù„ÄÇ</p>
<p>Êàë‰ª¨ÈÄöÂ∏∏‰ΩøÁî®<code>synchronized</code>ÂÖ≥ÈîÆÂ≠óÊù•Áªô‰∏ÄÊÆµ‰ª£Á†ÅÊàñ‰∏Ä‰∏™ÊñπÊ≥ï‰∏äÈîÅ„ÄÇÂÆÉÈÄöÂ∏∏Êúâ‰ª•‰∏ã‰∏âÁßçÂΩ¢ÂºèÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ÂÖ≥ÈîÆÂ≠óÂú®ÂÆû‰æãÊñπÊ≥ï‰∏äÔºåÈîÅ‰∏∫ÂΩìÂâçÂÆû‰æã</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">instanceLock</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// code</span><br>&#125;<br><br><span class="hljs-comment">// ÂÖ≥ÈîÆÂ≠óÂú®ÈùôÊÄÅÊñπÊ≥ï‰∏äÔºåÈîÅ‰∏∫ÂΩìÂâçClassÂØπË±°</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">classLock</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// code</span><br>&#125;<br><br><span class="hljs-comment">// ÂÖ≥ÈîÆÂ≠óÂú®‰ª£Á†ÅÂùó‰∏äÔºåÈîÅ‰∏∫Êã¨Âè∑ÈáåÈù¢ÁöÑÂØπË±°</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">blockLock</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br>    <span class="hljs-keyword">synchronized</span> (o) &#123;<br>        <span class="hljs-comment">// code</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Êàë‰ª¨ËøôÈáå‰ªãÁªç‰∏Ä‰∏ã‚Äú‰∏¥ÁïåÂå∫‚ÄùÁöÑÊ¶ÇÂøµ„ÄÇÊâÄË∞ì‚Äú‰∏¥ÁïåÂå∫‚ÄùÔºåÊåáÁöÑÊòØÊüê‰∏ÄÂùó‰ª£Á†ÅÂå∫ÂüüÔºåÂÆÉÂêå‰∏ÄÊó∂ÂàªÂè™ËÉΩÁî±‰∏Ä‰∏™Á∫øÁ®ãÊâßË°å„ÄÇÂú®‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåÂ¶ÇÊûú<code>synchronized</code>ÂÖ≥ÈîÆÂ≠óÂú®ÊñπÊ≥ï‰∏äÔºåÈÇ£‰∏¥ÁïåÂå∫Â∞±ÊòØÊï¥‰∏™ÊñπÊ≥ïÂÜÖÈÉ®„ÄÇËÄåÂ¶ÇÊûúÊòØ‰ΩøÁî®synchronized‰ª£Á†ÅÂùóÔºåÈÇ£‰∏¥ÁïåÂå∫Â∞±ÊåáÁöÑÊòØ‰ª£Á†ÅÂùóÂÜÖÈÉ®ÁöÑÂå∫Âüü„ÄÇ</p>
<p>ÈÄöËøá‰∏äÈù¢ÁöÑ‰æãÂ≠êÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Ôºå‰∏ãÈù¢Ëøô‰∏§‰∏™ÂÜôÊ≥ïÂÖ∂ÂÆûÊòØÁ≠â‰ª∑ÁöÑ‰ΩúÁî®Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ÂÖ≥ÈîÆÂ≠óÂú®ÂÆû‰æãÊñπÊ≥ï‰∏äÔºåÈîÅ‰∏∫ÂΩìÂâçÂÆû‰æã</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">instanceLock</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// code</span><br>&#125;<br><br><span class="hljs-comment">// ÂÖ≥ÈîÆÂ≠óÂú®‰ª£Á†ÅÂùó‰∏äÔºåÈîÅ‰∏∫Êã¨Âè∑ÈáåÈù¢ÁöÑÂØπË±°</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">blockLock</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>        <span class="hljs-comment">// code</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ÂêåÁêÜÔºå‰∏ãÈù¢Ëøô‰∏§‰∏™ÊñπÊ≥ï‰πüÂ∫îËØ•ÊòØÁ≠â‰ª∑ÁöÑÔºö</p>
<p>&#x2F;&#x2F; ÂÖ≥ÈîÆÂ≠óÂú®ÈùôÊÄÅÊñπÊ≥ï‰∏äÔºåÈîÅ‰∏∫ÂΩìÂâçClassÂØπË±°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">classLock</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// code</span><br>&#125;<br><br><span class="hljs-comment">// ÂÖ≥ÈîÆÂ≠óÂú®‰ª£Á†ÅÂùó‰∏äÔºåÈîÅ‰∏∫Êã¨Âè∑ÈáåÈù¢ÁöÑÂØπË±°</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">blockLock</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>.getClass()) &#123;<br>        <span class="hljs-comment">// code</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="9-2-Âá†ÁßçÈîÅ"><a href="#9-2-Âá†ÁßçÈîÅ" class="headerlink" title="9.2 Âá†ÁßçÈîÅ"></a>9.2 Âá†ÁßçÈîÅ</h2><p>Java 6 ‰∏∫‰∫ÜÂáèÂ∞ëËé∑ÂæóÈîÅÂíåÈáäÊîæÈîÅÂ∏¶Êù•ÁöÑÊÄßËÉΩÊ∂àËÄóÔºåÂºïÂÖ•‰∫Ü‚ÄúÂÅèÂêëÈîÅ‚ÄùÂíå‚ÄúËΩªÈáèÁ∫ßÈîÅ‚Äú„ÄÇÂú®Java 6 ‰ª•ÂâçÔºåÊâÄÊúâÁöÑÈîÅÈÉΩÊòØ‚ÄùÈáçÈáèÁ∫ß‚ÄúÈîÅ„ÄÇÊâÄ‰ª•Âú®Java 6 ÂèäÂÖ∂‰ª•ÂêéÔºå‰∏Ä‰∏™ÂØπË±°ÂÖ∂ÂÆûÊúâÂõõÁßçÈîÅÁä∂ÊÄÅÔºåÂÆÉ‰ª¨Á∫ßÂà´Áî±‰ΩéÂà∞È´ò‰æùÊ¨°ÊòØÔºö</p>
<ol>
<li>Êó†ÈîÅÁä∂ÊÄÅ</li>
<li>ÂÅèÂêëÈîÅÁä∂ÊÄÅ</li>
<li>ËΩªÈáèÁ∫ßÈîÅÁä∂ÊÄÅ</li>
<li>ÈáçÈáèÁ∫ßÈîÅÁä∂ÊÄÅ</li>
</ol>
<p>Êó†ÈîÅÂ∞±ÊòØÊ≤°ÊúâÂØπËµÑÊ∫êËøõË°åÈîÅÂÆöÔºå‰ªª‰ΩïÁ∫øÁ®ãÈÉΩÂèØ‰ª•Â∞ùËØïÂéª‰øÆÊîπÂÆÉÔºåÊó†ÈîÅÂú®ËøôÈáå‰∏çÂÜçÁªÜËÆ≤„ÄÇ</p>
<p>Âá†ÁßçÈîÅ‰ºöÈöèÁùÄÁ´û‰∫âÊÉÖÂÜµÈÄêÊ∏êÂçáÁ∫ßÔºåÈîÅÁöÑÂçáÁ∫ßÂæàÂÆπÊòìÂèëÁîüÔºå‰ΩÜÊòØÈîÅÈôçÁ∫ßÂèëÁîüÁöÑÊù°‰ª∂‰ºöÊØîËæÉËãõÂàªÔºåÈîÅÈôçÁ∫ßÂèëÁîüÂú®Stop The WorldÊúüÈó¥ÔºåÂΩìJVMËøõÂÖ•ÂÆâÂÖ®ÁÇπÁöÑÊó∂ÂÄôÔºå‰ºöÊ£ÄÊü•ÊòØÂê¶ÊúâÈó≤ÁΩÆÁöÑÈîÅÔºåÁÑ∂ÂêéËøõË°åÈôçÁ∫ß„ÄÇ</p>
<blockquote>
<p>ÂÖ≥‰∫éÈîÅÈôçÁ∫ßÊúâ‰∏§ÁÇπËØ¥ÊòéÔºö</p>
<p>1.‰∏çÂêå‰∫éÂ§ßÈÉ®ÂàÜÊñáÁ´†ËØ¥ÈîÅ‰∏çËÉΩÈôçÁ∫ßÔºåÂÆûÈôÖ‰∏äHotSpot JVM ÊòØÊîØÊåÅÈîÅÈôçÁ∫ßÁöÑÔºåÊñáÊú´ÊúâÈìæÊé•„ÄÇ</p>
<p>2.‰∏äÈù¢ÊèêÂà∞ÁöÑStop The WorldÊúüÈó¥Ôºå‰ª•ÂèäÂÆâÂÖ®ÁÇπÔºåËøô‰∫õÁü•ËØÜÊòØÂ±û‰∫éJVMÁöÑÁü•ËØÜËåÉÁï¥ÔºåÊú¨Êñá‰∏çÂÅöÁªÜËÆ≤„ÄÇ</p>
</blockquote>
<p>‰∏ãÈù¢ÂàÜÂà´‰ªãÁªçËøôÂá†ÁßçÈîÅ‰ª•ÂèäÂÆÉ‰ª¨‰πãÈó¥ÁöÑÂçáÁ∫ß„ÄÇ</p>
<h3 id="9-2-1-JavaÂØπË±°Â§¥"><a href="#9-2-1-JavaÂØπË±°Â§¥" class="headerlink" title="9.2.1 JavaÂØπË±°Â§¥"></a>9.2.1 JavaÂØπË±°Â§¥</h3><p>ÂâçÈù¢Êàë‰ª¨ÊèêÂà∞ÔºåJavaÁöÑÈîÅÈÉΩÊòØÂü∫‰∫éÂØπË±°ÁöÑ„ÄÇÈ¶ñÂÖàÊàë‰ª¨Êù•ÁúãÁúã‰∏Ä‰∏™ÂØπË±°ÁöÑ‚ÄúÈîÅ‚ÄùÁöÑ‰ø°ÊÅØÊòØÂ≠òÊîæÂú®‰ªÄ‰πàÂú∞ÊñπÁöÑ„ÄÇ</p>
<p>ÊØè‰∏™JavaÂØπË±°ÈÉΩÊúâÂØπË±°Â§¥„ÄÇÂ¶ÇÊûúÊòØÈùûÊï∞ÁªÑÁ±ªÂûãÔºåÂàôÁî®2‰∏™Â≠óÂÆΩÊù•Â≠òÂÇ®ÂØπË±°Â§¥ÔºåÂ¶ÇÊûúÊòØÊï∞ÁªÑÔºåÂàô‰ºöÁî®3‰∏™Â≠óÂÆΩÊù•Â≠òÂÇ®ÂØπË±°Â§¥„ÄÇÂú®32‰ΩçÂ§ÑÁêÜÂô®‰∏≠Ôºå‰∏Ä‰∏™Â≠óÂÆΩÊòØ32‰ΩçÔºõÂú®64‰ΩçËôöÊãüÊú∫‰∏≠Ôºå‰∏Ä‰∏™Â≠óÂÆΩÊòØ64‰Ωç„ÄÇÂØπË±°Â§¥ÁöÑÂÜÖÂÆπÂ¶Ç‰∏ãË°®Ôºö</p>
<p><img src="https://i0.hdslb.com/bfs/album/8e35357ba0b509d9d88cf613bebafd871b1714cb.png" srcset="/Hexo/img/loading.gif" lazyload alt="image-20220220221534591"></p>
<p>Êàë‰ª¨‰∏ªË¶ÅÊù•ÁúãÁúãMark WordÁöÑÊ†ºÂºèÔºö</p>
<p><img src="https://i0.hdslb.com/bfs/album/2d8b4d0fa796ce572f3478dbbb772e13254eec17.png" srcset="/Hexo/img/loading.gif" lazyload alt="image-20220220221616792"></p>
<p>ÂèØ‰ª•ÁúãÂà∞ÔºåÂΩìÂØπË±°Áä∂ÊÄÅ‰∏∫ÂÅèÂêëÈîÅÊó∂Ôºå<code>Mark Word</code>Â≠òÂÇ®ÁöÑÊòØÂÅèÂêëÁöÑÁ∫øÁ®ãIDÔºõÂΩìÁä∂ÊÄÅ‰∏∫ËΩªÈáèÁ∫ßÈîÅÊó∂Ôºå<code>Mark Word</code>Â≠òÂÇ®ÁöÑÊòØÊåáÂêëÁ∫øÁ®ãÊ†à‰∏≠<code>Lock Record</code>ÁöÑÊåáÈíàÔºõÂΩìÁä∂ÊÄÅ‰∏∫ÈáçÈáèÁ∫ßÈîÅÊó∂Ôºå<code>Mark Word</code>‰∏∫ÊåáÂêëÂ†Ü‰∏≠ÁöÑmonitorÂØπË±°ÁöÑÊåáÈíà„ÄÇ</p>
<h3 id="9-2-2-ÂÅèÂêëÈîÅ"><a href="#9-2-2-ÂÅèÂêëÈîÅ" class="headerlink" title="9.2.2 ÂÅèÂêëÈîÅ"></a>9.2.2 ÂÅèÂêëÈîÅ</h3><p>HotspotÁöÑ‰ΩúËÄÖÁªèËøá‰ª•ÂæÄÁöÑÁ†îÁ©∂ÂèëÁé∞Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ã<strong>ÈîÅ‰∏ç‰ªÖ‰∏çÂ≠òÂú®Â§öÁ∫øÁ®ãÁ´û‰∫âÔºåËÄå‰∏îÊÄªÊòØÁî±Âêå‰∏ÄÁ∫øÁ®ãÂ§öÊ¨°Ëé∑Âæó</strong>Ôºå‰∫éÊòØÂºïÂÖ•‰∫ÜÂÅèÂêëÈîÅ„ÄÇ</p>
<p>ÂÅèÂêëÈîÅ‰ºöÂÅèÂêë‰∫éÁ¨¨‰∏Ä‰∏™ËÆøÈóÆÈîÅÁöÑÁ∫øÁ®ãÔºåÂ¶ÇÊûúÂú®Êé•‰∏ãÊù•ÁöÑËøêË°åËøáÁ®ã‰∏≠ÔºåËØ•ÈîÅÊ≤°ÊúâË¢´ÂÖ∂‰ªñÁöÑÁ∫øÁ®ãËÆøÈóÆÔºåÂàôÊåÅÊúâÂÅèÂêëÈîÅÁöÑÁ∫øÁ®ãÂ∞ÜÊ∞∏Ëøú‰∏çÈúÄË¶ÅËß¶ÂèëÂêåÊ≠•„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºå<strong>ÂÅèÂêëÈîÅÂú®ËµÑÊ∫êÊó†Á´û‰∫âÊÉÖÂÜµ‰∏ãÊ∂àÈô§‰∫ÜÂêåÊ≠•ËØ≠Âè•ÔºåËøûCASÊìç‰ΩúÈÉΩ‰∏çÂÅö‰∫ÜÔºåÊèêÈ´ò‰∫ÜÁ®ãÂ∫èÁöÑËøêË°åÊÄßËÉΩ„ÄÇ</strong></p>
<blockquote>
<p>Â§ßÁôΩËØùÂ∞±ÊòØÂØπÈîÅÁΩÆ‰∏™ÂèòÈáèÔºåÂ¶ÇÊûúÂèëÁé∞‰∏∫trueÔºå‰ª£Ë°®ËµÑÊ∫êÊó†Á´û‰∫âÔºåÂàôÊó†ÈúÄÂÜçËµ∞ÂêÑÁßçÂä†ÈîÅ&#x2F;Ëß£ÈîÅÊµÅÁ®ã„ÄÇÂ¶ÇÊûú‰∏∫falseÔºå‰ª£Ë°®Â≠òÂú®ÂÖ∂‰ªñÁ∫øÁ®ãÁ´û‰∫âËµÑÊ∫êÔºåÈÇ£‰πàÂ∞±‰ºöËµ∞ÂêéÈù¢ÁöÑÊµÅÁ®ã„ÄÇ</p>
</blockquote>
<h3 id="ÂÆûÁé∞ÂéüÁêÜ"><a href="#ÂÆûÁé∞ÂéüÁêÜ" class="headerlink" title="ÂÆûÁé∞ÂéüÁêÜ"></a><strong>ÂÆûÁé∞ÂéüÁêÜ</strong></h3><p>‰∏Ä‰∏™Á∫øÁ®ãÂú®Á¨¨‰∏ÄÊ¨°ËøõÂÖ•ÂêåÊ≠•ÂùóÊó∂Ôºå‰ºöÂú®ÂØπË±°Â§¥ÂíåÊ†àÂ∏ß‰∏≠ÁöÑÈîÅËÆ∞ÂΩïÈáåÂ≠òÂÇ®ÈîÅÁöÑÂÅèÂêëÁöÑÁ∫øÁ®ãID„ÄÇÂΩì‰∏ãÊ¨°ËØ•Á∫øÁ®ãËøõÂÖ•Ëøô‰∏™ÂêåÊ≠•ÂùóÊó∂Ôºå‰ºöÂéªÊ£ÄÊü•ÈîÅÁöÑMark WordÈáåÈù¢ÊòØ‰∏çÊòØÊîæÁöÑËá™Â∑±ÁöÑÁ∫øÁ®ãID„ÄÇ</p>
<p>Â¶ÇÊûúÊòØÔºåË°®ÊòéËØ•Á∫øÁ®ãÂ∑≤ÁªèËé∑Âæó‰∫ÜÈîÅÔºå‰ª•ÂêéËØ•Á∫øÁ®ãÂú®ËøõÂÖ•ÂíåÈÄÄÂá∫ÂêåÊ≠•ÂùóÊó∂‰∏çÈúÄË¶ÅËä±Ë¥πCASÊìç‰ΩúÊù•Âä†ÈîÅÂíåËß£ÈîÅ ÔºõÂ¶ÇÊûú‰∏çÊòØÔºåÂ∞±‰ª£Ë°®ÊúâÂè¶‰∏Ä‰∏™Á∫øÁ®ãÊù•Á´û‰∫âËøô‰∏™ÂÅèÂêëÈîÅ„ÄÇËøô‰∏™Êó∂ÂÄô‰ºöÂ∞ùËØï‰ΩøÁî®CASÊù•ÊõøÊç¢Mark WordÈáåÈù¢ÁöÑÁ∫øÁ®ãID‰∏∫Êñ∞Á∫øÁ®ãÁöÑIDÔºåËøô‰∏™Êó∂ÂÄôË¶ÅÂàÜ‰∏§ÁßçÊÉÖÂÜµÔºö</p>
<p>- </p>
<p>  ÊàêÂäüÔºåË°®Á§∫‰πãÂâçÁöÑÁ∫øÁ®ã‰∏çÂ≠òÂú®‰∫ÜÔºå Mark WordÈáåÈù¢ÁöÑÁ∫øÁ®ãID‰∏∫Êñ∞Á∫øÁ®ãÁöÑIDÔºåÈîÅ‰∏ç‰ºöÂçáÁ∫ßÔºå‰ªçÁÑ∂‰∏∫ÂÅèÂêëÈîÅÔºõ</p>
<p>- </p>
<p>  Â§±Ë¥•ÔºåË°®Á§∫‰πãÂâçÁöÑÁ∫øÁ®ã‰ªçÁÑ∂Â≠òÂú®ÔºåÈÇ£‰πàÊöÇÂÅú‰πãÂâçÁöÑÁ∫øÁ®ãÔºåËÆæÁΩÆÂÅèÂêëÈîÅÊ†áËØÜ‰∏∫0ÔºåÂπ∂ËÆæÁΩÆÈîÅÊ†áÂøó‰Ωç‰∏∫00ÔºåÂçáÁ∫ß‰∏∫ËΩªÈáèÁ∫ßÈîÅÔºå‰ºöÊåâÁÖßËΩªÈáèÁ∫ßÈîÅÁöÑÊñπÂºèËøõË°åÁ´û‰∫âÈîÅ„ÄÇ</p>
<blockquote>
<p>CAS: Compare and Swap</p>
<p>ÊØîËæÉÂπ∂ËÆæÁΩÆ„ÄÇÁî®‰∫éÂú®Á°¨‰ª∂Â±ÇÈù¢‰∏äÊèê‰æõÂéüÂ≠êÊÄßÊìç‰Ωú„ÄÇÂú® Intel Â§ÑÁêÜÂô®‰∏≠ÔºåÊØîËæÉÂπ∂‰∫§Êç¢ÈÄöËøáÊåá‰ª§cmpxchgÂÆûÁé∞„ÄÇ ÊØîËæÉÊòØÂê¶ÂíåÁªôÂÆöÁöÑÊï∞ÂÄº‰∏ÄËá¥ÔºåÂ¶ÇÊûú‰∏ÄËá¥Âàô‰øÆÊîπÔºå‰∏ç‰∏ÄËá¥Âàô‰∏ç‰øÆÊîπ„ÄÇ</p>
</blockquote>
<p>Á∫øÁ®ãÁ´û‰∫âÂÅèÂêëÈîÅÁöÑËøáÁ®ãÂ¶Ç‰∏ãÔºö</p>
<p><img src="https://i0.hdslb.com/bfs/album/d4d70e9c5863c8bf65e3d790584754f4f1b4b133.png" srcset="/Hexo/img/loading.gif" lazyload alt="image-20220220221700114"></p>
<p>Âõæ‰∏≠Ê∂âÂèäÂà∞‰∫Ülock recordÊåáÈíàÊåáÂêëÂΩìÂâçÂ†ÜÊ†à‰∏≠ÁöÑÊúÄËøë‰∏Ä‰∏™lock recordÔºåÊòØËΩªÈáèÁ∫ßÈîÅÊåâÁÖßÂÖàÊù•ÂÖàÊúçÂä°ÁöÑÊ®°ÂºèËøõË°å‰∫ÜËΩªÈáèÁ∫ßÈîÅÁöÑÂä†ÈîÅ„ÄÇ</p>
<h3 id="Êí§ÈîÄÂÅèÂêëÈîÅ"><a href="#Êí§ÈîÄÂÅèÂêëÈîÅ" class="headerlink" title="Êí§ÈîÄÂÅèÂêëÈîÅ"></a>Êí§ÈîÄÂÅèÂêëÈîÅ</h3><p>ÂÅèÂêëÈîÅ‰ΩøÁî®‰∫Ü‰∏ÄÁßç<strong>Á≠âÂà∞Á´û‰∫âÂá∫Áé∞ÊâçÈáäÊîæÈîÅÁöÑÊú∫Âà∂</strong>ÔºåÊâÄ‰ª•ÂΩìÂÖ∂‰ªñÁ∫øÁ®ãÂ∞ùËØïÁ´û‰∫âÂÅèÂêëÈîÅÊó∂Ôºå ÊåÅÊúâÂÅèÂêëÈîÅÁöÑÁ∫øÁ®ãÊâç‰ºöÈáäÊîæÈîÅ„ÄÇ</p>
<p>ÂÅèÂêëÈîÅÂçáÁ∫ßÊàêËΩªÈáèÁ∫ßÈîÅÊó∂Ôºå‰ºöÊöÇÂÅúÊã•ÊúâÂÅèÂêëÈîÅÁöÑÁ∫øÁ®ãÔºåÈáçÁΩÆÂÅèÂêëÈîÅÊ†áËØÜÔºåËøô‰∏™ËøáÁ®ãÁúãËµ∑Êù•ÂÆπÊòìÔºåÂÆûÂàôÂºÄÈîÄËøòÊòØÂæàÂ§ßÁöÑÔºåÂ§ßÊ¶ÇÁöÑËøáÁ®ãÂ¶Ç‰∏ãÔºö</p>
<ol>
<li>Âú®‰∏Ä‰∏™ÂÆâÂÖ®ÁÇπÔºàÂú®Ëøô‰∏™Êó∂Èó¥ÁÇπ‰∏äÊ≤°ÊúâÂ≠óËäÇÁ†ÅÊ≠£Âú®ÊâßË°åÔºâÂÅúÊ≠¢Êã•ÊúâÈîÅÁöÑÁ∫øÁ®ã„ÄÇ</li>
<li>ÈÅçÂéÜÁ∫øÁ®ãÊ†àÔºåÂ¶ÇÊûúÂ≠òÂú®ÈîÅËÆ∞ÂΩïÁöÑËØùÔºåÈúÄË¶Å‰øÆÂ§çÈîÅËÆ∞ÂΩïÂíåMark WordÔºå‰ΩøÂÖ∂ÂèòÊàêÊó†ÈîÅÁä∂ÊÄÅ„ÄÇ</li>
<li>Âî§ÈÜíË¢´ÂÅúÊ≠¢ÁöÑÁ∫øÁ®ãÔºåÂ∞ÜÂΩìÂâçÈîÅÂçáÁ∫ßÊàêËΩªÈáèÁ∫ßÈîÅ„ÄÇ</li>
</ol>
<p>ÊâÄ‰ª•ÔºåÂ¶ÇÊûúÂ∫îÁî®Á®ãÂ∫èÈáåÊâÄÊúâÁöÑÈîÅÈÄöÂ∏∏Âá∫‰∫éÁ´û‰∫âÁä∂ÊÄÅÔºåÈÇ£‰πàÂÅèÂêëÈîÅÂ∞±‰ºöÊòØ‰∏ÄÁßçÁ¥ØËµòÔºåÂØπ‰∫éËøôÁßçÊÉÖÂÜµÔºåÊàë‰ª¨ÂèØ‰ª•‰∏ÄÂºÄÂßãÂ∞±ÊääÂÅèÂêëÈîÅËøô‰∏™ÈªòËÆ§ÂäüËÉΩÁªôÂÖ≥Èó≠Ôºö</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">-XX:<span class="hljs-attribute">UseBiasedLocking</span>=<span class="hljs-literal">false</span>„ÄÇ<br></code></pre></td></tr></table></figure>

<p>Copied!</p>
<p>‰∏ãÈù¢Ëøô‰∏™ÁªèÂÖ∏ÁöÑÂõæÊÄªÁªì‰∫ÜÂÅèÂêëÈîÅÁöÑËé∑ÂæóÂíåÊí§ÈîÄÔºö</p>
<p><img src="https://i0.hdslb.com/bfs/album/65fba29c6c40013d4f6e549af766afdaf27f6a72.png" srcset="/Hexo/img/loading.gif" lazyload></p>
<h3 id="9-2-3-ËΩªÈáèÁ∫ßÈîÅ"><a href="#9-2-3-ËΩªÈáèÁ∫ßÈîÅ" class="headerlink" title="9.2.3 ËΩªÈáèÁ∫ßÈîÅ"></a>9.2.3 ËΩªÈáèÁ∫ßÈîÅ</h3><p>Â§ö‰∏™Á∫øÁ®ãÂú®‰∏çÂêåÊó∂ÊÆµËé∑ÂèñÂêå‰∏ÄÊääÈîÅÔºåÂç≥‰∏çÂ≠òÂú®ÈîÅÁ´û‰∫âÁöÑÊÉÖÂÜµÔºå‰πüÂ∞±Ê≤°ÊúâÁ∫øÁ®ãÈòªÂ°û„ÄÇÈíàÂØπËøôÁßçÊÉÖÂÜµÔºåJVMÈááÁî®ËΩªÈáèÁ∫ßÈîÅÊù•ÈÅøÂÖçÁ∫øÁ®ãÁöÑÈòªÂ°û‰∏éÂî§ÈÜí„ÄÇ</p>
<h3 id="ËΩªÈáèÁ∫ßÈîÅÁöÑÂä†ÈîÅ"><a href="#ËΩªÈáèÁ∫ßÈîÅÁöÑÂä†ÈîÅ" class="headerlink" title="ËΩªÈáèÁ∫ßÈîÅÁöÑÂä†ÈîÅ"></a>ËΩªÈáèÁ∫ßÈîÅÁöÑÂä†ÈîÅ</h3><p>JVM‰ºö‰∏∫ÊØè‰∏™Á∫øÁ®ãÂú®ÂΩìÂâçÁ∫øÁ®ãÁöÑÊ†àÂ∏ß‰∏≠ÂàõÂª∫Áî®‰∫éÂ≠òÂÇ®ÈîÅËÆ∞ÂΩïÁöÑÁ©∫Èó¥ÔºåÊàë‰ª¨Áß∞‰∏∫Displaced Mark Word„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™Á∫øÁ®ãËé∑ÂæóÈîÅÁöÑÊó∂ÂÄôÂèëÁé∞ÊòØËΩªÈáèÁ∫ßÈîÅÔºå‰ºöÊääÈîÅÁöÑMark WordÂ§çÂà∂Âà∞Ëá™Â∑±ÁöÑDisplaced Mark WordÈáåÈù¢„ÄÇ</p>
<p>ÁÑ∂ÂêéÁ∫øÁ®ãÂ∞ùËØïÁî®CASÂ∞ÜÈîÅÁöÑMark WordÊõøÊç¢‰∏∫ÊåáÂêëÈîÅËÆ∞ÂΩïÁöÑÊåáÈíà„ÄÇÂ¶ÇÊûúÊàêÂäüÔºåÂΩìÂâçÁ∫øÁ®ãËé∑ÂæóÈîÅÔºåÂ¶ÇÊûúÂ§±Ë¥•ÔºåË°®Á§∫Mark WordÂ∑≤ÁªèË¢´ÊõøÊç¢Êàê‰∫ÜÂÖ∂‰ªñÁ∫øÁ®ãÁöÑÈîÅËÆ∞ÂΩïÔºåËØ¥ÊòéÂú®‰∏éÂÖ∂ÂÆÉÁ∫øÁ®ãÁ´û‰∫âÈîÅÔºåÂΩìÂâçÁ∫øÁ®ãÂ∞±Â∞ùËØï‰ΩøÁî®Ëá™ÊóãÊù•Ëé∑ÂèñÈîÅ„ÄÇ</p>
<blockquote>
<p>Ëá™ÊóãÔºö‰∏çÊñ≠Â∞ùËØïÂéªËé∑ÂèñÈîÅÔºå‰∏ÄËà¨Áî®Âæ™ÁéØÊù•ÂÆûÁé∞„ÄÇ</p>
</blockquote>
<p>Ëá™ÊóãÊòØÈúÄË¶ÅÊ∂àËÄóCPUÁöÑÔºåÂ¶ÇÊûú‰∏ÄÁõ¥Ëé∑Âèñ‰∏çÂà∞ÈîÅÁöÑËØùÔºåÈÇ£ËØ•Á∫øÁ®ãÂ∞±‰∏ÄÁõ¥Â§ÑÂú®Ëá™ÊóãÁä∂ÊÄÅÔºåÁôΩÁôΩÊµ™Ë¥πCPUËµÑÊ∫ê„ÄÇËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÊúÄÁÆÄÂçïÁöÑÂäûÊ≥ïÂ∞±ÊòØÊåáÂÆöËá™ÊóãÁöÑÊ¨°Êï∞Ôºå‰æãÂ¶ÇËÆ©ÂÖ∂Âæ™ÁéØ10Ê¨°ÔºåÂ¶ÇÊûúËøòÊ≤°Ëé∑ÂèñÂà∞ÈîÅÂ∞±ËøõÂÖ•ÈòªÂ°ûÁä∂ÊÄÅ„ÄÇ</p>
<p>‰ΩÜÊòØJDKÈááÁî®‰∫ÜÊõ¥ËÅ™ÊòéÁöÑÊñπÂºè‚Äî‚ÄîÈÄÇÂ∫îÊÄßËá™ÊóãÔºåÁÆÄÂçïÊù•ËØ¥Â∞±ÊòØÁ∫øÁ®ãÂ¶ÇÊûúËá™ÊóãÊàêÂäü‰∫ÜÔºåÂàô‰∏ãÊ¨°Ëá™ÊóãÁöÑÊ¨°Êï∞‰ºöÊõ¥Â§öÔºåÂ¶ÇÊûúËá™ÊóãÂ§±Ë¥•‰∫ÜÔºåÂàôËá™ÊóãÁöÑÊ¨°Êï∞Â∞±‰ºöÂáèÂ∞ë„ÄÇ</p>
<p>Ëá™Êóã‰πü‰∏çÊòØ‰∏ÄÁõ¥ËøõË°å‰∏ãÂéªÁöÑÔºåÂ¶ÇÊûúËá™ÊóãÂà∞‰∏ÄÂÆöÁ®ãÂ∫¶ÔºàÂíåJVM„ÄÅÊìç‰ΩúÁ≥ªÁªüÁõ∏ÂÖ≥ÔºâÔºå‰æùÁÑ∂Ê≤°ÊúâËé∑ÂèñÂà∞ÈîÅÔºåÁß∞‰∏∫Ëá™ÊóãÂ§±Ë¥•ÔºåÈÇ£‰πàËøô‰∏™Á∫øÁ®ã‰ºöÈòªÂ°û„ÄÇÂêåÊó∂Ëøô‰∏™ÈîÅÂ∞±‰ºö<strong>ÂçáÁ∫ßÊàêÈáçÈáèÁ∫ßÈîÅ</strong>„ÄÇ</p>
<p><strong>ËΩªÈáèÁ∫ßÈîÅÁöÑÈáäÊîæÔºö</strong></p>
<p>Âú®ÈáäÊîæÈîÅÊó∂ÔºåÂΩìÂâçÁ∫øÁ®ã‰ºö‰ΩøÁî®CASÊìç‰ΩúÂ∞ÜDisplaced Mark WordÁöÑÂÜÖÂÆπÂ§çÂà∂ÂõûÈîÅÁöÑMark WordÈáåÈù¢„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÂèëÁîüÁ´û‰∫âÔºåÈÇ£‰πàËøô‰∏™Â§çÂà∂ÁöÑÊìç‰Ωú‰ºöÊàêÂäü„ÄÇÂ¶ÇÊûúÊúâÂÖ∂‰ªñÁ∫øÁ®ãÂõ†‰∏∫Ëá™ÊóãÂ§öÊ¨°ÂØºËá¥ËΩªÈáèÁ∫ßÈîÅÂçáÁ∫ßÊàê‰∫ÜÈáçÈáèÁ∫ßÈîÅÔºåÈÇ£‰πàCASÊìç‰Ωú‰ºöÂ§±Ë¥•ÔºåÊ≠§Êó∂‰ºöÈáäÊîæÈîÅÂπ∂Âî§ÈÜíË¢´ÈòªÂ°ûÁöÑÁ∫øÁ®ã„ÄÇ</p>
<p>‰∏ÄÂº†ÂõæËØ¥ÊòéÂä†ÈîÅÂíåÈáäÊîæÈîÅÁöÑËøáÁ®ãÔºö</p>
<p><img src="https://i0.hdslb.com/bfs/album/febc15a4e52409aaa0f476ebf32ca6825a7e9626.png" srcset="/Hexo/img/loading.gif" lazyload></p>
<h3 id="9-2-4-ÈáçÈáèÁ∫ßÈîÅ"><a href="#9-2-4-ÈáçÈáèÁ∫ßÈîÅ" class="headerlink" title="9.2.4 ÈáçÈáèÁ∫ßÈîÅ"></a>9.2.4 ÈáçÈáèÁ∫ßÈîÅ</h3><p>ÈáçÈáèÁ∫ßÈîÅ‰æùËµñ‰∫éÊìç‰ΩúÁ≥ªÁªüÁöÑ‰∫íÊñ•ÈáèÔºàmutexÔºâ ÂÆûÁé∞ÁöÑÔºåËÄåÊìç‰ΩúÁ≥ªÁªü‰∏≠Á∫øÁ®ãÈó¥Áä∂ÊÄÅÁöÑËΩ¨Êç¢ÈúÄË¶ÅÁõ∏ÂØπÊØîËæÉÈïøÁöÑÊó∂Èó¥ÔºåÊâÄ‰ª•ÈáçÈáèÁ∫ßÈîÅÊïàÁéáÂæà‰ΩéÔºå‰ΩÜË¢´ÈòªÂ°ûÁöÑÁ∫øÁ®ã‰∏ç‰ºöÊ∂àËÄóCPU„ÄÇ</p>
<p>ÂâçÈù¢ËØ¥Âà∞ÔºåÊØè‰∏Ä‰∏™ÂØπË±°ÈÉΩÂèØ‰ª•ÂΩìÂÅö‰∏Ä‰∏™ÈîÅÔºåÂΩìÂ§ö‰∏™Á∫øÁ®ãÂêåÊó∂ËØ∑Ê±ÇÊüê‰∏™ÂØπË±°ÈîÅÊó∂ÔºåÂØπË±°ÈîÅ‰ºöËÆæÁΩÆÂá†ÁßçÁä∂ÊÄÅÁî®Êù•Âå∫ÂàÜËØ∑Ê±ÇÁöÑÁ∫øÁ®ãÔºö</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">Contention</span> <span class="hljs-built_in">List</span>ÔºöÊâÄÊúâËØ∑Ê±ÇÈîÅÁöÑÁ∫øÁ®ãÂ∞ÜË¢´È¶ñÂÖàÊîæÁΩÆÂà∞ËØ•Á´û‰∫âÈòüÂàó<br><span class="hljs-variable">Entry</span> <span class="hljs-built_in">List</span>Ôºö<span class="hljs-variable">Contention</span> <span class="hljs-built_in">List</span>‰∏≠ÈÇ£‰∫õÊúâËµÑÊ†ºÊàê‰∏∫ÂÄôÈÄâ‰∫∫ÁöÑÁ∫øÁ®ãË¢´ÁßªÂà∞<span class="hljs-variable">Entry</span> <span class="hljs-built_in">List</span><br><span class="hljs-variable">Wait</span> <span class="hljs-built_in">Set</span>ÔºöÈÇ£‰∫õË∞ÉÁî®<span class="hljs-variable">wait</span>ÊñπÊ≥ïË¢´ÈòªÂ°ûÁöÑÁ∫øÁ®ãË¢´ÊîæÁΩÆÂà∞<span class="hljs-variable">Wait</span> <span class="hljs-built_in">Set</span><br><span class="hljs-variable">OnDeck</span>Ôºö‰ªª‰ΩïÊó∂ÂàªÊúÄÂ§öÂè™ËÉΩÊúâ‰∏Ä‰∏™Á∫øÁ®ãÊ≠£Âú®Á´û‰∫âÈîÅÔºåËØ•Á∫øÁ®ãÁß∞‰∏∫<span class="hljs-variable">OnDeck</span><br><span class="hljs-variable">Owner</span>ÔºöËé∑ÂæóÈîÅÁöÑÁ∫øÁ®ãÁß∞‰∏∫<span class="hljs-variable">Owner</span><br><span class="hljs-operator">!</span><span class="hljs-variable">Owner</span>ÔºöÈáäÊîæÈîÅÁöÑÁ∫øÁ®ã<br></code></pre></td></tr></table></figure>

<p>ÂΩì‰∏Ä‰∏™Á∫øÁ®ãÂ∞ùËØïËé∑ÂæóÈîÅÊó∂ÔºåÂ¶ÇÊûúËØ•ÈîÅÂ∑≤ÁªèË¢´Âç†Áî®ÔºåÂàô‰ºöÂ∞ÜËØ•Á∫øÁ®ãÂ∞ÅË£ÖÊàê‰∏Ä‰∏™<code>ObjectWaiter</code>ÂØπË±°ÊèíÂÖ•Âà∞Contention ListÁöÑÈòüÂàóÁöÑÈòüÈ¶ñÔºåÁÑ∂ÂêéË∞ÉÁî®<code>park</code>ÂáΩÊï∞ÊåÇËµ∑ÂΩìÂâçÁ∫øÁ®ã„ÄÇ</p>
<p>ÂΩìÁ∫øÁ®ãÈáäÊîæÈîÅÊó∂Ôºå‰ºö‰ªéContention ListÊàñEntryList‰∏≠ÊåëÈÄâ‰∏Ä‰∏™Á∫øÁ®ãÂî§ÈÜíÔºåË¢´ÈÄâ‰∏≠ÁöÑÁ∫øÁ®ãÂè´ÂÅö<code>Heir presumptive</code>Âç≥ÂÅáÂÆöÁªßÊâø‰∫∫ÔºåÂÅáÂÆöÁªßÊâø‰∫∫Ë¢´Âî§ÈÜíÂêé‰ºöÂ∞ùËØïËé∑ÂæóÈîÅÔºå‰ΩÜ<code>synchronized</code>ÊòØÈùûÂÖ¨Âπ≥ÁöÑÔºåÊâÄ‰ª•ÂÅáÂÆöÁªßÊâø‰∫∫‰∏ç‰∏ÄÂÆöËÉΩËé∑ÂæóÈîÅ„ÄÇËøôÊòØÂõ†‰∏∫ÂØπ‰∫éÈáçÈáèÁ∫ßÈîÅÔºåÁ∫øÁ®ãÂÖàËá™ÊóãÂ∞ùËØïËé∑ÂæóÈîÅÔºåËøôÊ†∑ÂÅöÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂáèÂ∞ëÊâßË°åÊìç‰ΩúÁ≥ªÁªüÂêåÊ≠•Êìç‰ΩúÂ∏¶Êù•ÁöÑÂºÄÈîÄ„ÄÇÂ¶ÇÊûúËá™Êóã‰∏çÊàêÂäüÂÜçËøõÂÖ•Á≠âÂæÖÈòüÂàó„ÄÇËøôÂØπÈÇ£‰∫õÂ∑≤ÁªèÂú®Á≠âÂæÖÈòüÂàó‰∏≠ÁöÑÁ∫øÁ®ãÊù•ËØ¥ÔºåÁ®çÂæÆÊòæÂæó‰∏çÂÖ¨Âπ≥ÔºåËøòÊúâ‰∏Ä‰∏™‰∏çÂÖ¨Âπ≥ÁöÑÂú∞ÊñπÊòØËá™ÊóãÁ∫øÁ®ãÂèØËÉΩ‰ºöÊä¢Âç†‰∫ÜReadyÁ∫øÁ®ãÁöÑÈîÅ„ÄÇ</p>
<p>ÊûúÁ∫øÁ®ãËé∑ÂæóÈîÅÂêéË∞ÉÁî®<code>Object.wait</code>ÊñπÊ≥ïÔºåÂàô‰ºöÂ∞ÜÁ∫øÁ®ãÂä†ÂÖ•Âà∞WaitSet‰∏≠ÔºåÂΩìË¢´<code>Object.notify</code>Âî§ÈÜíÂêéÔºå‰ºöÂ∞ÜÁ∫øÁ®ã‰ªéWaitSetÁßªÂä®Âà∞Contention ListÊàñEntryList‰∏≠Âéª„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂΩìË∞ÉÁî®‰∏Ä‰∏™ÈîÅÂØπË±°ÁöÑ<code>wait</code>Êàñ<code>notify</code>ÊñπÊ≥ïÊó∂Ôºå<strong>Â¶ÇÂΩìÂâçÈîÅÁöÑÁä∂ÊÄÅÊòØÂÅèÂêëÈîÅÊàñËΩªÈáèÁ∫ßÈîÅÂàô‰ºöÂÖàËÜ®ËÉÄÊàêÈáçÈáèÁ∫ßÈîÅ</strong>„ÄÇ</p>
<h3 id="9-2-5-ÊÄªÁªìÈîÅÁöÑÂçáÁ∫ßÊµÅÁ®ã"><a href="#9-2-5-ÊÄªÁªìÈîÅÁöÑÂçáÁ∫ßÊµÅÁ®ã" class="headerlink" title="9.2.5 ÊÄªÁªìÈîÅÁöÑÂçáÁ∫ßÊµÅÁ®ã"></a>9.2.5 ÊÄªÁªìÈîÅÁöÑÂçáÁ∫ßÊµÅÁ®ã</h3><p>ÊØè‰∏Ä‰∏™Á∫øÁ®ãÂú®ÂáÜÂ§áËé∑ÂèñÂÖ±‰∫´ËµÑÊ∫êÊó∂Ôºö Á¨¨‰∏ÄÊ≠•ÔºåÊ£ÄÊü•MarkWordÈáåÈù¢ÊòØ‰∏çÊòØÊîæÁöÑËá™Â∑±ÁöÑThreadId ,Â¶ÇÊûúÊòØÔºåË°®Á§∫ÂΩìÂâçÁ∫øÁ®ãÊòØÂ§Ñ‰∫é ‚ÄúÂÅèÂêëÈîÅ‚Äù „ÄÇ</p>
<p>Á¨¨‰∫åÊ≠•ÔºåÂ¶ÇÊûúMarkWord‰∏çÊòØËá™Â∑±ÁöÑThreadIdÔºåÈîÅÂçáÁ∫ßÔºåËøôÊó∂ÂÄôÔºåÁî®CASÊù•ÊâßË°åÂàáÊç¢ÔºåÊñ∞ÁöÑÁ∫øÁ®ãÊ†πÊçÆMarkWordÈáåÈù¢Áé∞ÊúâÁöÑThreadIdÔºåÈÄöÁü•‰πãÂâçÁ∫øÁ®ãÊöÇÂÅúÔºå‰πãÂâçÁ∫øÁ®ãÂ∞ÜMarkwordÁöÑÂÜÖÂÆπÁΩÆ‰∏∫Á©∫„ÄÇ</p>
<p>Á¨¨‰∏âÊ≠•Ôºå‰∏§‰∏™Á∫øÁ®ãÈÉΩÊääÈîÅÂØπË±°ÁöÑHashCodeÂ§çÂà∂Âà∞Ëá™Â∑±Êñ∞Âª∫ÁöÑÁî®‰∫éÂ≠òÂÇ®ÈîÅÁöÑËÆ∞ÂΩïÁ©∫Èó¥ÔºåÊé•ÁùÄÂºÄÂßãÈÄöËøáCASÊìç‰ΩúÔºå ÊääÈîÅÂØπË±°ÁöÑMarKwordÁöÑÂÜÖÂÆπ‰øÆÊîπ‰∏∫Ëá™Â∑±Êñ∞Âª∫ÁöÑËÆ∞ÂΩïÁ©∫Èó¥ÁöÑÂú∞ÂùÄÁöÑÊñπÂºèÁ´û‰∫âMarkWord„ÄÇ</p>
<p>Á¨¨ÂõõÊ≠•ÔºåÁ¨¨‰∏âÊ≠•‰∏≠ÊàêÂäüÊâßË°åCASÁöÑËé∑ÂæóËµÑÊ∫êÔºåÂ§±Ë¥•ÁöÑÂàôËøõÂÖ•Ëá™Êóã „ÄÇ</p>
<p>Á¨¨‰∫îÊ≠•ÔºåËá™ÊóãÁöÑÁ∫øÁ®ãÂú®Ëá™ÊóãËøáÁ®ã‰∏≠ÔºåÊàêÂäüËé∑ÂæóËµÑÊ∫ê(Âç≥‰πãÂâçËé∑ÁöÑËµÑÊ∫êÁöÑÁ∫øÁ®ãÊâßË°åÂÆåÊàêÂπ∂ÈáäÊîæ‰∫ÜÂÖ±‰∫´ËµÑÊ∫ê)ÔºåÂàôÊï¥‰∏™Áä∂ÊÄÅ‰æùÁÑ∂Â§Ñ‰∫é ËΩªÈáèÁ∫ßÈîÅÁöÑÁä∂ÊÄÅÔºåÂ¶ÇÊûúËá™ÊóãÂ§±Ë¥• „ÄÇ</p>
<p>Á¨¨ÂÖ≠Ê≠•ÔºåËøõÂÖ•ÈáçÈáèÁ∫ßÈîÅÁöÑÁä∂ÊÄÅÔºåËøô‰∏™Êó∂ÂÄôÔºåËá™ÊóãÁöÑÁ∫øÁ®ãËøõË°åÈòªÂ°ûÔºåÁ≠âÂæÖ‰πãÂâçÁ∫øÁ®ãÊâßË°åÂÆåÊàêÂπ∂Âî§ÈÜíËá™Â∑±„ÄÇ</p>
<h3 id="9-2-6-ÂêÑÁßçÈîÅÁöÑ‰ºòÁº∫ÁÇπÂØπÊØî"><a href="#9-2-6-ÂêÑÁßçÈîÅÁöÑ‰ºòÁº∫ÁÇπÂØπÊØî" class="headerlink" title="9.2.6 ÂêÑÁßçÈîÅÁöÑ‰ºòÁº∫ÁÇπÂØπÊØî"></a>9.2.6 ÂêÑÁßçÈîÅÁöÑ‰ºòÁº∫ÁÇπÂØπÊØî</h3><p>‰∏ãË°®Êù•Ëá™„ÄäJavaÂπ∂ÂèëÁºñÁ®ãÁöÑËâ∫ÊúØ„ÄãÔºö</p>
<p><img src="https://i0.hdslb.com/bfs/album/98ddcb566a00f8b5054b51cb99a5ce4aaf3f36f6.png" srcset="/Hexo/img/loading.gif" lazyload alt="image-20220220222012089"></p>
<p><strong>ÂèÇËÄÉÊñáÁ´†</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/9932047a89be">JavaÈîÅ‰ºòÂåñ‚ÄìJVMÈîÅÈôçÁ∫ß</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/charlesblc/p/5994162.html">Java‰∏≠ÁöÑÈîÅÊú∫Âà∂</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/farmerjohngit/myblog/issues/12">Ê≠ªÁ£ïSynchronizedÂ∫ïÂ±ÇÂÆûÁé∞</a></li>
<li>„ÄäJavaÂπ∂ÂèëÁºñÁ®ãÁöÑËâ∫ÊúØ„Äã</li>
</ul>
<h1 id="10-CAS‰∏éÂéüÂ≠êÊìç‰Ωú"><a href="#10-CAS‰∏éÂéüÂ≠êÊìç‰Ωú" class="headerlink" title="10 CAS‰∏éÂéüÂ≠êÊìç‰Ωú"></a>10 CAS‰∏éÂéüÂ≠êÊìç‰Ωú</h1><p>Á¨¨ÂçÅÁ´† ‰πêËßÇÈîÅÂíåÊÇ≤ËßÇÈîÅ</p>
<h2 id="10-1-‰πêËßÇÈîÅ‰∏éÊÇ≤ËßÇÈîÅÁöÑÊ¶ÇÂøµ"><a href="#10-1-‰πêËßÇÈîÅ‰∏éÊÇ≤ËßÇÈîÅÁöÑÊ¶ÇÂøµ" class="headerlink" title="10.1 ‰πêËßÇÈîÅ‰∏éÊÇ≤ËßÇÈîÅÁöÑÊ¶ÇÂøµ"></a>10.1 ‰πêËßÇÈîÅ‰∏éÊÇ≤ËßÇÈîÅÁöÑÊ¶ÇÂøµ</h2><p>ÈîÅÂèØ‰ª•‰ªé‰∏çÂêåÁöÑËßíÂ∫¶ÂàÜÁ±ª„ÄÇÂÖ∂‰∏≠Ôºå‰πêËßÇÈîÅÂíåÊÇ≤ËßÇÈîÅÊòØ‰∏ÄÁßçÂàÜÁ±ªÊñπÂºè„ÄÇ</p>
<p><strong>ÊÇ≤ËßÇÈîÅÔºö</strong></p>
<p>ÊÇ≤ËßÇÈîÅÂ∞±ÊòØÊàë‰ª¨Â∏∏ËØ¥ÁöÑÈîÅ„ÄÇÂØπ‰∫éÊÇ≤ËßÇÈîÅÊù•ËØ¥ÔºåÂÆÉÊÄªÊòØËÆ§‰∏∫ÊØèÊ¨°ËÆøÈóÆÂÖ±‰∫´ËµÑÊ∫êÊó∂‰ºöÂèëÁîüÂÜ≤Á™ÅÔºåÊâÄ‰ª•ÂøÖÈ°ªÂØπÊØèÊ¨°Êï∞ÊçÆÊìç‰ΩúÂä†‰∏äÈîÅÔºå‰ª•‰øùËØÅ‰∏¥ÁïåÂå∫ÁöÑÁ®ãÂ∫èÂêå‰∏ÄÊó∂Èó¥Âè™ËÉΩÊúâ‰∏Ä‰∏™Á∫øÁ®ãÂú®ÊâßË°å„ÄÇ</p>
<p><strong>‰πêËßÇÈîÅÔºö</strong></p>
<p>‰πêËßÇÈîÅÂèàÁß∞‰∏∫‚ÄúÊó†ÈîÅ‚ÄùÔºåÈ°æÂêçÊÄù‰πâÔºåÂÆÉÊòØ‰πêËßÇÊ¥æ„ÄÇ‰πêËßÇÈîÅÊÄªÊòØÂÅáËÆæÂØπÂÖ±‰∫´ËµÑÊ∫êÁöÑËÆøÈóÆÊ≤°ÊúâÂÜ≤Á™ÅÔºåÁ∫øÁ®ãÂèØ‰ª•‰∏çÂÅúÂú∞ÊâßË°åÔºåÊó†ÈúÄÂä†ÈîÅ‰πüÊó†ÈúÄÁ≠âÂæÖ„ÄÇËÄå‰∏ÄÊó¶Â§ö‰∏™Á∫øÁ®ãÂèëÁîüÂÜ≤Á™ÅÔºå‰πêËßÇÈîÅÈÄöÂ∏∏ÊòØ‰ΩøÁî®‰∏ÄÁßçÁß∞‰∏∫CASÁöÑÊäÄÊúØÊù•‰øùËØÅÁ∫øÁ®ãÊâßË°åÁöÑÂÆâÂÖ®ÊÄß„ÄÇ</p>
<p>Áî±‰∫éÊó†ÈîÅÊìç‰Ωú‰∏≠Ê≤°ÊúâÈîÅÁöÑÂ≠òÂú®ÔºåÂõ†Ê≠§‰∏çÂèØËÉΩÂá∫Áé∞Ê≠ªÈîÅÁöÑÊÉÖÂÜµÔºå‰πüÂ∞±ÊòØËØ¥<strong>‰πêËßÇÈîÅÂ§©ÁîüÂÖçÁñ´Ê≠ªÈîÅ</strong>„ÄÇ</p>
<p>‰πêËßÇÈîÅÂ§öÁî®‰∫é‚ÄúËØªÂ§öÂÜôÂ∞ë‚ÄúÁöÑÁéØÂ¢ÉÔºåÈÅøÂÖçÈ¢ëÁπÅÂä†ÈîÅÂΩ±ÂìçÊÄßËÉΩÔºõËÄåÊÇ≤ËßÇÈîÅÂ§öÁî®‰∫é‚ÄùÂÜôÂ§öËØªÂ∞ë‚ÄúÁöÑÁéØÂ¢ÉÔºåÈÅøÂÖçÈ¢ëÁπÅÂ§±Ë¥•ÂíåÈáçËØïÂΩ±ÂìçÊÄßËÉΩ„ÄÇ</p>
<h2 id="10-2-CASÁöÑÊ¶ÇÂøµ"><a href="#10-2-CASÁöÑÊ¶ÇÂøµ" class="headerlink" title="10.2 CASÁöÑÊ¶ÇÂøµ"></a>10.2 CASÁöÑÊ¶ÇÂøµ</h2><p>CASÁöÑÂÖ®Áß∞ÊòØÔºöÊØîËæÉÂπ∂‰∫§Êç¢ÔºàCompare And SwapÔºâ„ÄÇÂú®CAS‰∏≠ÔºåÊúâËøôÊ†∑‰∏â‰∏™ÂÄºÔºö</p>
<ul>
<li>VÔºöË¶ÅÊõ¥Êñ∞ÁöÑÂèòÈáè(var)</li>
<li>EÔºöÈ¢ÑÊúüÂÄº(expected)</li>
<li>NÔºöÊñ∞ÂÄº(new)</li>
</ul>
<p>ÊØîËæÉÂπ∂‰∫§Êç¢ÁöÑËøáÁ®ãÂ¶Ç‰∏ãÔºö</p>
<p>Âà§Êñ≠VÊòØÂê¶Á≠â‰∫éEÔºåÂ¶ÇÊûúÁ≠â‰∫éÔºåÂ∞ÜVÁöÑÂÄºËÆæÁΩÆ‰∏∫NÔºõÂ¶ÇÊûú‰∏çÁ≠âÔºåËØ¥ÊòéÂ∑≤ÁªèÊúâÂÖ∂ÂÆÉÁ∫øÁ®ãÊõ¥Êñ∞‰∫ÜVÔºåÂàôÂΩìÂâçÁ∫øÁ®ãÊîæÂºÉÊõ¥Êñ∞Ôºå‰ªÄ‰πàÈÉΩ‰∏çÂÅö„ÄÇ</p>
<p>ÊâÄ‰ª•ËøôÈáåÁöÑ<strong>È¢ÑÊúüÂÄºEÊú¨Ë¥®‰∏äÊåáÁöÑÊòØ‚ÄúÊóßÂÄº‚Äù</strong>„ÄÇ</p>
<p>Êàë‰ª¨‰ª•‰∏Ä‰∏™ÁÆÄÂçïÁöÑ‰æãÂ≠êÊù•Ëß£ÈáäËøô‰∏™ËøáÁ®ãÔºö</p>
<ol>
<li>Â¶ÇÊûúÊúâ‰∏Ä‰∏™Â§ö‰∏™Á∫øÁ®ãÂÖ±‰∫´ÁöÑÂèòÈáè<code>i</code>ÂéüÊú¨Á≠â‰∫é5ÔºåÊàëÁé∞Âú®Âú®Á∫øÁ®ãA‰∏≠ÔºåÊÉ≥ÊääÂÆÉËÆæÁΩÆ‰∏∫Êñ∞ÁöÑÂÄº6;</li>
<li>Êàë‰ª¨‰ΩøÁî®CASÊù•ÂÅöËøô‰∏™‰∫ãÊÉÖÔºõ</li>
<li>È¶ñÂÖàÊàë‰ª¨Áî®iÂéª‰∏é5ÂØπÊØîÔºåÂèëÁé∞ÂÆÉÁ≠â‰∫é5ÔºåËØ¥ÊòéÊ≤°ÊúâË¢´ÂÖ∂ÂÆÉÁ∫øÁ®ãÊîπËøáÔºåÈÇ£ÊàëÂ∞±ÊääÂÆÉËÆæÁΩÆ‰∏∫Êñ∞ÁöÑÂÄº6ÔºåÊ≠§Ê¨°CASÊàêÂäüÔºå<code>i</code>ÁöÑÂÄºË¢´ËÆæÁΩÆÊàê‰∫Ü6Ôºõ</li>
<li>Â¶ÇÊûú‰∏çÁ≠â‰∫é5ÔºåËØ¥Êòé<code>i</code>Ë¢´ÂÖ∂ÂÆÉÁ∫øÁ®ãÊîπËøá‰∫ÜÔºàÊØîÂ¶ÇÁé∞Âú®<code>i</code>ÁöÑÂÄº‰∏∫2ÔºâÔºåÈÇ£‰πàÊàëÂ∞±‰ªÄ‰πà‰πü‰∏çÂÅöÔºåÊ≠§Ê¨°CASÂ§±Ë¥•Ôºå<code>i</code>ÁöÑÂÄº‰ªçÁÑ∂‰∏∫2„ÄÇ</li>
</ol>
<p>Âú®Ëøô‰∏™‰æãÂ≠ê‰∏≠Ôºå<code>i</code>Â∞±ÊòØVÔºå5Â∞±ÊòØEÔºå6Â∞±ÊòØN„ÄÇ</p>
<p>ÈÇ£ÊúâÊ≤°ÊúâÂèØËÉΩÊàëÂú®Âà§Êñ≠‰∫Ü<code>i</code>‰∏∫5‰πãÂêéÔºåÊ≠£ÂáÜÂ§áÊõ¥Êñ∞ÂÆÉÁöÑÊñ∞ÂÄºÁöÑÊó∂ÂÄôÔºåË¢´ÂÖ∂ÂÆÉÁ∫øÁ®ãÊõ¥Êîπ‰∫Ü<code>i</code>ÁöÑÂÄºÂë¢Ôºü</p>
<p>‰∏ç‰ºöÁöÑ„ÄÇÂõ†‰∏∫CASÊòØ‰∏ÄÁßçÂéüÂ≠êÊìç‰ΩúÔºåÂÆÉÊòØ‰∏ÄÁßçÁ≥ªÁªüÂéüËØ≠ÔºåÊòØ‰∏ÄÊù°CPUÁöÑÂéüÂ≠êÊåá‰ª§Ôºå‰ªéCPUÂ±ÇÈù¢‰øùËØÅÂÆÉÁöÑÂéüÂ≠êÊÄß</p>
<p><strong>ÂΩìÂ§ö‰∏™Á∫øÁ®ãÂêåÊó∂‰ΩøÁî®CASÊìç‰Ωú‰∏Ä‰∏™ÂèòÈáèÊó∂ÔºåÂè™Êúâ‰∏Ä‰∏™‰ºöËÉúÂá∫ÔºåÂπ∂ÊàêÂäüÊõ¥Êñ∞ÔºåÂÖ∂‰ΩôÂùá‰ºöÂ§±Ë¥•Ôºå‰ΩÜÂ§±Ë¥•ÁöÑÁ∫øÁ®ãÂπ∂‰∏ç‰ºöË¢´ÊåÇËµ∑Ôºå‰ªÖÊòØË¢´ÂëäÁü•Â§±Ë¥•ÔºåÂπ∂‰∏îÂÖÅËÆ∏ÂÜçÊ¨°Â∞ùËØïÔºåÂΩìÁÑ∂‰πüÂÖÅËÆ∏Â§±Ë¥•ÁöÑÁ∫øÁ®ãÊîæÂºÉÊìç‰Ωú„ÄÇ</strong></p>
<h2 id="10-3-JavaÂÆûÁé∞CASÁöÑÂéüÁêÜ-UnsafeÁ±ª"><a href="#10-3-JavaÂÆûÁé∞CASÁöÑÂéüÁêÜ-UnsafeÁ±ª" class="headerlink" title="10.3 JavaÂÆûÁé∞CASÁöÑÂéüÁêÜ - UnsafeÁ±ª"></a>10.3 JavaÂÆûÁé∞CASÁöÑÂéüÁêÜ - UnsafeÁ±ª</h2><p>ÂâçÈù¢ÊèêÂà∞ÔºåCASÊòØ‰∏ÄÁßçÂéüÂ≠êÊìç‰Ωú„ÄÇÈÇ£‰πàJavaÊòØÊÄéÊ†∑Êù•‰ΩøÁî®CASÁöÑÂë¢ÔºüÊàë‰ª¨Áü•ÈÅìÔºåÂú®Java‰∏≠ÔºåÂ¶ÇÊûú‰∏Ä‰∏™ÊñπÊ≥ïÊòØnativeÁöÑÔºåÈÇ£JavaÂ∞±‰∏çË¥üË¥£ÂÖ∑‰ΩìÂÆûÁé∞ÂÆÉÔºåËÄåÊòØ‰∫§ÁªôÂ∫ïÂ±ÇÁöÑJVM‰ΩøÁî®cÊàñËÄÖc++ÂéªÂÆûÁé∞„ÄÇ</p>
<p>Âú®Java‰∏≠ÔºåÊúâ‰∏Ä‰∏™<code>Unsafe</code>Á±ªÔºåÂÆÉÂú®<code>sun.misc</code>ÂåÖ‰∏≠„ÄÇÂÆÉÈáåÈù¢ÊòØ‰∏Ä‰∫õ<code>native</code>ÊñπÊ≥ïÔºåÂÖ∂‰∏≠Â∞±ÊúâÂá†‰∏™ÂÖ≥‰∫éCASÁöÑÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSwapObject</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset,Object expected, Object x)</span>;<br><span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSwapInt</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset,<span class="hljs-type">int</span> expected,<span class="hljs-type">int</span> x)</span>;<br><span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSwapLong</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset,<span class="hljs-type">long</span> expected,<span class="hljs-type">long</span> x)</span>;<br></code></pre></td></tr></table></figure>

<p>ÂΩìÁÑ∂Ôºå‰ªñ‰ª¨ÈÉΩÊòØ<code>public native</code>ÁöÑ„ÄÇ</p>
<p>Unsafe‰∏≠ÂØπCASÁöÑÂÆûÁé∞ÊòØC++ÂÜôÁöÑÔºåÂÆÉÁöÑÂÖ∑‰ΩìÂÆûÁé∞ÂíåÊìç‰ΩúÁ≥ªÁªü„ÄÅCPUÈÉΩÊúâÂÖ≥Á≥ª„ÄÇ</p>
<p>LinuxÁöÑX86‰∏ã‰∏ªË¶ÅÊòØÈÄöËøá<code>cmpxchgl</code>Ëøô‰∏™Êåá‰ª§Âú®CPUÁ∫ßÂÆåÊàêCASÊìç‰ΩúÁöÑÔºå‰ΩÜÂú®Â§öÂ§ÑÁêÜÂô®ÊÉÖÂÜµ‰∏ãÂøÖÈ°ª‰ΩøÁî®<code>lock</code>Êåá‰ª§Âä†ÈîÅÊù•ÂÆåÊàê„ÄÇÂΩìÁÑ∂‰∏çÂêåÁöÑÊìç‰ΩúÁ≥ªÁªüÂíåÂ§ÑÁêÜÂô®ÁöÑÂÆûÁé∞‰ºöÊúâÊâÄ‰∏çÂêåÔºåÂ§ßÂÆ∂ÂèØ‰ª•Ëá™Ë°å‰∫ÜËß£„ÄÇ</p>
<p>ÂΩìÁÑ∂ÔºåUnsafeÁ±ªÈáåÈù¢ËøòÊúâÂÖ∂ÂÆÉÊñπÊ≥ïÁî®‰∫é‰∏çÂêåÁöÑÁî®ÈÄî„ÄÇÊØîÂ¶ÇÊîØÊåÅÁ∫øÁ®ãÊåÇËµ∑ÂíåÊÅ¢Â§çÁöÑ<code>park</code>Âíå<code>unpark</code>Ôºå LockSupportÁ±ªÂ∫ïÂ±ÇÂ∞±ÊòØË∞ÉÁî®‰∫ÜËøô‰∏§‰∏™ÊñπÊ≥ï„ÄÇËøòÊúâÊîØÊåÅÂèçÂ∞ÑÊìç‰ΩúÁöÑ<code>allocateInstance()</code>ÊñπÊ≥ï„ÄÇ</p>
<h2 id="10-4-ÂéüÂ≠êÊìç‰Ωú-AtomicIntegerÁ±ªÊ∫êÁ†ÅÁÆÄÊûê"><a href="#10-4-ÂéüÂ≠êÊìç‰Ωú-AtomicIntegerÁ±ªÊ∫êÁ†ÅÁÆÄÊûê" class="headerlink" title="10.4 ÂéüÂ≠êÊìç‰Ωú-AtomicIntegerÁ±ªÊ∫êÁ†ÅÁÆÄÊûê"></a>10.4 ÂéüÂ≠êÊìç‰Ωú-AtomicIntegerÁ±ªÊ∫êÁ†ÅÁÆÄÊûê</h2><p>‰∏äÈù¢‰ªãÁªç‰∫ÜUnsafeÁ±ªÁöÑÂá†‰∏™ÊîØÊåÅCASÁöÑÊñπÊ≥ï„ÄÇÈÇ£JavaÂÖ∑‰ΩìÊòØÂ¶Ç‰Ωï‰ΩøÁî®ËøôÂá†‰∏™ÊñπÊ≥ïÊù•ÂÆûÁé∞ÂéüÂ≠êÊìç‰ΩúÁöÑÂë¢Ôºü</p>
<p>JDKÊèê‰æõ‰∫Ü‰∏Ä‰∫õÁî®‰∫éÂéüÂ≠êÊìç‰ΩúÁöÑÁ±ªÔºåÂú®<code>java.util.concurrent.atomic</code>ÂåÖ‰∏ãÈù¢„ÄÇÂú®JDK 11‰∏≠ÔºåÊúâÂ¶Ç‰∏ã17‰∏™Á±ªÔºö</p>
<p><img src="https://i0.hdslb.com/bfs/album/a96143f9145d4876cecd1a036bc6e2d447fac334.png" srcset="/Hexo/img/loading.gif" lazyload alt="image-20220220222547625"></p>
<p>ÂéüÂ≠êÁ±ª</p>
<p>‰ªéÂêçÂ≠óÂ∞±ÂèØ‰ª•ÁúãÂæóÂá∫Êù•Ëøô‰∫õÁ±ªÂ§ßÊ¶ÇÁöÑÁî®ÈÄîÔºö</p>
<ul>
<li>ÂéüÂ≠êÊõ¥Êñ∞Âü∫Êú¨Á±ªÂûã</li>
<li>ÂéüÂ≠êÊõ¥Êñ∞Êï∞ÁªÑ</li>
<li>ÂéüÂ≠êÊõ¥Êñ∞ÂºïÁî®</li>
<li>ÂéüÂ≠êÊõ¥Êñ∞Â≠óÊÆµÔºàÂ±ûÊÄßÔºâ</li>
</ul>
<p>ËøôÈáåÊàë‰ª¨‰ª•<code>AtomicInteger</code>Á±ªÁöÑ<code>getAndAdd(int delta)</code>ÊñπÊ≥ï‰∏∫‰æãÔºåÊù•ÁúãÁúãJavaÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÂéüÂ≠êÊìç‰ΩúÁöÑ„ÄÇ</p>
<p>ÂÖàÁúãÁúãËøô‰∏™ÊñπÊ≥ïÁöÑÊ∫êÁ†ÅÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAndAdd</span><span class="hljs-params">(<span class="hljs-type">int</span> delta)</span> &#123;<br><br>    <span class="hljs-keyword">return</span> U.getAndAddInt(<span class="hljs-built_in">this</span>, VALUE, delta);<br><br><br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>ËøôÈáåÁöÑUÂÖ∂ÂÆûÂ∞±ÊòØ‰∏Ä‰∏™<code>Unsafe</code>ÂØπË±°Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> jdk.internal.misc.<span class="hljs-type">Unsafe</span> <span class="hljs-variable">U</span> <span class="hljs-operator">=</span> jdk.internal.misc.Unsafe.getUnsafe();<br></code></pre></td></tr></table></figure>

<p>ÊâÄ‰ª•ÂÖ∂ÂÆû<code>AtomicInteger</code>Á±ªÁöÑ<code>getAndAdd(int delta)</code>ÊñπÊ≥ïÊòØË∞ÉÁî®<code>Unsafe</code>Á±ªÁöÑÊñπÊ≥ïÊù•ÂÆûÁé∞ÁöÑÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@HotSpotIntrinsicCandidate</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAndAddInt</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, <span class="hljs-type">int</span> delta)</span> &#123;<br>    <span class="hljs-type">int</span> v;<br>    <span class="hljs-keyword">do</span> &#123;<br>        v = getIntVolatile(o, offset);<br>    &#125; <span class="hljs-keyword">while</span> (!weakCompareAndSetInt(o, offset, v, v + delta));<br>    <span class="hljs-keyword">return</span> v;<br>&#125;<br></code></pre></td></tr></table></figure>



<blockquote>
<p>Ê≥®ÔºöËøô‰∏™ÊñπÊ≥ïÊòØÂú®JDK 1.8ÊâçÊñ∞Â¢ûÁöÑ„ÄÇÂú®JDK1.8‰πãÂâçÔºå<code>AtomicInteger</code>Ê∫êÁ†ÅÂÆûÁé∞ÊúâÊâÄ‰∏çÂêåÔºåÊòØÂü∫‰∫éforÊ≠ªÂæ™ÁéØÁöÑÔºåÊúâÂÖ¥Ë∂£ÁöÑËØªËÄÖÂèØ‰ª•Ëá™Ë°å‰∫ÜËß£‰∏Ä‰∏ã„ÄÇ</p>
</blockquote>
<p>Êàë‰ª¨Êù•‰∏ÄÊ≠•Ê≠•Ëß£ÊûêËøôÊÆµÊ∫êÁ†Å„ÄÇÈ¶ñÂÖàÔºåÂØπË±°<code>o</code>ÊòØ<code>this</code>Ôºå‰πüÂ∞±ÊòØ‰∏Ä‰∏™<code>AtomicInteger</code>ÂØπË±°„ÄÇÁÑ∂Âêé<code>offset</code>ÊòØ‰∏Ä‰∏™Â∏∏Èáè<code>VALUE</code>„ÄÇËøô‰∏™Â∏∏ÈáèÊòØÂú®<code>AtomicInteger</code>Á±ª‰∏≠Â£∞ÊòéÁöÑÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">VALUE</span> <span class="hljs-operator">=</span> U.objectFieldOffset(AtomicInteger.class, <span class="hljs-string">&quot;value&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>ÂêåÊ†∑ÊòØË∞ÉÁî®ÁöÑ<code>Unsafe</code>ÁöÑÊñπÊ≥ï„ÄÇ‰ªéÊñπÊ≥ïÂêçÂ≠ó‰∏äÊù•ÁúãÔºåÊòØÂæóÂà∞‰∫Ü‰∏Ä‰∏™ÂØπË±°Â≠óÊÆµÂÅèÁßªÈáè„ÄÇ</p>
<blockquote>
<p>Áî®‰∫éËé∑ÂèñÊüê‰∏™Â≠óÊÆµÁõ∏ÂØπJavaÂØπË±°ÁöÑ‚ÄúËµ∑ÂßãÂú∞ÂùÄ‚ÄùÁöÑÂÅèÁßªÈáè„ÄÇ</p>
<p>‰∏Ä‰∏™javaÂØπË±°ÂèØ‰ª•ÁúãÊàêÊòØ‰∏ÄÊÆµÂÜÖÂ≠òÔºåÂêÑ‰∏™Â≠óÊÆµÈÉΩÂæóÊåâÁÖß‰∏ÄÂÆöÁöÑÈ°∫Â∫èÊîæÂú®ËøôÊÆµÂÜÖÂ≠òÈáåÔºåÂêåÊó∂ËÄÉËôëÂà∞ÂØπÈΩêË¶ÅÊ±ÇÔºåÂèØËÉΩËøô‰∫õÂ≠óÊÆµ‰∏çÊòØËøûÁª≠ÊîæÁΩÆÁöÑÔºå</p>
<p>Áî®Ëøô‰∏™ÊñπÊ≥ïËÉΩÂáÜÁ°ÆÂú∞ÂëäËØâ‰Ω†Êüê‰∏™Â≠óÊÆµÁõ∏ÂØπ‰∫éÂØπË±°ÁöÑËµ∑ÂßãÂÜÖÂ≠òÂú∞ÂùÄÁöÑÂ≠óËäÇÂÅèÁßªÈáèÔºåÂõ†‰∏∫ÊòØÁõ∏ÂØπÂÅèÁßªÈáèÔºåÊâÄ‰ª•ÂÆÉÂÖ∂ÂÆûË∑üÊüê‰∏™ÂÖ∑‰ΩìÂØπË±°ÂèàÊ≤°‰ªÄ‰πàÂ§™Â§ßÂÖ≥Á≥ªÔºåË∑üclassÁöÑÂÆö‰πâÂíåËôöÊãüÊú∫ÁöÑÂÜÖÂ≠òÊ®°ÂûãÁöÑÂÆûÁé∞ÁªÜËäÇÊõ¥Áõ∏ÂÖ≥„ÄÇ</p>
</blockquote>
<p>ÁªßÁª≠ÁúãÊ∫êÁ†Å„ÄÇÂâçÈù¢Êàë‰ª¨ËÆ≤Âà∞ÔºåCASÊòØ‚ÄúÊó†ÈîÅ‚ÄùÁöÑÂü∫Á°ÄÔºåÂÆÉÂÖÅËÆ∏Êõ¥Êñ∞Â§±Ë¥•„ÄÇÊâÄ‰ª•ÁªèÂ∏∏‰ºö‰∏éwhileÂæ™ÁéØÊê≠ÈÖçÔºåÂú®Â§±Ë¥•Âêé‰∏çÊñ≠ÂéªÈáçËØï„ÄÇ</p>
<p>ËøôÈáåÂ£∞Êòé‰∫Ü‰∏Ä‰∏™vÔºå‰πüÂ∞±ÊòØË¶ÅËøîÂõûÁöÑÂÄº„ÄÇ‰ªé<code>getAndAddInt</code>Êù•ÁúãÔºåÂÆÉËøîÂõûÁöÑÂ∫îËØ•ÊòØÂéüÊù•ÁöÑÂÄºÔºåËÄåÊñ∞ÁöÑÂÄºÁöÑ<code>v + delta</code>„ÄÇ</p>
<p>ËøôÈáå‰ΩøÁî®ÁöÑÊòØ<strong>do-whileÂæ™ÁéØ</strong>„ÄÇËøôÁßçÂæ™ÁéØ‰∏çÂ§öËßÅÔºåÂÆÉÁöÑÁõÆÁöÑÊòØ<strong>‰øùËØÅÂæ™ÁéØ‰ΩìÂÜÖÁöÑËØ≠Âè•Ëá≥Â∞ë‰ºöË¢´ÊâßË°å‰∏ÄÈÅç</strong>„ÄÇËøôÊ†∑ÊâçËÉΩ‰øùËØÅreturn ÁöÑÂÄº<code>v</code>ÊòØÊàë‰ª¨ÊúüÊúõÁöÑÂÄº„ÄÇ</p>
<p>Âæ™ÁéØ‰ΩìÁöÑÊù°‰ª∂ÊòØ‰∏Ä‰∏™CASÊñπÊ≥ïÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">weakCompareAndSetInt</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset,</span><br><span class="hljs-params">                                          <span class="hljs-type">int</span> expected,</span><br><span class="hljs-params">                                          <span class="hljs-type">int</span> x)</span> &#123;<br>    <span class="hljs-keyword">return</span> compareAndSetInt(o, offset, expected, x);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSetInt</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset,</span><br><span class="hljs-params">                                             <span class="hljs-type">int</span> expected,</span><br><span class="hljs-params">                                             <span class="hljs-type">int</span> x)</span>;<br></code></pre></td></tr></table></figure>

<p>ÂèØ‰ª•ÁúãÂà∞ÔºåÊúÄÁªàÂÖ∂ÂÆûÊòØË∞ÉÁî®ÁöÑÊàë‰ª¨‰πãÂâçËØ¥Âà∞‰∫ÜCAS <code>native</code>ÊñπÊ≥ï„ÄÇÈÇ£‰∏∫‰ªÄ‰πàË¶ÅÁªèËøá‰∏ÄÂ±Ç<code>weakCompareAndSetInt</code>Âë¢Ôºü‰ªéJDKÊ∫êÁ†Å‰∏äÁúã‰∏çÂá∫Êù•‰ªÄ‰πà„ÄÇÂú®JDK 8Âèä‰πãÂâçÁöÑÁâàÊú¨ÔºåËøô‰∏§‰∏™ÊñπÊ≥ïÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ</p>
<blockquote>
<p>ËÄåÂú®JDK 9ÂºÄÂßãÔºåËøô‰∏§‰∏™ÊñπÊ≥ï‰∏äÈù¢Â¢ûÂä†‰∫Ü@HotSpotIntrinsicCandidateÊ≥®Ëß£„ÄÇËøô‰∏™Ê≥®Ëß£ÂÖÅËÆ∏HotSpot VMËá™Â∑±Êù•ÂÜôÊ±áÁºñÊàñIRÁºñËØëÂô®Êù•ÂÆûÁé∞ËØ•ÊñπÊ≥ï‰ª•Êèê‰æõÊÄßËÉΩ„ÄÇ‰πüÂ∞±ÊòØËØ¥ËôΩÁÑ∂Â§ñÈù¢ÁúãÂà∞ÁöÑÂú®JDK9‰∏≠weakCompareAndSetÂíåcompareAndSetÂ∫ïÂ±Ç‰æùÊóßÊòØË∞ÉÁî®‰∫Ü‰∏ÄÊ†∑ÁöÑ‰ª£Á†ÅÔºå‰ΩÜÊòØ‰∏çÊéíÈô§HotSpot VM‰ºöÊâãÂä®Êù•ÂÆûÁé∞weakCompareAndSetÁúüÊ≠£Âê´‰πâÁöÑÂäüËÉΩÁöÑÂèØËÉΩÊÄß„ÄÇ</p>
</blockquote>
<p>Ê†πÊçÆÊú¨ÊñáÁ¨¨‰∏ÄÁØáÂèÇËÄÉÊñáÁ´†ÔºàÊñáÊú´ÈìæÊé•ÔºâÔºåÂÆÉË∑ü<code>volitile</code>ÊúâÂÖ≥„ÄÇ</p>
<p>ÁÆÄÂçïÊù•ËØ¥Ôºå<code>weakCompareAndSet</code>Êìç‰Ωú‰ªÖ‰øùÁïô‰∫Ü<code>volatile</code>Ëá™Ë∫´ÂèòÈáèÁöÑÁâπÊÄßÔºåËÄåÂá∫Âéª‰∫Ühappens-beforeËßÑÂàôÂ∏¶Êù•ÁöÑÂÜÖÂ≠òËØ≠‰πâ„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºå<code>weakCompareAndSet</code><strong>Êó†Ê≥ï‰øùËØÅÂ§ÑÁêÜÊìç‰ΩúÁõÆÊ†áÁöÑvolatileÂèòÈáèÂ§ñÁöÑÂÖ∂‰ªñÂèòÈáèÁöÑÊâßË°åÈ°∫Â∫è( ÁºñËØëÂô®ÂíåÂ§ÑÁêÜÂô®‰∏∫‰∫Ü‰ºòÂåñÁ®ãÂ∫èÊÄßËÉΩËÄåÂØπÊåá‰ª§Â∫èÂàóËøõË°åÈáçÊñ∞ÊéíÂ∫è )ÔºåÂêåÊó∂‰πüÊó†Ê≥ï‰øùËØÅËøô‰∫õÂèòÈáèÁöÑÂèØËßÅÊÄß„ÄÇ</strong>ËøôÂú®‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äÂèØ‰ª•ÊèêÈ´òÊÄßËÉΩ„ÄÇ</p>
<p>ÂÜçÂõûÂà∞Âæ™ÁéØÊù°‰ª∂‰∏äÊù•ÔºåÂèØ‰ª•ÁúãÂà∞ÂÆÉÊòØÂú®‰∏çÊñ≠Â∞ùËØïÂéªÁî®CASÊõ¥Êñ∞„ÄÇÂ¶ÇÊûúÊõ¥Êñ∞Â§±Ë¥•ÔºåÂ∞±ÁªßÁª≠ÈáçËØï„ÄÇÈÇ£‰∏∫‰ªÄ‰πàË¶ÅÊääËé∑Âèñ‚ÄúÊóßÂÄº‚ÄùvÁöÑÊìç‰ΩúÊîæÂà∞Âæ™ÁéØ‰ΩìÂÜÖÂë¢ÔºüÂÖ∂ÂÆûËøô‰πüÂæàÂ•ΩÁêÜËß£„ÄÇÂâçÈù¢Êàë‰ª¨ËØ¥‰∫ÜÔºåCASÂ¶ÇÊûúÊóßÂÄºV‰∏çÁ≠â‰∫éÈ¢ÑÊúüÂÄºEÔºåÂÆÉÂ∞±‰ºöÊõ¥Êñ∞Â§±Ë¥•„ÄÇËØ¥ÊòéÊóßÁöÑÂÄºÂèëÁîü‰∫ÜÂèòÂåñ„ÄÇÈÇ£Êàë‰ª¨ÂΩìÁÑ∂ÈúÄË¶ÅËøîÂõûÁöÑÊòØË¢´ÂÖ∂‰ªñÁ∫øÁ®ãÊîπÂèò‰πãÂêéÁöÑÊóßÂÄº‰∫ÜÔºåÂõ†Ê≠§ÊîæÂú®‰∫ÜdoÂæ™ÁéØ‰ΩìÂÜÖ„ÄÇ</p>
<h2 id="10-5-CASÂÆûÁé∞ÂéüÂ≠êÊìç‰ΩúÁöÑ‰∏âÂ§ßÈóÆÈ¢ò"><a href="#10-5-CASÂÆûÁé∞ÂéüÂ≠êÊìç‰ΩúÁöÑ‰∏âÂ§ßÈóÆÈ¢ò" class="headerlink" title="10.5 CASÂÆûÁé∞ÂéüÂ≠êÊìç‰ΩúÁöÑ‰∏âÂ§ßÈóÆÈ¢ò"></a>10.5 CASÂÆûÁé∞ÂéüÂ≠êÊìç‰ΩúÁöÑ‰∏âÂ§ßÈóÆÈ¢ò</h2><p>ËøôÈáå‰ªãÁªç‰∏Ä‰∏ãCASÂÆûÁé∞ÂéüÂ≠êÊìç‰ΩúÁöÑ‰∏âÂ§ßÈóÆÈ¢òÂèäÂÖ∂Ëß£ÂÜ≥ÊñπÊ°à„ÄÇ</p>
<h3 id="10-5-1-ABAÈóÆÈ¢ò"><a href="#10-5-1-ABAÈóÆÈ¢ò" class="headerlink" title="10.5.1 ABAÈóÆÈ¢ò"></a>10.5.1 ABAÈóÆÈ¢ò</h3><p>ÊâÄË∞ìABAÈóÆÈ¢òÔºåÂ∞±ÊòØ‰∏Ä‰∏™ÂÄºÂéüÊù•ÊòØAÔºåÂèòÊàê‰∫ÜBÔºåÂèàÂèòÂõû‰∫ÜA„ÄÇËøô‰∏™Êó∂ÂÄô‰ΩøÁî®CASÊòØÊ£ÄÊü•‰∏çÂá∫ÂèòÂåñÁöÑÔºå‰ΩÜÂÆûÈôÖ‰∏äÂç¥Ë¢´Êõ¥Êñ∞‰∫Ü‰∏§Ê¨°„ÄÇ</p>
<p>ABAÈóÆÈ¢òÁöÑËß£ÂÜ≥ÊÄùË∑ØÊòØÂú®ÂèòÈáèÂâçÈù¢ËøΩÂä†‰∏ä<strong>ÁâàÊú¨Âè∑ÊàñËÄÖÊó∂Èó¥Êà≥</strong>„ÄÇ‰ªéJDK 1.5ÂºÄÂßãÔºåJDKÁöÑatomicÂåÖÈáåÊèê‰æõ‰∫Ü‰∏Ä‰∏™Á±ª<code>AtomicStampedReference</code>Á±ªÊù•Ëß£ÂÜ≥ABAÈóÆÈ¢ò„ÄÇ</p>
<p>Ëøô‰∏™Á±ªÁöÑ<code>compareAndSet</code>ÊñπÊ≥ïÁöÑ‰ΩúÁî®ÊòØÈ¶ñÂÖàÊ£ÄÊü•ÂΩìÂâçÂºïÁî®ÊòØÂê¶Á≠â‰∫éÈ¢ÑÊúüÂºïÁî®ÔºåÂπ∂‰∏îÊ£ÄÊü•ÂΩìÂâçÊ†áÂøóÊòØÂê¶Á≠â‰∫éÈ¢ÑÊúüÊ†áÂøóÔºåÂ¶ÇÊûú‰∫åËÄÖÈÉΩÁõ∏Á≠âÔºåÊâç‰ΩøÁî®CASËÆæÁΩÆ‰∏∫Êñ∞ÁöÑÂÄºÂíåÊ†áÂøó„ÄÇ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSet</span><span class="hljs-params">(V   expectedReference,</span><br><span class="hljs-params">                             V   newReference,</span><br><span class="hljs-params">                             <span class="hljs-type">int</span> expectedStamp,</span><br><span class="hljs-params">                             <span class="hljs-type">int</span> newStamp)</span> &#123;<br>    Pair&lt;V&gt; current = pair;<br>    <span class="hljs-keyword">return</span><br>        expectedReference == current.reference &amp;&amp;<br>        expectedStamp == current.stamp &amp;&amp;<br>        ((newReference == current.reference &amp;&amp;<br>          newStamp == current.stamp) ||<br>         casPair(current, Pair.of(newReference, newStamp)));<br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="10-5-2-Âæ™ÁéØÊó∂Èó¥ÈïøÂºÄÈîÄÂ§ß"><a href="#10-5-2-Âæ™ÁéØÊó∂Èó¥ÈïøÂºÄÈîÄÂ§ß" class="headerlink" title="10.5.2 Âæ™ÁéØÊó∂Èó¥ÈïøÂºÄÈîÄÂ§ß"></a>10.5.2 Âæ™ÁéØÊó∂Èó¥ÈïøÂºÄÈîÄÂ§ß</h3><p>CASÂ§ö‰∏éËá™ÊóãÁªìÂêà„ÄÇÂ¶ÇÊûúËá™ÊóãCASÈïøÊó∂Èó¥‰∏çÊàêÂäüÔºå‰ºöÂç†Áî®Â§ßÈáèÁöÑCPUËµÑÊ∫ê„ÄÇ</p>
<p>Ëß£ÂÜ≥ÊÄùË∑ØÊòØËÆ©JVMÊîØÊåÅÂ§ÑÁêÜÂô®Êèê‰æõÁöÑ<strong>pauseÊåá‰ª§</strong>„ÄÇ</p>
<p>pauseÊåá‰ª§ËÉΩËÆ©Ëá™ÊóãÂ§±Ë¥•Êó∂cpuÁù°Áú†‰∏ÄÂ∞èÊÆµÊó∂Èó¥ÂÜçÁªßÁª≠Ëá™ÊóãÔºå‰ªéËÄå‰ΩøÂæóËØªÊìç‰ΩúÁöÑÈ¢ëÁéá‰ΩéÂæàÂ§ö,‰∏∫Ëß£ÂÜ≥ÂÜÖÂ≠òÈ°∫Â∫èÂÜ≤Á™ÅËÄåÂØºËá¥ÁöÑCPUÊµÅÊ∞¥Á∫øÈáçÊéíÁöÑ‰ª£‰ª∑‰πü‰ºöÂ∞èÂæàÂ§ö„ÄÇ</p>
<h3 id="10-5-3-Âè™ËÉΩ‰øùËØÅ‰∏Ä‰∏™ÂÖ±‰∫´ÂèòÈáèÁöÑÂéüÂ≠êÊìç‰Ωú"><a href="#10-5-3-Âè™ËÉΩ‰øùËØÅ‰∏Ä‰∏™ÂÖ±‰∫´ÂèòÈáèÁöÑÂéüÂ≠êÊìç‰Ωú" class="headerlink" title="10.5.3 Âè™ËÉΩ‰øùËØÅ‰∏Ä‰∏™ÂÖ±‰∫´ÂèòÈáèÁöÑÂéüÂ≠êÊìç‰Ωú"></a>10.5.3 Âè™ËÉΩ‰øùËØÅ‰∏Ä‰∏™ÂÖ±‰∫´ÂèòÈáèÁöÑÂéüÂ≠êÊìç‰Ωú</h3><p>Ëøô‰∏™ÈóÆÈ¢ò‰Ω†ÂèØËÉΩÂ∑≤ÁªèÁü•ÈÅìÊÄé‰πàËß£ÂÜ≥‰∫Ü„ÄÇÊúâ‰∏§ÁßçËß£ÂÜ≥ÊñπÊ°àÔºö</p>
<ol>
<li>‰ΩøÁî®JDK 1.5ÂºÄÂßãÂ∞±Êèê‰æõÁöÑ<code>AtomicReference</code>Á±ª‰øùËØÅÂØπË±°‰πãÈó¥ÁöÑÂéüÂ≠êÊÄßÔºåÊääÂ§ö‰∏™ÂèòÈáèÊîæÂà∞‰∏Ä‰∏™ÂØπË±°ÈáåÈù¢ËøõË°åCASÊìç‰ΩúÔºõ</li>
<li>‰ΩøÁî®ÈîÅ„ÄÇÈîÅÂÜÖÁöÑ‰∏¥ÁïåÂå∫‰ª£Á†ÅÂèØ‰ª•‰øùËØÅÂè™ÊúâÂΩìÂâçÁ∫øÁ®ãËÉΩÊìç‰Ωú„ÄÇ</li>
</ol>
<h1 id="ÂèÇËÄÉËµÑÊñô"><a href="#ÂèÇËÄÉËµÑÊñô" class="headerlink" title="ÂèÇËÄÉËµÑÊñô"></a>ÂèÇËÄÉËµÑÊñô</h1><ol>
<li><a target="_blank" rel="noopener" href="http://www.importnew.com/27596.html">ÂØπ volatile„ÄÅcompareAndSet„ÄÅweakCompareAndSet ÁöÑ‰∏Ä‰∫õÊÄùËÄÉ</a></li>
<li>„ÄäJava Âπ∂ÂèëÁºñÁ®ãÁöÑËâ∫ÊúØ„Äã</li>
</ol>

              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/Hexo/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B%F0%9F%A4%B7%E2%80%8D%E2%99%82%EF%B8%8F/" class="category-chain-item">Â§öÁ∫øÁ®ãü§∑‚Äç‚ôÇÔ∏è</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/Hexo/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">#Â§öÁ∫øÁ®ã</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Ê∑±ÂÖ•ÊµÖÂá∫javaÂ§öÁ∫øÁ®ã</div>
      <div>https://1902756969.github.io/Hexo/2021/05/15/Â§öÁ∫øÁ®ã/Ê∑±ÂÖ•ÊµÖÂá∫javaÂ§öÁ∫øÁ®ã/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>‰ΩúËÄÖ</div>
          <div>Êòü</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>ÂèëÂ∏É‰∫é</div>
          <div>2021Âπ¥5Êúà15Êó•</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>ËÆ∏ÂèØÂçèËÆÆ</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - ÁΩ≤Âêç">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/Hexo/2021/05/15/%E5%B7%A5%E5%85%B7/Tomcat%E5%90%AF%E5%8A%A8%E4%B8%8E%E9%9B%86%E6%88%90/" title="TomcatÂêØÂä®‰∏éideaÂ∑•ÂÖ∑ÈõÜÊàê">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">TomcatÂêØÂä®‰∏éideaÂ∑•ÂÖ∑ÈõÜÊàê</span>
                        <span class="visible-mobile">‰∏ä‰∏ÄÁØá</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/Hexo/2021/04/08/java%E5%9F%BA%E7%A1%80/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B02/" title="ÁΩëÁªúÁºñÁ®ã_2">
                        <span class="hidden-mobile">ÁΩëÁªúÁºñÁ®ã_2</span>
                        <span class="visible-mobile">‰∏ã‰∏ÄÁØá</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.4.16/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"7pHw1e3olQLxNfcNQy79zuU7-gzGzoHsz","appKey":"wJBz7rwsu1OJktQVGA4chIcS","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":15,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ÁõÆÂΩï</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">ÊêúÁ¥¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">ÂÖ≥ÈîÆËØç</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
      

    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        ÊÄªËÆøÈóÆÈáè 
        <span id="busuanzi_value_site_pv"></span>
         Ê¨°
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        ÊÄªËÆøÂÆ¢Êï∞ 
        <span id="busuanzi_value_site_uv"></span>
         ‰∫∫
      </span>
    
    
  
</div>

  
  
    <!-- Â§áÊ°à‰ø°ÊÅØ ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      Á≤§ICPËØÅ123456Âè∑
    </a>
  </span>
  
    
      <span>
        <a
          href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=12345678"
          rel="nofollow noopener"
          class="beian-police"
          target="_blank"
        >
          
            <span style="visibility: hidden; width: 0">|</span>
            <img src="/Hexo/img/police_beian.png" srcset="/Hexo/img/loading.gif" lazyload alt="police-icon"/>
          
          <span>Á≤§ÂÖ¨ÁΩëÂÆâÂ§á12345678Âè∑</span>
        </a>
      </span>
    
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/Hexo/js/events.js" ></script>
<script  src="/Hexo/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  

  

  

  

  

  

  




  
    <script  src="/Hexo/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/Hexo/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- ‰∏ªÈ¢òÁöÑÂêØÂä®È°πÔºåÂ∞ÜÂÆÉ‰øùÊåÅÂú®ÊúÄÂ∫ïÈÉ® -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/Hexo/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">ÂçöÂÆ¢Âú®ÂÖÅËÆ∏ JavaScript ËøêË°åÁöÑÁéØÂ¢É‰∏ãÊµèËßàÊïàÊûúÊõ¥‰Ω≥</div>
  </noscript>
</body>
</html>
